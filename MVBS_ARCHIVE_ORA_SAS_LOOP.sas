/**************************************************************************** 
 * Job:             MVBS_ARCHIVE_ORA_SAS_LOOP             A5V8BXSQ.AR0001AW * 
 * Description:                                                             * 
 *                                                                          * 
 * Metadata Server: bire-sas94-meta-dev.srv.allianz                         * 
 * Port:            8561                                                    * 
 * Location:        /ETL/tdbpcd/Jobs/MVBS/MVBS_ARCHIVE                      * 
 *                                                                          * 
 * Server:          tdbpcd                                A5HYR2NS.AS00001O * 
 *                                                                          * 
 * Source Tables:   META_MVBS_TABLES_TO_ARCHIVE -         A5V8BXSQ.AE0001UO * 
 *                   RESASDWH.META_MVBS_TABLES_TO_ARCHIVE                   * 
 *                  META_MVBS_TABLES_TO_ARCHIVE -         A5V8BXSQ.AE0001UO * 
 *                   RESASDWH.META_MVBS_TABLES_TO_ARCHIVE                   * 
 *                                                                          * 
 * Generated on:    Friday, June 9, 2017 6:44:03 PM IST                     * 
 * Generated by:    re00580                                                 * 
 * Version:         SAS Data Integration Studio 4.901                       * 
 ****************************************************************************/ 

/* Generate the process id for job  */ 
%put Process ID: &SYSJOBID;

/* General macro variables  */ 
%let jobID = %quote(A5V8BXSQ.AR0001AW);
%let etls_jobName = %nrquote(MVBS_ARCHIVE_ORA_SAS_LOOP);
%let etls_userID = %nrquote(re00580);

/* Setup to capture return codes  */ 
%global job_rc trans_rc sqlrc;
%let sysrc = 0;
%let job_rc = 0;
%let trans_rc = 0;
%let sqlrc = 0;
%global etls_stepStartTime; 
/* initialize syserr to 0 */
data _null_; run;

%macro rcSet(error); 
   %if (&error gt &trans_rc) %then 
      %let trans_rc = &error;
   %if (&error gt &job_rc) %then 
      %let job_rc = &error;
%mend rcSet; 

%macro rcSetDS(error); 
   if &error gt input(symget('trans_rc'),12.) then 
      call symput('trans_rc',trim(left(put(&error,12.))));
   if &error gt input(symget('job_rc'),12.) then 
      call symput('job_rc',trim(left(put(&error,12.))));
%mend rcSetDS; 

/* Create metadata macro variables */
%let IOMServer      = %nrquote(tdbpcd);
%let metaPort       = %nrquote(8561);
%let metaServer     = %nrquote(ibire-sas94-meta-dev.srv.allianz);

/* Setup for capturing job status  */ 
%let etls_startTime = %sysfunc(datetime(),datetime.);
%let etls_recordsBefore = 0;
%let etls_recordsAfter = 0;
%let etls_lib = 0;
%let etls_table = 0;

%global etls_debug; 
%macro etls_setDebug; 
   %if %str(&etls_debug) ne 0 %then 
      OPTIONS MPRINT%str(;); 
%mend; 
%etls_setDebug; 

/*---- Start of Pre-Process Code  ----*/ 

/*Call to an initialization macro  */
%mvbsJobInit;
proc sql noprint;
  select input(parameter_value,yymmdd10.) format=yyq6. into :Act_Period from RESASDWH.MVBS_PARAMETERS where PARAMETER = 'MVBS_RUN_DATE';
quit;

%PUT &Act_Period.;

***create additional directory ***;
data _null_;
  newdir=dcreate("TechDB_archive_&Act_Period.", "&proj_env./data/TechDB_to_archive/");
run;


data _null_;
 file "&proj_env./data/TechDB_to_archive/act_period.txt"  lrecl=80 ;
  put "&Act_Period.";
run;


%macro m_common_check_libname(libref=,path=,engine=,options=);
/* -----------------------------*/
/* Assign the Libref. */
%let librc=%sysfunc(libname(&LIBREF.,&PATH.,&ENGINE.,&OPTIONS.));
/* -----------------------------*/
/* Write feedback to the SAS Log. */
%if %eval(&librc gt 0) %then
%do;
        %put WARNING: Libref %upcase(&LIBREF.) could not be assigned;
%end;
%else %do;
        %put NOTE: Libref %upcase(&LIBREF.) was successfully assigned;
%end;
%mend;

%m_common_check_libname(libref=MVBSARCH,
                path=%nrquote(&proj_env./data/TechDB_to_archive/TechDB_archive_&Act_Period),
                engine=BASE);

proc datasets lib=MVBSARCH kill noprint; run;

/*---- End of Pre-Process Code  ----*/ 

%rcSet(&syserr); 
%rcSet(&sqlrc); 

/*==========================================================================* 
 * Step:            Extract_for ORA Tables                A5V8BXSQ.AW0003AE * 
 * Transform:       Extract                                                 * 
 * Description:                                                             * 
 *                                                                          * 
 * Source Table:    META_MVBS_TABLES_TO_ARCHIVE -         A5V8BXSQ.AE0001UO * 
 *                   RESASDWH.META_MVBS_TABLES_TO_ARCHIVE                   * 
 * Target Table:    Extract_for_oracle_tables -           A5V8BXSQ.AQ0001D0 * 
 *                   work.Extract_for_oracle_tables                         * 
 *==========================================================================*/ 

%let transformID = %quote(A5V8BXSQ.AW0003AE);
%let trans_rc = 0;
%let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 

%let SYSLAST = %nrquote(RESASDWH.META_MVBS_TABLES_TO_ARCHIVE); 

%global etls_sql_pushDown;
%let etls_sql_pushDown = -1;
option DBIDIRECTEXEC;

/*---- Map the columns  ----*/ 
proc datasets lib = work nolist nowarn memtype = (data view);
   delete Extract_for_oracle_tables;
quit;

%put %str(NOTE: Mapping columns ...);
proc sql;
   create view work.Extract_for_oracle_tables as
      select
         TABLE_NAME,
         TYPE,
         LOAD_TIMESTAMP
   from &SYSLAST
      where UPCASE(TYPE) ='ORACLE'
   order by
      TABLE_NAME
   ;
quit;

%let SYSLAST = work.Extract_for_oracle_tables;

%global etls_sql_pushDown;
%let etls_sql_pushDown = &sys_sql_ip_all;

%rcSet(&sqlrc); 



/**  Step end Extract_for ORA Tables **/

/*==========================================================================* 
 * Step:            Loop for oracle tables                A5V8BXSQ.AW0003AF * 
 * Transform:       Loop                                                    * 
 * Description:                                                             * 
 *                                                                          * 
 * Source Table:    Extract_for_oracle_tables -           A5V8BXSQ.AQ0001D0 * 
 *                   work.Extract_for_oracle_tables                         * 
 * Target Table:    Loop - work.WKLJCNS                   A5V8BXSQ.AQ0001D1 * 
 *==========================================================================*/ 

%let transformID = %quote(A5V8BXSQ.AW0003AF);
%let trans_rc = 0;
%let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 

%let SYSLAST = %nrquote(work.Extract_for_oracle_tables); 

%macro etls_getHandle(statusTable=, handleVariable=, row=); 
   %let etls_dsid = %sysfunc(open(&statusTable)); 
   %if (&etls_dsid = 0) %then 
      %put %sysfunc(sysmsg()); 
   %else 
   %do; 
      %let rc = %sysfunc(fetchobs(&etls_dsid, &row)); 
      %if (&rc ne 0) %then 
         %put %sysfunc(sysmsg()); 
      %else 
      %do; 
         %let etls_varnum = %sysfunc(varnum(&etls_dsid,&handleVariable)); 
         %if (&etls_varnum > 0) %then 
            %sysfunc(getvarc(&etls_dsid,&etls_varnum)); 
         %else 
            %put %sysfunc(sysmsg()); 
      %end; 
      %let rc = %sysfunc(close(&etls_dsid)); 
   %end; 
%mend etls_getHandle; 

%macro etls_freeHandle(statusTable=, statusVariable=, handleVariable=, 
   handleName=, statusSetting="Finished", 
   endTimeVariable=endTime, startTimeVariable=startTime, signoff=1, 
   returnCodeVariable=, returnCodeMacroVariable=, setMainJobRC=1, 
   statusUnknownReturnCode=., startTimeMacroVariable=, endTimeMacroVariable= ); 

   %if (&statusTable ne ) %then 
   %do; 
      %local etls_rcMacroVarExisted; 
      %let etls_rcMacroVarExisted = 0; 
      %if ("&returnCodeMacroVariable" ne "") %then 
      %do; 
         proc sql noprint; 
            select '1' into: etls_rcMacroVarExisted from dictionary.macros 
            where name=upcase("&returnCodeMacroVariable"); 
         quit; 

         %rcSet(&sqlrc); 
         %if (&etls_rcMacroVarExisted = 0) %then 
         %do; 
            %put WARNING%QUOTE(:) Return code from inner job not found.  Setting status to Unknown.;
            %let &returnCodeMacroVariable=&statusUnknownReturnCode; 
         %end; 
         %if (&setMainJobRC eq 1) %then 
            %rcSet(&&&returnCodeMacroVariable); 
      %end; 
      %else 
      %do; 
         %let returnCodeMacroVariable=etls_rcmacvar; 
         %let &returnCodeMacroVariable=&statusUnknownReturnCode; 
      %end; 

      %local etls_startTimeMacroVarExisted; 
      %let etls_startTimeMacroVarExisted = 0; 
      %if ("&startTimeMacroVariable" ne "") %then 
      %do; 
         proc sql noprint; 
            select '1' into: etls_startTimeMacroVarExisted from dictionary.macros 
            where name=upcase("&startTimeMacroVariable"); 
         quit; 

         %rcSet(&sqlrc); 
         %if (&etls_startTimeMacroVarExisted = 0) %then 
         %do; 
            %put WARNING%QUOTE(:) Start time from inner job not found.  No value will be set.;
            %let &startTimeMacroVariable=; 
         %end; 
      %end; 

      %local etls_endTimeMacroVarExisted; 
      %let etls_endTimeMacroVarExisted = 0; 
      %if ("&endTimeMacroVariable" ne "") %then 
      %do; 
         proc sql noprint; 
            select '1' into: etls_endTimeMacroVarExisted from dictionary.macros 
            where name=upcase("&endTimeMacroVariable"); 
         quit; 

         %rcSet(&sqlrc); 
         %if (&etls_endTimeMacroVarExisted = 0) %then 
         %do; 
            %put WARNING%QUOTE(:) End time from inner job not found.  Setting end time to current
      time.;
            %let &endTimeMacroVariable=%sysfunc(datetime()); 
         %end; 
      %end; 

      data &statusTable; 
         modify &statusTable(where=(&handleVariable = &handleName)); 
         %if ("&startTimeMacroVariable" ne "") %then 
         %do; 
            &startTimeVariable = input(symget("&startTimeMacroVariable"),32.);; 
         %end; 
         %if ("&endTimeVariable" ne "") %then 
         %do; 
            %if ("&endTimeMacroVariable" ne "") %then 
            %do; 
               &endTimeVariable = input(symget("&endTimeMacroVariable"),32.);; 
            %end; 
            %else 
               &endTimeVariable = datetime();; 
         %end; 
         %if ("&returnCodeVariable" ne "") %then 
            &returnCodeVariable = input(symget("&returnCodeMacroVariable"),32.);; 
         %if ("&statusVariable" ne "") %then 
         %do; 
            if (symget("etls_rcMacroVarExisted") eq "0") then 
               &statusVariable = "Unknown Status"; 
            else
               &statusVariable = &statusSetting;
         %end;
         call symput('handle',&handleVariable); 
         replace; 
         stop; 
      run; 

      %rcSet(&syserr); 

      %if (&signoff eq 1) %then 
         %etls_signoff(handleName=&handle); 
   %end; 
%mend etls_freeHandle; 

%macro etls_createHandle(statusTable=,
                         statusVariable=,
                         handleVariable=,
                         handlePrefix=rmt,
                         gridOptionSet=,
                         workloadMacroVariable=,
                         row=,
                         machineVariable=,
                         statusSetting="Running", 
                         startTimeVariable=startTime,
                         signon=1,
                         useGrid=1,
                         log=,
                         output=,
                         gridRC=,
                         cmacvar=etls_signonStatus,
                         additionalSignonOptions=,
                         signonRetries= ); 

   %local remoteSessionId; 
   %let remoteSessionId = &handlePrefix.&row; 
   %let &cmacvar = 1; 
   %local etls_machineId; 
   %if (&signon eq 1) %then 

      %etls_signon(handleName=&remoteSessionId,
                   useGrid=&useGrid,
                   machineIdMacroVariable=etls_machineId,
                   gridOptionSet=&etls_gridOptionSet,
                   workloadMacroVariable=&workloadMacroVariable,
                   log=&log,
                   output=&output,
                   cmacvar=&cmacvar,
                   gridRC=&gridRC,
                   additionalSignonOptions=&additionalSignonOptions,
					signonRetries=&signonRetries,
                   gridJobName=DIS_&etls_jobName._&row); 

   %else %let &cmacvar=0; 

   data &statusTable; 
      retain ptr &row; 
      modify &statusTable point = ptr; 
      &handleVariable = "&remoteSessionId"; 
      %if (&signon eq 1) %then 
         &machineVariable = "&etls_machineId";; 
      %if (&&&cmacvar ne 0) %then 
      %do; 
         &statusVariable = "Failed Signon"; 
      %end; 
      %else 
         &statusVariable = &statusSetting;; 
      %if (&startTimeVariable ne ) %then 
         &startTimeVariable = datetime();; 
      replace; 
      stop; 
   run; 

   %rcSet(&syserr); 
%mend etls_createHandle; 

%macro etls_getParameterNames(parameterTable=, parameterVariableMacro=, startingColumnNumber=1);
   %let &parameterVariableMacro = ;
   %let dsid = %sysfunc(open(&parameterTable));
   %if (&dsid gt 0) %then 
   %do; 
      %do i=&startingColumnNumber %to %sysfunc(attrn(&dsid,nvars)); 
         %let &parameterVariableMacro = &&&parameterVariableMacro %sysfunc(varname(&dsid,&i)); 
      %end; 
      %let dsid = %sysfunc(close(&dsid)); 
   %end; 
   %else 
      %put %sysfunc(sysmsg()); 
   %rcSet(&syserr); 
%mend etls_getParameterNames; 

%macro etls_getParameters(parameterTable=, row=, startingColumnNumber=1 , handleName=); 
   data _null_; 
      length vname $256 vtype $1 value $32767; 
      dsid = open("&parameterTable"); 
      if (dsid > 0) then 
      do; 
         do _i = 1 to &row; 
            fetchrc = fetch(dsid); 
         end; 
         do _i=&startingColumnNumber to attrn(dsid,'nvars'); 
            vname = varname(dsid,_i); 
            vtype = vartype(dsid,_i); 
            if (fetchrc = 0) then 
            do; 
               if (vtype = 'C') then 
               do; 
                  value = getvarc(dsid,_i); 
                  value = tranwrd(value,"%","%%"); 
                  value = tranwrd(value,"(","%("); 
                  value = tranwrd(value,")","%)"); 
                  value = tranwrd(value,'"','%"'); 
                  value = tranwrd(value,"'","%'"); 
               end; 
               else 
                  value = left(put(getvarn(dsid,_i),best32.)); 
            end; /* fetchrc = 0 */ 
            
            put ;
            if indexc(trimn(value),"+-*/<>=^~;, '()&%",'"')>0 then 
            do; 
               value='%nrstr('||trim(value)||')'; 
               put "ETLS_DIAG%QUOTE(:) Special characters encountered; References may require: %nrbquote(%)UNQUOTE(&" vname+(-1)').';
               put "NOTE: Special characters encountered; References may require: %nrbquote(%)UNQUOTE(&" vname+(-1)').';
            end; 
            %if %str(&handlename) ne %str() %then 
            %do; 
               value = '%syslput '||trim(vname)||'= '||trim(value)||" / remote = &handleName;"; 
            %end; 
            %else 
            %do; 
               value = '%let '||trim(vname)||'= '||trim(value)||';'; 
            %end; 
            
            put "NOTE: Setting macro variable " vname "with statement:" value ;
            call execute(value); 
         end; /* do i= */ 
         dsid = close(dsid); 
      end; /* dsid > 0 */ 
      else 
      do; 
         put "ERROR%QUOTE(:) Parameter table, &parameterTable., could not be"
              " opened.";
         abort; 
      end; 
      stop; 
   run; 
   
   %rcSet(&syserr); 
%mend etls_getParameters; 

%macro etls_loopW1015MR8I; 
   %local etls_filePrefix; 
   %let etls_filePrefix = ; 
   
   %macro etls_processToLoopW1015MR8J(parameterTable=, row=, handleName=rmt);
      %local etls_parmvars; 
      %etls_getParameterNames(parameterTable=&parameterTable, 
         parameterVariableMacro=etls_parmvars, 
         startingColumnNumber=1); 
      %local &etls_parmvars; 
      %etls_getParameters(parameterTable=&parameterTable, row=&row, 
         startingColumnNumber=1); 
      %let etls_previousFilePrefix = &etls_filePrefix;
      %local etls_filePrefix; 
      %let etls_filePrefix = &etls_previousFilePrefix.&handleName; 
      %macro etls_jobW1015MR8T; 
      
         /*==========================================================================* 
          * Step:            User Written ORA_ARCHIVING            A5V8BXSQ.AW0003AG * 
          * Transform:       User Written                                            * 
          * Description:                                                             * 
          *                                                                          * 
          * Source Table:    Loop - work.WKLJCNS                   A5V8BXSQ.AQ0001D1 * 
          * Target Table:    User Written - work.WVS0K4Z           A5V8BXSQ.AQ0001D2 * 
          *                                                                          * 
          * User Written:    SourceCode                                              * 
          *==========================================================================*/ 
         
         %let transformID = %quote(A5V8BXSQ.AW0003AG);
         %let trans_rc = 0;
         %let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 
         
         %let SYSLAST = %nrquote(work.WKLJCNS); 
         
         %let _INPUT_count = 1;
         %let _INPUT = work.WKLJCNS;
         %let _INPUT_connect = ;
         %let _INPUT_engine = ;
         %let _INPUT_memtype = DATA;
         %let _INPUT_options = %nrquote();
         %let _INPUT_alter = %nrquote();
         %let _INPUT_path = %nrquote(/Loop_A5V8BXSQ.AQ0001D1%(WorkTable%));
         %let _INPUT_type = 1;
         %let _INPUT_label = %nrquote();
         %let _INPUT_filetype = WorkTable;
         
         %let _INPUT1 = work.WKLJCNS;
         %let _INPUT1_connect = ;
         %let _INPUT1_engine = ;
         %let _INPUT1_memtype = DATA;
         %let _INPUT1_options = %nrquote();
         %let _INPUT1_alter = %nrquote();
         %let _INPUT1_path = %nrquote(/Loop_A5V8BXSQ.AQ0001D1%(WorkTable%));
         %let _INPUT1_type = 1;
         %let _INPUT1_label = %nrquote();
         %let _INPUT1_filetype = WorkTable;
         
         %let _OUTPUT_count = 1;
         %let _OUTPUT = work.WVS0K4Z;
         %let _OUTPUT_connect = ;
         %let _OUTPUT_engine = ;
         %let _OUTPUT_memtype = DATA;
         %let _OUTPUT_options = %nrquote();
         %let _OUTPUT_alter = %nrquote();
         %let _OUTPUT_path = %nrquote(/User Written_A5V8BXSQ.AQ0001D2%(WorkTable%));
         %let _OUTPUT_type = 1;
         %let _OUTPUT_label = %nrquote();
         /* List of target columns to keep  */ 
         %let _OUTPUT_keep = etls_handleName etls_machineId etls_startTime etls_endTime etls_status 
                 etls_jobRC ORACLE_TABLE_NAMES LOAD_TIMESTAMP TABLE_NAME TYPE;
         %let _OUTPUT_col_count = 10;
         %let _OUTPUT_col0_name = etls_handleName;
         %let _OUTPUT_col0_table = work.WVS0K4Z;
         %let _OUTPUT_col0_length = 32;
         %let _OUTPUT_col0_type = $;
         %let _OUTPUT_col0_format = ;
         %let _OUTPUT_col0_informat = ;
         %let _OUTPUT_col0_label = %nrquote(Name of handle to remote session);
         %let _OUTPUT_col0_input0 = etls_handleName;
         %let _OUTPUT_col0_exp = ;
         %let _OUTPUT_col0_input = etls_handleName;
         %let _OUTPUT_col0_input_count = 1;
         %let _OUTPUT_col1_name = etls_machineId;
         %let _OUTPUT_col1_table = work.WVS0K4Z;
         %let _OUTPUT_col1_length = 32;
         %let _OUTPUT_col1_type = $;
         %let _OUTPUT_col1_format = ;
         %let _OUTPUT_col1_informat = ;
         %let _OUTPUT_col1_label = %nrquote(Name of machine executing the task);
         %let _OUTPUT_col1_input0 = etls_machineId;
         %let _OUTPUT_col1_exp = ;
         %let _OUTPUT_col1_input = etls_machineId;
         %let _OUTPUT_col1_input_count = 1;
         %let _OUTPUT_col2_name = etls_startTime;
         %let _OUTPUT_col2_table = work.WVS0K4Z;
         %let _OUTPUT_col2_length = 8;
         %let _OUTPUT_col2_type = ;
         %let _OUTPUT_col2_format = nldatmap.;
         %let _OUTPUT_col2_informat = ;
         %let _OUTPUT_col2_label = %nrquote(Start time of task);
         %let _OUTPUT_col2_input0 = etls_startTime;
         %let _OUTPUT_col2_exp = ;
         %let _OUTPUT_col2_input = etls_startTime;
         %let _OUTPUT_col2_input_count = 1;
         %let _OUTPUT_col3_name = etls_endTime;
         %let _OUTPUT_col3_table = work.WVS0K4Z;
         %let _OUTPUT_col3_length = 8;
         %let _OUTPUT_col3_type = ;
         %let _OUTPUT_col3_format = nldatmap.;
         %let _OUTPUT_col3_informat = ;
         %let _OUTPUT_col3_label = %nrquote(End time of task);
         %let _OUTPUT_col3_input0 = etls_endTime;
         %let _OUTPUT_col3_exp = ;
         %let _OUTPUT_col3_input = etls_endTime;
         %let _OUTPUT_col3_input_count = 1;
         %let _OUTPUT_col4_name = etls_status;
         %let _OUTPUT_col4_table = work.WVS0K4Z;
         %let _OUTPUT_col4_length = 32;
         %let _OUTPUT_col4_type = $;
         %let _OUTPUT_col4_format = ;
         %let _OUTPUT_col4_informat = ;
         %let _OUTPUT_col4_label = %nrquote(Current status of task);
         %let _OUTPUT_col4_input0 = etls_status;
         %let _OUTPUT_col4_exp = ;
         %let _OUTPUT_col4_input = etls_status;
         %let _OUTPUT_col4_input_count = 1;
         %let _OUTPUT_col5_name = etls_jobRC;
         %let _OUTPUT_col5_table = work.WVS0K4Z;
         %let _OUTPUT_col5_length = 8;
         %let _OUTPUT_col5_type = ;
         %let _OUTPUT_col5_format = ;
         %let _OUTPUT_col5_informat = ;
         %let _OUTPUT_col5_label = %nrquote(Return code of task);
         %let _OUTPUT_col5_input0 = etls_jobRC;
         %let _OUTPUT_col5_exp = ;
         %let _OUTPUT_col5_input = etls_jobRC;
         %let _OUTPUT_col5_input_count = 1;
         %let _OUTPUT_col6_name = ORACLE_TABLE_NAMES;
         %let _OUTPUT_col6_table = work.WVS0K4Z;
         %let _OUTPUT_col6_length = 32;
         %let _OUTPUT_col6_type = $;
         %let _OUTPUT_col6_format = ;
         %let _OUTPUT_col6_informat = ;
         %let _OUTPUT_col6_label = %nrquote();
         %let _OUTPUT_col6_exp = ;
         %let _OUTPUT_col6_input_count = 0;
         %let _OUTPUT_col7_name = LOAD_TIMESTAMP;
         %let _OUTPUT_col7_table = work.WVS0K4Z;
         %let _OUTPUT_col7_length = 8;
         %let _OUTPUT_col7_type = ;
         %let _OUTPUT_col7_format = datetime20.;
         %let _OUTPUT_col7_informat = datetime20.;
         %let _OUTPUT_col7_label = %nrquote();
         %let _OUTPUT_col7_exp = ;
         %let _OUTPUT_col7_input_count = 0;
         %let _OUTPUT_col8_name = TABLE_NAME;
         %let _OUTPUT_col8_table = work.WVS0K4Z;
         %let _OUTPUT_col8_length = 32;
         %let _OUTPUT_col8_type = $;
         %let _OUTPUT_col8_format = ;
         %let _OUTPUT_col8_informat = ;
         %let _OUTPUT_col8_label = %nrquote();
         %let _OUTPUT_col8_input0 = TABLE_NAME;
         %let _OUTPUT_col8_exp = ;
         %let _OUTPUT_col8_input = TABLE_NAME;
         %let _OUTPUT_col8_input_count = 1;
         %let _OUTPUT_col9_name = TYPE;
         %let _OUTPUT_col9_table = work.WVS0K4Z;
         %let _OUTPUT_col9_length = 20;
         %let _OUTPUT_col9_type = $;
         %let _OUTPUT_col9_format = ;
         %let _OUTPUT_col9_informat = ;
         %let _OUTPUT_col9_label = %nrquote();
         %let _OUTPUT_col9_input0 = TYPE;
         %let _OUTPUT_col9_exp = ;
         %let _OUTPUT_col9_input = TYPE;
         %let _OUTPUT_col9_input_count = 1;
         %let _OUTPUT_filetype = WorkTable;
         
         %let _OUTPUT1 = work.WVS0K4Z;
         %let _OUTPUT1_connect = ;
         %let _OUTPUT1_engine = ;
         %let _OUTPUT1_memtype = DATA;
         %let _OUTPUT1_options = %nrquote();
         %let _OUTPUT1_alter = %nrquote();
         %let _OUTPUT1_path = %nrquote(/User Written_A5V8BXSQ.AQ0001D2%(WorkTable%));
         %let _OUTPUT1_type = 1;
         %let _OUTPUT1_label = %nrquote();
         /* List of target columns to keep  */ 
         %let _OUTPUT1_keep = etls_handleName etls_machineId etls_startTime etls_endTime etls_status 
                 etls_jobRC ORACLE_TABLE_NAMES LOAD_TIMESTAMP TABLE_NAME TYPE;
         %let _OUTPUT1_col_count = 10;
         %let _OUTPUT1_col0_name = etls_handleName;
         %let _OUTPUT1_col0_table = work.WVS0K4Z;
         %let _OUTPUT1_col0_length = 32;
         %let _OUTPUT1_col0_type = $;
         %let _OUTPUT1_col0_format = ;
         %let _OUTPUT1_col0_informat = ;
         %let _OUTPUT1_col0_label = %nrquote(Name of handle to remote session);
         %let _OUTPUT1_col0_input0 = etls_handleName;
         %let _OUTPUT1_col0_exp = ;
         %let _OUTPUT1_col0_input = etls_handleName;
         %let _OUTPUT1_col0_input_count = 1;
         %let _OUTPUT1_col1_name = etls_machineId;
         %let _OUTPUT1_col1_table = work.WVS0K4Z;
         %let _OUTPUT1_col1_length = 32;
         %let _OUTPUT1_col1_type = $;
         %let _OUTPUT1_col1_format = ;
         %let _OUTPUT1_col1_informat = ;
         %let _OUTPUT1_col1_label = %nrquote(Name of machine executing the task);
         %let _OUTPUT1_col1_input0 = etls_machineId;
         %let _OUTPUT1_col1_exp = ;
         %let _OUTPUT1_col1_input = etls_machineId;
         %let _OUTPUT1_col1_input_count = 1;
         %let _OUTPUT1_col2_name = etls_startTime;
         %let _OUTPUT1_col2_table = work.WVS0K4Z;
         %let _OUTPUT1_col2_length = 8;
         %let _OUTPUT1_col2_type = ;
         %let _OUTPUT1_col2_format = nldatmap.;
         %let _OUTPUT1_col2_informat = ;
         %let _OUTPUT1_col2_label = %nrquote(Start time of task);
         %let _OUTPUT1_col2_input0 = etls_startTime;
         %let _OUTPUT1_col2_exp = ;
         %let _OUTPUT1_col2_input = etls_startTime;
         %let _OUTPUT1_col2_input_count = 1;
         %let _OUTPUT1_col3_name = etls_endTime;
         %let _OUTPUT1_col3_table = work.WVS0K4Z;
         %let _OUTPUT1_col3_length = 8;
         %let _OUTPUT1_col3_type = ;
         %let _OUTPUT1_col3_format = nldatmap.;
         %let _OUTPUT1_col3_informat = ;
         %let _OUTPUT1_col3_label = %nrquote(End time of task);
         %let _OUTPUT1_col3_input0 = etls_endTime;
         %let _OUTPUT1_col3_exp = ;
         %let _OUTPUT1_col3_input = etls_endTime;
         %let _OUTPUT1_col3_input_count = 1;
         %let _OUTPUT1_col4_name = etls_status;
         %let _OUTPUT1_col4_table = work.WVS0K4Z;
         %let _OUTPUT1_col4_length = 32;
         %let _OUTPUT1_col4_type = $;
         %let _OUTPUT1_col4_format = ;
         %let _OUTPUT1_col4_informat = ;
         %let _OUTPUT1_col4_label = %nrquote(Current status of task);
         %let _OUTPUT1_col4_input0 = etls_status;
         %let _OUTPUT1_col4_exp = ;
         %let _OUTPUT1_col4_input = etls_status;
         %let _OUTPUT1_col4_input_count = 1;
         %let _OUTPUT1_col5_name = etls_jobRC;
         %let _OUTPUT1_col5_table = work.WVS0K4Z;
         %let _OUTPUT1_col5_length = 8;
         %let _OUTPUT1_col5_type = ;
         %let _OUTPUT1_col5_format = ;
         %let _OUTPUT1_col5_informat = ;
         %let _OUTPUT1_col5_label = %nrquote(Return code of task);
         %let _OUTPUT1_col5_input0 = etls_jobRC;
         %let _OUTPUT1_col5_exp = ;
         %let _OUTPUT1_col5_input = etls_jobRC;
         %let _OUTPUT1_col5_input_count = 1;
         %let _OUTPUT1_col6_name = ORACLE_TABLE_NAMES;
         %let _OUTPUT1_col6_table = work.WVS0K4Z;
         %let _OUTPUT1_col6_length = 32;
         %let _OUTPUT1_col6_type = $;
         %let _OUTPUT1_col6_format = ;
         %let _OUTPUT1_col6_informat = ;
         %let _OUTPUT1_col6_label = %nrquote();
         %let _OUTPUT1_col6_exp = ;
         %let _OUTPUT1_col6_input_count = 0;
         %let _OUTPUT1_col7_name = LOAD_TIMESTAMP;
         %let _OUTPUT1_col7_table = work.WVS0K4Z;
         %let _OUTPUT1_col7_length = 8;
         %let _OUTPUT1_col7_type = ;
         %let _OUTPUT1_col7_format = datetime20.;
         %let _OUTPUT1_col7_informat = datetime20.;
         %let _OUTPUT1_col7_label = %nrquote();
         %let _OUTPUT1_col7_exp = ;
         %let _OUTPUT1_col7_input_count = 0;
         %let _OUTPUT1_col8_name = TABLE_NAME;
         %let _OUTPUT1_col8_table = work.WVS0K4Z;
         %let _OUTPUT1_col8_length = 32;
         %let _OUTPUT1_col8_type = $;
         %let _OUTPUT1_col8_format = ;
         %let _OUTPUT1_col8_informat = ;
         %let _OUTPUT1_col8_label = %nrquote();
         %let _OUTPUT1_col8_input0 = TABLE_NAME;
         %let _OUTPUT1_col8_exp = ;
         %let _OUTPUT1_col8_input = TABLE_NAME;
         %let _OUTPUT1_col8_input_count = 1;
         %let _OUTPUT1_col9_name = TYPE;
         %let _OUTPUT1_col9_table = work.WVS0K4Z;
         %let _OUTPUT1_col9_length = 20;
         %let _OUTPUT1_col9_type = $;
         %let _OUTPUT1_col9_format = ;
         %let _OUTPUT1_col9_informat = ;
         %let _OUTPUT1_col9_label = %nrquote();
         %let _OUTPUT1_col9_input0 = TYPE;
         %let _OUTPUT1_col9_exp = ;
         %let _OUTPUT1_col9_input = TYPE;
         %let _OUTPUT1_col9_input_count = 1;
         %let _OUTPUT1_filetype = WorkTable;
         
         /*---- Start of User Written Code  ----*/ 
         
         
         proc datasets lib=mvbsarch nolist nowarn;
         delete &ORACLE_TABLE_NAMES;
         quit;
         proc contents data=resasdwh.&ORACLE_TABLE_NAMES out=temp_contents noprint;
         run;
         %let cnt=0;
         proc sql noprint;
         	select count(*) into :cnt from temp_contents
         		where NAME="VERSION_ID" and MEMNAME not in ("MVBS_LOG", "MVBS_LOG_HISTORY");
         quit;
         
         proc sql noprint;
         	select distinct
               MVBS_LOG.VERSION_ID into: Version_ARCH separated by ','
            from
               RESASDWH.MVBS_LOG MVBS_LOG
            where
                   MVBS_LOG.REPORTING_PERIOD = %sysfunc(compress(%str(%')&reporting_period.%str(%')))
            ;
         quit;
         
         %put Version_ARCH= &Version_ARCH.;
         /*Copying Oracle tables to SAS based on Version_id*/
         %macro archive;
          proc sql;
          create table mvbsarch.&ORACLE_TABLE_NAMES as
          %if &cnt ne 0 %then
         		%do;
         			select *
         				from resasdwh.&ORACLE_TABLE_NAMES
         					where version_id in (&Version_ARCH.);
         		%end;
          %else
         	%do;
         		select *
         			from resasdwh.&ORACLE_TABLE_NAMES;
         	%end;
         quit;
         %mend archive;
         %archive;
         /*---- End of User Written Code  ----*/ 
         
         %rcSet(&syserr); 
         %rcSet(&sqlrc); 
         
         
         /**  Step end User Written ORA_ARCHIVING **/
         
      %mend etls_jobW1015MR8T; 
      
      %etls_jobW1015MR8T; 
      
      %let handleName = %etls_getHandle(statusTable=&etls_statusTable,
         handleVariable=etls_handleName, row=&&&etls_controlName);
         
      %let job_rc&handleName. = &job_rc; 
      
      %etls_freeHandle(statusTable=&etls_statusTable, statusVariable=etls_status, 
         handleVariable=etls_handleName, handleName="&handleName", 
         startTimeVariable=etls_startTime, endTimeVariable=etls_endTime, signoff=0, 
         returnCodeVariable=etls_jobRC, returnCodeMacroVariable=job_rc&handleName., setMainJobRc=1); 
         
   %mend etls_processToLoopW1015MR8J;
   
   %local etls_controlTable etls_statusTable etls_controlName 
      etls_processesRunning etls_maxProcesses etls_parameterTable 
      etls_additionalSignonOptions etls_signonRetries;
   %let etls_controlName = L12_; 
   %let etls_statusTable = work.WKLJCNS; 
   %let etls_parameterTable = work.W1015MRX8; 
   %let &etls_controlName = 0;
   %let etls_controlTable = work.Extract_for_oracle_tables;
   
   %put %str(NOTE: Creating status table...);
   data &etls_statusTable 
      (keep = etls_handleName etls_machineId etls_startTime etls_endTime etls_status 
              etls_jobRC ORACLE_TABLE_NAMES TABLE_NAME TYPE LOAD_TIMESTAMP
      );
      attrib etls_handleName length = $32
         label = 'Name of handle to remote session'; 
      attrib etls_machineId length = $32
         label = 'Name of machine executing the task'; 
      attrib etls_startTime length = 8
         format = nldatmap.
         label = 'Start time of task'; 
      attrib etls_endTime length = 8
         format = nldatmap.
         label = 'End time of task'; 
      attrib etls_status length = $32
         label = 'Current status of task'; 
      attrib etls_jobRC length = 8
         label = 'Return code of task'; 
      attrib ORACLE_TABLE_NAMES length = $32; 
      attrib TABLE_NAME length = $32; 
      attrib TYPE length = $20; 
      attrib LOAD_TIMESTAMP length = 8
         format = datetime20.
         informat = datetime20.; 
      set &etls_controlTable;
   run;
   
   %rcSet(&syserr); 
   
   %put %str(NOTE: Creating parameter table...);
   proc sql; 
      create table &etls_parameterTable as 
         select TABLE_NAME as ORACLE_TABLE_NAMES 
         from &etls_controlTable; 
   quit; 
   
   %rcSet(&sqlrc); 
   
   /* Get the number of times to iterate from the number of rows in the source  */ 
   /*  table                                                                    */ 
   proc sql noprint; 
      select count(*) into :&etls_controlName._max from &etls_statusTable;
      %let &etls_controlName._max = &&&etls_controlName._max;
   quit;
   
   %rcSet(&sqlrc); 
   
   %let etls_maxProcesses = 1; 
   
   %if (&etls_maxProcesses > 0) %then 
   %do; 
      %do %until (&&&etls_controlName ge &&&etls_controlName._max); 
      
         %let etls_lastLoopPtr = &&&etls_controlName;
         
         %let etls_processesRunning = 0; 
         
         %do %while(&etls_processesRunning lt &&&etls_controlName._max 
            and &etls_processesRunning lt &etls_maxProcesses 
            and &&&etls_controlName lt &&&etls_controlName._max);
            
            %let &etls_controlName = %eval(&&&etls_controlName+1);
            
            %let job_rcLast=&job_rc; 
            
            %etls_createHandle(statusTable=&etls_statusTable,
                               statusVariable=etls_status,
                               handleVariable=etls_handleName,
                               handlePrefix=&etls_controlName,
                               statusSetting="Running",
                               row=&&&etls_controlName,
                               machineVariable=etls_machineId,
                               startTimeVariable=etls_startTime,
                               signon=0,
                               useGrid=0);
            
         %let etls_processesRunning = 1; 
         %etls_processToLoopW1015MR8J(parameterTable=&etls_parameterTable, row=&&&etls_controlName,
            handleName=%etls_getHandle(statusTable=&etls_statusTable,
            handleVariable=etls_handleName, row=&&&etls_controlName)); 
         
         /* Reset main Job_RC and Trans_RC to max return code of all iterations */ 
         %let job_rcThisIter=&job_rc; 
         %let job_rc=&job_rcLast; 
         %let trans_rc=&job_rcLast; 
         %rcSet(&job_rcThisIter); 
      %end; 
      
   %end; 
   
%end;

proc datasets lib = work nolist nowarn memtype = (data view);
   delete W1015MRX8;
quit;

%mend etls_loopW1015MR8I; 

%etls_loopW1015MR8I; 



/**  Step end Loop for oracle tables **/

/*==========================================================================* 
 * Step:            Loop End                              A5V8BXSQ.AW0003AH * 
 * Transform:       Loop End                                                * 
 * Description:                                                             * 
 *==========================================================================*/ 

%let transformID = %quote(A5V8BXSQ.AW0003AH);
%let trans_rc = 0;
%let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 



/**  Step end Loop End **/

/*==========================================================================* 
 * Step:            Extract for SAS Tables                A5V8BXSQ.AW0003AI * 
 * Transform:       Extract                                                 * 
 * Description:                                                             * 
 *                                                                          * 
 * Source Table:    META_MVBS_TABLES_TO_ARCHIVE -         A5V8BXSQ.AE0001UO * 
 *                   RESASDWH.META_MVBS_TABLES_TO_ARCHIVE                   * 
 * Target Table:    Extract_for_sas_tables -              A5V8BXSQ.AQ0001D3 * 
 *                   work.W1Q0P4MN                                          * 
 *==========================================================================*/ 

%let transformID = %quote(A5V8BXSQ.AW0003AI);
%let trans_rc = 0;
%let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 

%let SYSLAST = %nrquote(RESASDWH.META_MVBS_TABLES_TO_ARCHIVE); 

%global etls_sql_pushDown;
%let etls_sql_pushDown = -1;
option DBIDIRECTEXEC;

/*---- Map the columns  ----*/ 
proc datasets lib = work nolist nowarn memtype = (data view);
   delete W1Q0P4MN;
quit;

%put %str(NOTE: Mapping columns ...);
proc sql;
   create view work.W1Q0P4MN as
      select
         TABLE_NAME,
         TYPE,
         LOAD_TIMESTAMP
   from &SYSLAST
      where Upcase(TYPE) = 'SAS'
   ;
quit;

%let SYSLAST = work.W1Q0P4MN;

%global etls_sql_pushDown;
%let etls_sql_pushDown = &sys_sql_ip_all;

%rcSet(&sqlrc); 



/**  Step end Extract for SAS Tables **/

/*==========================================================================* 
 * Step:            Loop for SAS tables                   A5V8BXSQ.AW0003AJ * 
 * Transform:       Loop                                                    * 
 * Description:                                                             * 
 *                                                                          * 
 * Source Table:    Extract_for_sas_tables -              A5V8BXSQ.AQ0001D3 * 
 *                   work.W1Q0P4MN                                          * 
 * Target Table:    Loop - work.W1Q1XC52                  A5V8BXSQ.AQ0001D4 * 
 *==========================================================================*/ 

%let transformID = %quote(A5V8BXSQ.AW0003AJ);
%let trans_rc = 0;
%let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 

%let SYSLAST = %nrquote(work.W1Q0P4MN); 

%macro etls_getHandle(statusTable=, handleVariable=, row=); 
   %let etls_dsid = %sysfunc(open(&statusTable)); 
   %if (&etls_dsid = 0) %then 
      %put %sysfunc(sysmsg()); 
   %else 
   %do; 
      %let rc = %sysfunc(fetchobs(&etls_dsid, &row)); 
      %if (&rc ne 0) %then 
         %put %sysfunc(sysmsg()); 
      %else 
      %do; 
         %let etls_varnum = %sysfunc(varnum(&etls_dsid,&handleVariable)); 
         %if (&etls_varnum > 0) %then 
            %sysfunc(getvarc(&etls_dsid,&etls_varnum)); 
         %else 
            %put %sysfunc(sysmsg()); 
      %end; 
      %let rc = %sysfunc(close(&etls_dsid)); 
   %end; 
%mend etls_getHandle; 

%macro etls_freeHandle(statusTable=, statusVariable=, handleVariable=, 
   handleName=, statusSetting="Finished", 
   endTimeVariable=endTime, startTimeVariable=startTime, signoff=1, 
   returnCodeVariable=, returnCodeMacroVariable=, setMainJobRC=1, 
   statusUnknownReturnCode=., startTimeMacroVariable=, endTimeMacroVariable= ); 

   %if (&statusTable ne ) %then 
   %do; 
      %local etls_rcMacroVarExisted; 
      %let etls_rcMacroVarExisted = 0; 
      %if ("&returnCodeMacroVariable" ne "") %then 
      %do; 
         proc sql noprint; 
            select '1' into: etls_rcMacroVarExisted from dictionary.macros 
            where name=upcase("&returnCodeMacroVariable"); 
         quit; 

         %rcSet(&sqlrc); 
         %if (&etls_rcMacroVarExisted = 0) %then 
         %do; 
            %put WARNING%QUOTE(:) Return code from inner job not found.  Setting status to Unknown.;
            %let &returnCodeMacroVariable=&statusUnknownReturnCode; 
         %end; 
         %if (&setMainJobRC eq 1) %then 
            %rcSet(&&&returnCodeMacroVariable); 
      %end; 
      %else 
      %do; 
         %let returnCodeMacroVariable=etls_rcmacvar; 
         %let &returnCodeMacroVariable=&statusUnknownReturnCode; 
      %end; 

      %local etls_startTimeMacroVarExisted; 
      %let etls_startTimeMacroVarExisted = 0; 
      %if ("&startTimeMacroVariable" ne "") %then 
      %do; 
         proc sql noprint; 
            select '1' into: etls_startTimeMacroVarExisted from dictionary.macros 
            where name=upcase("&startTimeMacroVariable"); 
         quit; 

         %rcSet(&sqlrc); 
         %if (&etls_startTimeMacroVarExisted = 0) %then 
         %do; 
            %put WARNING%QUOTE(:) Start time from inner job not found.  No value will be set.;
            %let &startTimeMacroVariable=; 
         %end; 
      %end; 

      %local etls_endTimeMacroVarExisted; 
      %let etls_endTimeMacroVarExisted = 0; 
      %if ("&endTimeMacroVariable" ne "") %then 
      %do; 
         proc sql noprint; 
            select '1' into: etls_endTimeMacroVarExisted from dictionary.macros 
            where name=upcase("&endTimeMacroVariable"); 
         quit; 

         %rcSet(&sqlrc); 
         %if (&etls_endTimeMacroVarExisted = 0) %then 
         %do; 
            %put WARNING%QUOTE(:) End time from inner job not found.  Setting end time to current
      time.;
            %let &endTimeMacroVariable=%sysfunc(datetime()); 
         %end; 
      %end; 

      data &statusTable; 
         modify &statusTable(where=(&handleVariable = &handleName)); 
         %if ("&startTimeMacroVariable" ne "") %then 
         %do; 
            &startTimeVariable = input(symget("&startTimeMacroVariable"),32.);; 
         %end; 
         %if ("&endTimeVariable" ne "") %then 
         %do; 
            %if ("&endTimeMacroVariable" ne "") %then 
            %do; 
               &endTimeVariable = input(symget("&endTimeMacroVariable"),32.);; 
            %end; 
            %else 
               &endTimeVariable = datetime();; 
         %end; 
         %if ("&returnCodeVariable" ne "") %then 
            &returnCodeVariable = input(symget("&returnCodeMacroVariable"),32.);; 
         %if ("&statusVariable" ne "") %then 
         %do; 
            if (symget("etls_rcMacroVarExisted") eq "0") then 
               &statusVariable = "Unknown Status"; 
            else
               &statusVariable = &statusSetting;
         %end;
         call symput('handle',&handleVariable); 
         replace; 
         stop; 
      run; 

      %rcSet(&syserr); 

      %if (&signoff eq 1) %then 
         %etls_signoff(handleName=&handle); 
   %end; 
%mend etls_freeHandle; 

%macro etls_createHandle(statusTable=,
                         statusVariable=,
                         handleVariable=,
                         handlePrefix=rmt,
                         gridOptionSet=,
                         workloadMacroVariable=,
                         row=,
                         machineVariable=,
                         statusSetting="Running", 
                         startTimeVariable=startTime,
                         signon=1,
                         useGrid=1,
                         log=,
                         output=,
                         gridRC=,
                         cmacvar=etls_signonStatus,
                         additionalSignonOptions=,
                         signonRetries= ); 

   %local remoteSessionId; 
   %let remoteSessionId = &handlePrefix.&row; 
   %let &cmacvar = 1; 
   %local etls_machineId; 
   %if (&signon eq 1) %then 

      %etls_signon(handleName=&remoteSessionId,
                   useGrid=&useGrid,
                   machineIdMacroVariable=etls_machineId,
                   gridOptionSet=&etls_gridOptionSet,
                   workloadMacroVariable=&workloadMacroVariable,
                   log=&log,
                   output=&output,
                   cmacvar=&cmacvar,
                   gridRC=&gridRC,
                   additionalSignonOptions=&additionalSignonOptions,
					signonRetries=&signonRetries,
                   gridJobName=DIS_&etls_jobName._&row); 

   %else %let &cmacvar=0; 

   data &statusTable; 
      retain ptr &row; 
      modify &statusTable point = ptr; 
      &handleVariable = "&remoteSessionId"; 
      %if (&signon eq 1) %then 
         &machineVariable = "&etls_machineId";; 
      %if (&&&cmacvar ne 0) %then 
      %do; 
         &statusVariable = "Failed Signon"; 
      %end; 
      %else 
         &statusVariable = &statusSetting;; 
      %if (&startTimeVariable ne ) %then 
         &startTimeVariable = datetime();; 
      replace; 
      stop; 
   run; 

   %rcSet(&syserr); 
%mend etls_createHandle; 

%macro etls_getParameterNames(parameterTable=, parameterVariableMacro=, startingColumnNumber=1);
   %let &parameterVariableMacro = ;
   %let dsid = %sysfunc(open(&parameterTable));
   %if (&dsid gt 0) %then 
   %do; 
      %do i=&startingColumnNumber %to %sysfunc(attrn(&dsid,nvars)); 
         %let &parameterVariableMacro = &&&parameterVariableMacro %sysfunc(varname(&dsid,&i)); 
      %end; 
      %let dsid = %sysfunc(close(&dsid)); 
   %end; 
   %else 
      %put %sysfunc(sysmsg()); 
   %rcSet(&syserr); 
%mend etls_getParameterNames; 

%macro etls_getParameters(parameterTable=, row=, startingColumnNumber=1 , handleName=); 
   data _null_; 
      length vname $256 vtype $1 value $32767; 
      dsid = open("&parameterTable"); 
      if (dsid > 0) then 
      do; 
         do _i = 1 to &row; 
            fetchrc = fetch(dsid); 
         end; 
         do _i=&startingColumnNumber to attrn(dsid,'nvars'); 
            vname = varname(dsid,_i); 
            vtype = vartype(dsid,_i); 
            if (fetchrc = 0) then 
            do; 
               if (vtype = 'C') then 
               do; 
                  value = getvarc(dsid,_i); 
                  value = tranwrd(value,"%","%%"); 
                  value = tranwrd(value,"(","%("); 
                  value = tranwrd(value,")","%)"); 
                  value = tranwrd(value,'"','%"'); 
                  value = tranwrd(value,"'","%'"); 
               end; 
               else 
                  value = left(put(getvarn(dsid,_i),best32.)); 
            end; /* fetchrc = 0 */ 
            
            put ;
            if indexc(trimn(value),"+-*/<>=^~;, '()&%",'"')>0 then 
            do; 
               value='%nrstr('||trim(value)||')'; 
               put "ETLS_DIAG%QUOTE(:) Special characters encountered; References may require: %nrbquote(%)UNQUOTE(&" vname+(-1)').';
               put "NOTE: Special characters encountered; References may require: %nrbquote(%)UNQUOTE(&" vname+(-1)').';
            end; 
            %if %str(&handlename) ne %str() %then 
            %do; 
               value = '%syslput '||trim(vname)||'= '||trim(value)||" / remote = &handleName;"; 
            %end; 
            %else 
            %do; 
               value = '%let '||trim(vname)||'= '||trim(value)||';'; 
            %end; 
            
            put "NOTE: Setting macro variable " vname "with statement:" value ;
            call execute(value); 
         end; /* do i= */ 
         dsid = close(dsid); 
      end; /* dsid > 0 */ 
      else 
      do; 
         put "ERROR%QUOTE(:) Parameter table, &parameterTable., could not be"
              " opened.";
         abort; 
      end; 
      stop; 
   run; 
   
   %rcSet(&syserr); 
%mend etls_getParameters; 

%macro etls_loopW1015MS0P; 
   %local etls_filePrefix; 
   %let etls_filePrefix = ; 
   
   %macro etls_processToLoopW1015MS0Z(parameterTable=, row=, handleName=rmt);
      %local etls_parmvars; 
      %etls_getParameterNames(parameterTable=&parameterTable, 
         parameterVariableMacro=etls_parmvars, 
         startingColumnNumber=1); 
      %local &etls_parmvars; 
      %etls_getParameters(parameterTable=&parameterTable, row=&row, 
         startingColumnNumber=1); 
      %let etls_previousFilePrefix = &etls_filePrefix;
      %local etls_filePrefix; 
      %let etls_filePrefix = &etls_previousFilePrefix.&handleName; 
      %macro etls_jobW1015MS19; 
      
         /*==========================================================================* 
          * Step:            User Written SAS_ARCHIVING            A5V8BXSQ.AW0003AK * 
          * Transform:       User Written                                            * 
          * Description:                                                             * 
          *                                                                          * 
          * Source Table:    Loop - work.W1Q1XC52                  A5V8BXSQ.AQ0001D4 * 
          * Target Table:    User Written - work.W1Q39IZH          A5V8BXSQ.AQ0001D5 * 
          *                                                                          * 
          * User Written:    SourceCode                                              * 
          *==========================================================================*/ 
         
         %let transformID = %quote(A5V8BXSQ.AW0003AK);
         %let trans_rc = 0;
         %let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 
         
         %let SYSLAST = %nrquote(work.W1Q1XC52); 
         
         %let _INPUT_count = 1;
         %let _INPUT = work.W1Q1XC52;
         %let _INPUT_connect = ;
         %let _INPUT_engine = ;
         %let _INPUT_memtype = DATA;
         %let _INPUT_options = %nrquote();
         %let _INPUT_alter = %nrquote();
         %let _INPUT_path = %nrquote(/Loop_A5V8BXSQ.AQ0001D4%(WorkTable%));
         %let _INPUT_type = 1;
         %let _INPUT_label = %nrquote();
         %let _INPUT_filetype = WorkTable;
         
         %let _INPUT1 = work.W1Q1XC52;
         %let _INPUT1_connect = ;
         %let _INPUT1_engine = ;
         %let _INPUT1_memtype = DATA;
         %let _INPUT1_options = %nrquote();
         %let _INPUT1_alter = %nrquote();
         %let _INPUT1_path = %nrquote(/Loop_A5V8BXSQ.AQ0001D4%(WorkTable%));
         %let _INPUT1_type = 1;
         %let _INPUT1_label = %nrquote();
         %let _INPUT1_filetype = WorkTable;
         
         %let _OUTPUT_count = 1;
         %let _OUTPUT = work.W1Q39IZH;
         %let _OUTPUT_connect = ;
         %let _OUTPUT_engine = ;
         %let _OUTPUT_memtype = DATA;
         %let _OUTPUT_options = %nrquote();
         %let _OUTPUT_alter = %nrquote();
         %let _OUTPUT_path = %nrquote(/User Written_A5V8BXSQ.AQ0001D5%(WorkTable%));
         %let _OUTPUT_type = 1;
         %let _OUTPUT_label = %nrquote();
         /* List of target columns to keep  */ 
         %let _OUTPUT_keep = etls_handleName etls_machineId etls_startTime etls_endTime etls_status 
                 etls_jobRC TABLE_NAME TYPE LOAD_TIMESTAMP;
         %let _OUTPUT_col_count = 9;
         %let _OUTPUT_col0_name = etls_handleName;
         %let _OUTPUT_col0_table = work.W1Q39IZH;
         %let _OUTPUT_col0_length = 32;
         %let _OUTPUT_col0_type = $;
         %let _OUTPUT_col0_format = ;
         %let _OUTPUT_col0_informat = ;
         %let _OUTPUT_col0_label = %nrquote(Name of handle to remote session);
         %let _OUTPUT_col0_input0 = etls_handleName;
         %let _OUTPUT_col0_exp = ;
         %let _OUTPUT_col0_input = etls_handleName;
         %let _OUTPUT_col0_input_count = 1;
         %let _OUTPUT_col1_name = etls_machineId;
         %let _OUTPUT_col1_table = work.W1Q39IZH;
         %let _OUTPUT_col1_length = 32;
         %let _OUTPUT_col1_type = $;
         %let _OUTPUT_col1_format = ;
         %let _OUTPUT_col1_informat = ;
         %let _OUTPUT_col1_label = %nrquote(Name of machine executing the task);
         %let _OUTPUT_col1_input0 = etls_machineId;
         %let _OUTPUT_col1_exp = ;
         %let _OUTPUT_col1_input = etls_machineId;
         %let _OUTPUT_col1_input_count = 1;
         %let _OUTPUT_col2_name = etls_startTime;
         %let _OUTPUT_col2_table = work.W1Q39IZH;
         %let _OUTPUT_col2_length = 8;
         %let _OUTPUT_col2_type = ;
         %let _OUTPUT_col2_format = nldatmap.;
         %let _OUTPUT_col2_informat = ;
         %let _OUTPUT_col2_label = %nrquote(Start time of task);
         %let _OUTPUT_col2_input0 = etls_startTime;
         %let _OUTPUT_col2_exp = ;
         %let _OUTPUT_col2_input = etls_startTime;
         %let _OUTPUT_col2_input_count = 1;
         %let _OUTPUT_col3_name = etls_endTime;
         %let _OUTPUT_col3_table = work.W1Q39IZH;
         %let _OUTPUT_col3_length = 8;
         %let _OUTPUT_col3_type = ;
         %let _OUTPUT_col3_format = nldatmap.;
         %let _OUTPUT_col3_informat = ;
         %let _OUTPUT_col3_label = %nrquote(End time of task);
         %let _OUTPUT_col3_input0 = etls_endTime;
         %let _OUTPUT_col3_exp = ;
         %let _OUTPUT_col3_input = etls_endTime;
         %let _OUTPUT_col3_input_count = 1;
         %let _OUTPUT_col4_name = etls_status;
         %let _OUTPUT_col4_table = work.W1Q39IZH;
         %let _OUTPUT_col4_length = 32;
         %let _OUTPUT_col4_type = $;
         %let _OUTPUT_col4_format = ;
         %let _OUTPUT_col4_informat = ;
         %let _OUTPUT_col4_label = %nrquote(Current status of task);
         %let _OUTPUT_col4_input0 = etls_status;
         %let _OUTPUT_col4_exp = ;
         %let _OUTPUT_col4_input = etls_status;
         %let _OUTPUT_col4_input_count = 1;
         %let _OUTPUT_col5_name = etls_jobRC;
         %let _OUTPUT_col5_table = work.W1Q39IZH;
         %let _OUTPUT_col5_length = 8;
         %let _OUTPUT_col5_type = ;
         %let _OUTPUT_col5_format = ;
         %let _OUTPUT_col5_informat = ;
         %let _OUTPUT_col5_label = %nrquote(Return code of task);
         %let _OUTPUT_col5_input0 = etls_jobRC;
         %let _OUTPUT_col5_exp = ;
         %let _OUTPUT_col5_input = etls_jobRC;
         %let _OUTPUT_col5_input_count = 1;
         %let _OUTPUT_col6_name = TABLE_NAME;
         %let _OUTPUT_col6_table = work.W1Q39IZH;
         %let _OUTPUT_col6_length = 32;
         %let _OUTPUT_col6_type = $;
         %let _OUTPUT_col6_format = ;
         %let _OUTPUT_col6_informat = ;
         %let _OUTPUT_col6_label = %nrquote();
         %let _OUTPUT_col6_input0 = TABLE_NAME;
         %let _OUTPUT_col6_exp = ;
         %let _OUTPUT_col6_input = TABLE_NAME;
         %let _OUTPUT_col6_input_count = 1;
         %let _OUTPUT_col7_name = TYPE;
         %let _OUTPUT_col7_table = work.W1Q39IZH;
         %let _OUTPUT_col7_length = 20;
         %let _OUTPUT_col7_type = $;
         %let _OUTPUT_col7_format = ;
         %let _OUTPUT_col7_informat = ;
         %let _OUTPUT_col7_label = %nrquote();
         %let _OUTPUT_col7_input0 = TYPE;
         %let _OUTPUT_col7_exp = ;
         %let _OUTPUT_col7_input = TYPE;
         %let _OUTPUT_col7_input_count = 1;
         %let _OUTPUT_col8_name = LOAD_TIMESTAMP;
         %let _OUTPUT_col8_table = work.W1Q39IZH;
         %let _OUTPUT_col8_length = 8;
         %let _OUTPUT_col8_type = ;
         %let _OUTPUT_col8_format = datetime20.;
         %let _OUTPUT_col8_informat = datetime20.;
         %let _OUTPUT_col8_label = %nrquote();
         %let _OUTPUT_col8_input0 = LOAD_TIMESTAMP;
         %let _OUTPUT_col8_exp = ;
         %let _OUTPUT_col8_input = LOAD_TIMESTAMP;
         %let _OUTPUT_col8_input_count = 1;
         %let _OUTPUT_filetype = WorkTable;
         
         %let _OUTPUT1 = work.W1Q39IZH;
         %let _OUTPUT1_connect = ;
         %let _OUTPUT1_engine = ;
         %let _OUTPUT1_memtype = DATA;
         %let _OUTPUT1_options = %nrquote();
         %let _OUTPUT1_alter = %nrquote();
         %let _OUTPUT1_path = %nrquote(/User Written_A5V8BXSQ.AQ0001D5%(WorkTable%));
         %let _OUTPUT1_type = 1;
         %let _OUTPUT1_label = %nrquote();
         /* List of target columns to keep  */ 
         %let _OUTPUT1_keep = etls_handleName etls_machineId etls_startTime etls_endTime etls_status 
                 etls_jobRC TABLE_NAME TYPE LOAD_TIMESTAMP;
         %let _OUTPUT1_col_count = 9;
         %let _OUTPUT1_col0_name = etls_handleName;
         %let _OUTPUT1_col0_table = work.W1Q39IZH;
         %let _OUTPUT1_col0_length = 32;
         %let _OUTPUT1_col0_type = $;
         %let _OUTPUT1_col0_format = ;
         %let _OUTPUT1_col0_informat = ;
         %let _OUTPUT1_col0_label = %nrquote(Name of handle to remote session);
         %let _OUTPUT1_col0_input0 = etls_handleName;
         %let _OUTPUT1_col0_exp = ;
         %let _OUTPUT1_col0_input = etls_handleName;
         %let _OUTPUT1_col0_input_count = 1;
         %let _OUTPUT1_col1_name = etls_machineId;
         %let _OUTPUT1_col1_table = work.W1Q39IZH;
         %let _OUTPUT1_col1_length = 32;
         %let _OUTPUT1_col1_type = $;
         %let _OUTPUT1_col1_format = ;
         %let _OUTPUT1_col1_informat = ;
         %let _OUTPUT1_col1_label = %nrquote(Name of machine executing the task);
         %let _OUTPUT1_col1_input0 = etls_machineId;
         %let _OUTPUT1_col1_exp = ;
         %let _OUTPUT1_col1_input = etls_machineId;
         %let _OUTPUT1_col1_input_count = 1;
         %let _OUTPUT1_col2_name = etls_startTime;
         %let _OUTPUT1_col2_table = work.W1Q39IZH;
         %let _OUTPUT1_col2_length = 8;
         %let _OUTPUT1_col2_type = ;
         %let _OUTPUT1_col2_format = nldatmap.;
         %let _OUTPUT1_col2_informat = ;
         %let _OUTPUT1_col2_label = %nrquote(Start time of task);
         %let _OUTPUT1_col2_input0 = etls_startTime;
         %let _OUTPUT1_col2_exp = ;
         %let _OUTPUT1_col2_input = etls_startTime;
         %let _OUTPUT1_col2_input_count = 1;
         %let _OUTPUT1_col3_name = etls_endTime;
         %let _OUTPUT1_col3_table = work.W1Q39IZH;
         %let _OUTPUT1_col3_length = 8;
         %let _OUTPUT1_col3_type = ;
         %let _OUTPUT1_col3_format = nldatmap.;
         %let _OUTPUT1_col3_informat = ;
         %let _OUTPUT1_col3_label = %nrquote(End time of task);
         %let _OUTPUT1_col3_input0 = etls_endTime;
         %let _OUTPUT1_col3_exp = ;
         %let _OUTPUT1_col3_input = etls_endTime;
         %let _OUTPUT1_col3_input_count = 1;
         %let _OUTPUT1_col4_name = etls_status;
         %let _OUTPUT1_col4_table = work.W1Q39IZH;
         %let _OUTPUT1_col4_length = 32;
         %let _OUTPUT1_col4_type = $;
         %let _OUTPUT1_col4_format = ;
         %let _OUTPUT1_col4_informat = ;
         %let _OUTPUT1_col4_label = %nrquote(Current status of task);
         %let _OUTPUT1_col4_input0 = etls_status;
         %let _OUTPUT1_col4_exp = ;
         %let _OUTPUT1_col4_input = etls_status;
         %let _OUTPUT1_col4_input_count = 1;
         %let _OUTPUT1_col5_name = etls_jobRC;
         %let _OUTPUT1_col5_table = work.W1Q39IZH;
         %let _OUTPUT1_col5_length = 8;
         %let _OUTPUT1_col5_type = ;
         %let _OUTPUT1_col5_format = ;
         %let _OUTPUT1_col5_informat = ;
         %let _OUTPUT1_col5_label = %nrquote(Return code of task);
         %let _OUTPUT1_col5_input0 = etls_jobRC;
         %let _OUTPUT1_col5_exp = ;
         %let _OUTPUT1_col5_input = etls_jobRC;
         %let _OUTPUT1_col5_input_count = 1;
         %let _OUTPUT1_col6_name = TABLE_NAME;
         %let _OUTPUT1_col6_table = work.W1Q39IZH;
         %let _OUTPUT1_col6_length = 32;
         %let _OUTPUT1_col6_type = $;
         %let _OUTPUT1_col6_format = ;
         %let _OUTPUT1_col6_informat = ;
         %let _OUTPUT1_col6_label = %nrquote();
         %let _OUTPUT1_col6_input0 = TABLE_NAME;
         %let _OUTPUT1_col6_exp = ;
         %let _OUTPUT1_col6_input = TABLE_NAME;
         %let _OUTPUT1_col6_input_count = 1;
         %let _OUTPUT1_col7_name = TYPE;
         %let _OUTPUT1_col7_table = work.W1Q39IZH;
         %let _OUTPUT1_col7_length = 20;
         %let _OUTPUT1_col7_type = $;
         %let _OUTPUT1_col7_format = ;
         %let _OUTPUT1_col7_informat = ;
         %let _OUTPUT1_col7_label = %nrquote();
         %let _OUTPUT1_col7_input0 = TYPE;
         %let _OUTPUT1_col7_exp = ;
         %let _OUTPUT1_col7_input = TYPE;
         %let _OUTPUT1_col7_input_count = 1;
         %let _OUTPUT1_col8_name = LOAD_TIMESTAMP;
         %let _OUTPUT1_col8_table = work.W1Q39IZH;
         %let _OUTPUT1_col8_length = 8;
         %let _OUTPUT1_col8_type = ;
         %let _OUTPUT1_col8_format = datetime20.;
         %let _OUTPUT1_col8_informat = datetime20.;
         %let _OUTPUT1_col8_label = %nrquote();
         %let _OUTPUT1_col8_input0 = LOAD_TIMESTAMP;
         %let _OUTPUT1_col8_exp = ;
         %let _OUTPUT1_col8_input = LOAD_TIMESTAMP;
         %let _OUTPUT1_col8_input_count = 1;
         %let _OUTPUT1_filetype = WorkTable;
         
         /*---- Start of User Written Code  ----*/ 
         
         %macro archive;
          proc sql;
          create table mvbsarch.&SAS_TABLE_NAMES as
          		select *
         			from resasdm.&SAS_TABLE_NAMES;
         quit;
         %mend archive;
         %archive;
         /*---- End of User Written Code  ----*/ 
         
         %rcSet(&syserr); 
         %rcSet(&sqlrc); 
         
         
         /**  Step end User Written SAS_ARCHIVING **/
         
      %mend etls_jobW1015MS19; 
      
      %etls_jobW1015MS19; 
      
      %let handleName = %etls_getHandle(statusTable=&etls_statusTable,
         handleVariable=etls_handleName, row=&&&etls_controlName);
         
      %let job_rc&handleName. = &job_rc; 
      
      %etls_freeHandle(statusTable=&etls_statusTable, statusVariable=etls_status, 
         handleVariable=etls_handleName, handleName="&handleName", 
         startTimeVariable=etls_startTime, endTimeVariable=etls_endTime, signoff=0, 
         returnCodeVariable=etls_jobRC, returnCodeMacroVariable=job_rc&handleName., setMainJobRc=1); 
         
   %mend etls_processToLoopW1015MS0Z;
   
   %local etls_controlTable etls_statusTable etls_controlName 
      etls_processesRunning etls_maxProcesses etls_parameterTable 
      etls_additionalSignonOptions etls_signonRetries;
   %let etls_controlName = L47_; 
   %let etls_statusTable = work.W1Q1XC52; 
   %let etls_parameterTable = work.W1015MS2B; 
   %let &etls_controlName = 0;
   %let etls_controlTable = work.W1Q0P4MN;
   
   %put %str(NOTE: Creating status table...);
   data &etls_statusTable 
      (keep = etls_handleName etls_machineId etls_startTime etls_endTime etls_status 
              etls_jobRC TABLE_NAME TYPE LOAD_TIMESTAMP
      );
      attrib etls_handleName length = $32
         label = 'Name of handle to remote session'; 
      attrib etls_machineId length = $32
         label = 'Name of machine executing the task'; 
      attrib etls_startTime length = 8
         format = nldatmap.
         label = 'Start time of task'; 
      attrib etls_endTime length = 8
         format = nldatmap.
         label = 'End time of task'; 
      attrib etls_status length = $32
         label = 'Current status of task'; 
      attrib etls_jobRC length = 8
         label = 'Return code of task'; 
      attrib TABLE_NAME length = $32; 
      attrib TYPE length = $20; 
      attrib LOAD_TIMESTAMP length = 8
         format = datetime20.
         informat = datetime20.; 
      set &etls_controlTable;
   run;
   
   %rcSet(&syserr); 
   
   %put %str(NOTE: Creating parameter table...);
   proc sql; 
      create table &etls_parameterTable as 
         select TABLE_NAME as SAS_TABLE_NAMES 
         from &etls_controlTable; 
   quit; 
   
   %rcSet(&sqlrc); 
   
   /* Get the number of times to iterate from the number of rows in the source  */ 
   /*  table                                                                    */ 
   proc sql noprint; 
      select count(*) into :&etls_controlName._max from &etls_statusTable;
      %let &etls_controlName._max = &&&etls_controlName._max;
   quit;
   
   %rcSet(&sqlrc); 
   
   %let etls_maxProcesses = 1; 
   
   %if (&etls_maxProcesses > 0) %then 
   %do; 
      %do %until (&&&etls_controlName ge &&&etls_controlName._max); 
      
         %let etls_lastLoopPtr = &&&etls_controlName;
         
         %let etls_processesRunning = 0; 
         
         %do %while(&etls_processesRunning lt &&&etls_controlName._max 
            and &etls_processesRunning lt &etls_maxProcesses 
            and &&&etls_controlName lt &&&etls_controlName._max);
            
            %let &etls_controlName = %eval(&&&etls_controlName+1);
            
            %let job_rcLast=&job_rc; 
            
            %etls_createHandle(statusTable=&etls_statusTable,
                               statusVariable=etls_status,
                               handleVariable=etls_handleName,
                               handlePrefix=&etls_controlName,
                               statusSetting="Running",
                               row=&&&etls_controlName,
                               machineVariable=etls_machineId,
                               startTimeVariable=etls_startTime,
                               signon=0,
                               useGrid=0);
            
         %let etls_processesRunning = 1; 
         %etls_processToLoopW1015MS0Z(parameterTable=&etls_parameterTable, row=&&&etls_controlName,
            handleName=%etls_getHandle(statusTable=&etls_statusTable,
            handleVariable=etls_handleName, row=&&&etls_controlName)); 
         
         /* Reset main Job_RC and Trans_RC to max return code of all iterations */ 
         %let job_rcThisIter=&job_rc; 
         %let job_rc=&job_rcLast; 
         %let trans_rc=&job_rcLast; 
         %rcSet(&job_rcThisIter); 
      %end; 
      
   %end; 
   
%end;

proc datasets lib = work nolist nowarn memtype = (data view);
   delete W1015MS2B;
quit;

%mend etls_loopW1015MS0P; 

%etls_loopW1015MS0P; 



/**  Step end Loop for SAS tables **/

/*==========================================================================* 
 * Step:            Loop End                              A5V8BXSQ.AW0003AL * 
 * Transform:       Loop End                                                * 
 * Description:                                                             * 
 *==========================================================================*/ 

%let transformID = %quote(A5V8BXSQ.AW0003AL);
%let trans_rc = 0;
%let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 



/**  Step end Loop End **/

/*==========================================================================* 
 * Step:            Conditional Start                     A5V8BXSQ.AW0004VN * 
 * Transform:       Conditional Start                                       * 
 * Description:                                                             * 
 *==========================================================================*/ 

%let transformID = %quote(A5V8BXSQ.AW0004VN);
%let trans_rc = 0;
%let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 

%let ETLS_SYSLAST = &SYSLAST;
/*---- Start of Pre-Process Code  ----*/ 

%let reporting_period1=%sysfunc(putn(%sysfunc(intnx(quarter, %sysfunc(inputn(&reporting_period., yyq6)), -2, end)), yyq6));
%put &reporting_period1;
/*---- End of Pre-Process Code  ----*/ 

%rcSet(&syserr); 
%rcSet(&sqlrc); 

%let SYSLAST = &ETLS_SYSLAST;

%macro etls_conditionWDDRWGBV;
   %local etls_conditionTrue;
   %let etls_conditionTrue = %eval(%sysfunc(substr(&reporting_period,6,1)) ne 2);
   %if (&etls_conditionTrue=0) %then
   %do;
      %put ETLS_DIAG: Condition flow did NOT execute, condition was %sysfunc(substr(&reporting_period,6,1)) ne 2;
      %goto exitetls_conditionWDDRWGBV;
   %end;
   %else
   %do;
      %put ETLS_DIAG: Condition flow did execute, condition was %sysfunc(substr(&reporting_period,6,1)) ne 2;
   %end;
/**************************************************************************** 
 * Job:             MVBS_OUTPUT_ARCHIVE                   A5V8BXSQ.AR0001PH * 
 * Description:                                                             * 
 *                                                                          * 
 * Metadata Server: bire-sas94-meta-dev.srv.allianz                         * 
 * Port:            8561                                                    * 
 * Location:        /ETL/tdbpcd/Jobs/MVBS/MVBS_ARCHIVE                      * 
 *                                                                          * 
 * Server:          tdbpcd                                A5HYR2NS.AS00001O * 
 *                                                                          * 
 * Source Tables:   MVBS_OUTPUT - RESASDWH.MVBS_OUTPUT    A5V8BXSQ.AE0001W7 * 
 *                  MVBS_LOG - RESASDWH.MVBS_LOG          A5V8BXSQ.AE0001W3 * 
 * Target Tables:   MVBS_OUTPUT_ARCHIVE -                 A5V8BXSQ.AE0002CR * 
 *                   RESASDWH.MVBS_OUTPUT_ARCHIVE                           * 
 *                  MVBS_OUTPUT - RESASDWH.MVBS_OUTPUT    A5V8BXSQ.AE0001W7 * 
 *                                                                          * 
 * Generated on:    Friday, June 9, 2017 6:44:03 PM IST                     * 
 * Generated by:    re00580                                                 * 
 * Version:         SAS Data Integration Studio 4.901                       * 
 ****************************************************************************/ 

/* Generate the process id for job  */ 
%put Process ID: &SYSJOBID;

/* General macro variables  */ 
%let jobID = %quote(A5V8BXSQ.AR0001PH);
%let etls_jobName = %nrquote(MVBS_OUTPUT_ARCHIVE);
%let etls_userID = %nrquote(re00580);


/* Create metadata macro variables */
%let IOMServer      = %nrquote(tdbpcd);
%let metaPort       = %nrquote(8561);
%let metaServer     = %nrquote(ibire-sas94-meta-dev.srv.allianz);

/* Setup for capturing job status  */ 
%let etls_startTime = %sysfunc(datetime(),datetime.);
%let etls_recordsBefore = 0;
%let etls_recordsAfter = 0;
%let etls_lib = 0;
%let etls_table = 0;

%global etls_debug; 
%macro etls_setDebug; 
   %if %str(&etls_debug) ne 0 %then 
      OPTIONS MPRINT%str(;); 
%mend; 
%etls_setDebug; 

/*==========================================================================* 
 * Step:            Create Table                          A5V8BXSQ.AW0004VE * 
 * Transform:       Create Table                                            * 
 * Description:                                                             * 
 *                                                                          * 
 * Source Tables:   MVBS_OUTPUT - RESASDWH.MVBS_OUTPUT    A5V8BXSQ.AE0001W7 * 
 *                  MVBS_LOG - RESASDWH.MVBS_LOG          A5V8BXSQ.AE0001W3 * 
 * Target Table:    Create Table - work.WCOBHOG1          A5V8BXSQ.AQ000260 * 
 *==========================================================================*/ 

%let transformID = %quote(A5V8BXSQ.AW0004VE);
%let trans_rc = 0;
%let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 

%global etls_sql_pushDown;
%let etls_sql_pushDown = -1;
option DBIDIRECTEXEC;

proc datasets lib = work nolist nowarn memtype = (data view);
   delete WCOBHOG1;
quit;

proc sql
;
create view work.WCOBHOG1 as
select
   MVBS_OUTPUT.LINE_NUMBER length = 8   
      label = 'LINE_NUMBER',
   MVBS_OUTPUT.FILENAME length = 100   
      format = $100.
      informat = $100.
      label = 'FILENAME',
   MVBS_OUTPUT.DISCUNDISC length = 12   
      format = $12.
      informat = $12.
      label = 'DISCUNDISC',
   MVBS_OUTPUT.LEGAL_ENTITY_NAME length = 50   
      format = $50.
      informat = $50.
      label = 'LEGAL_ENTITY_NAME',
   MVBS_OUTPUT.MANDANT_ID length = 5   
      format = $5.
      informat = $5.
      label = 'MANDANT_ID',
   MVBS_OUTPUT.PROP_NONPROP length = 15   
      format = $15.
      informat = $15.
      label = 'PROP_NONPROP',
   MVBS_OUTPUT.CEDENT_DOM_ID length = 23   
      format = $23.
      informat = $23.
      label = 'CEDENT_DOM_ID',
   MVBS_OUTPUT.INTEXT length = 8   
      format = $8.
      informat = $8.
      label = 'INTEXT',
   MVBS_OUTPUT.CONVENTIONAL_SCOB_IN_SICS length = 25   
      format = $25.
      informat = $25.
      label = 'CONVENTIONAL_SCOB_IN_SICS',
   MVBS_OUTPUT.RES_SEG_LEVEL1 length = 30   
      format = $30.
      informat = $30.
      label = 'RES_SEG_LEVEL1',
   MVBS_OUTPUT.RES_SEG_LEVEL2 length = 30   
      format = $30.
      informat = $30.
      label = 'RES_SEG_LEVEL2',
   MVBS_OUTPUT.RES_SEG_LEVEL3 length = 30   
      format = $30.
      informat = $30.
      label = 'RES_SEG_LEVEL3',
   MVBS_OUTPUT.RES_SEG_LEVEL4 length = 30   
      format = $30.
      informat = $30.
      label = 'RES_SEG_LEVEL4',
   MVBS_OUTPUT.RES_SEG_LEVEL5 length = 30   
      format = $30.
      informat = $30.
      label = 'RES_SEG_LEVEL5',
   MVBS_OUTPUT.CURR_TO_USE length = 11   
      format = $11.
      informat = $11.
      label = 'CURR_TO_USE',
   MVBS_OUTPUT.INWARD_BUS_ID length = 36   
      format = $36.
      informat = $36.
      label = 'INWARD_BUS_ID',
   MVBS_OUTPUT.OUTWARD_BUS_ID length = 36   
      format = $36.
      informat = $36.
      label = 'OUTWARD_BUS_ID',
   MVBS_OUTPUT.PARTNER_ID_RETRO length = 20   
      format = $20.
      informat = $20.
      label = 'PARTNER_ID_RETRO',
   MVBS_OUTPUT.VBUND_RETRO length = 15   
      format = $15.
      informat = $15.
      label = 'VBUND_RETRO',
   MVBS_OUTPUT.INTEXT_RETRO length = 12   
      format = $12.
      informat = $12.
      label = 'INTEXT_RETRO',
   MVBS_OUTPUT.REL_YR_ID length = 9   
      format = $9.
      informat = $9.
      label = 'REL_YR_ID',
   MVBS_OUTPUT.REL_YR_VAL length = 8   
      format = $8.
      informat = $8.
      label = 'REL_YR_VAL',
   MVBS_OUTPUT.LRDB_VAL_DATE length = 13   
      format = $13.
      informat = $13.
      label = 'LRDB_VAL_DATE',
   MVBS_OUTPUT.AMT_TYPE length = 16   
      format = $16.
      informat = $16.
      label = 'AMT_TYPE',
   MVBS_OUTPUT.GROSSRETRO length = 5   
      format = $5.
      informat = $5.
      label = 'GROSSRETRO',
   MVBS_OUTPUT.PERIOD length = 5   
      format = $5.
      informat = $5.
      label = 'PERIOD',
   MVBS_OUTPUT.EUR_AMOUNT length = 8   
      label = 'EUR_AMOUNT',
   MVBS_OUTPUT.AMOUNT length = 8   
      label = 'AMOUNT',
   MVBS_OUTPUT.PARTNER_ID_GROSS length = 15   
      format = $15.
      informat = $15.
      label = 'PARTNER_ID_GROSS',
   MVBS_OUTPUT.VBUND_GROSS length = 10   
      format = $10.
      informat = $10.
      label = 'VBUND_GROSS',
   MVBS_OUTPUT.SEGMENT length = 20   
      format = $20.
      informat = $20.
      label = 'SEGMENT',
   MVBS_OUTPUT.LEGAL_ENTITY_CODE length = 6   
      format = $6.
      informat = $6.
      label = 'LEGAL_ENTITY_CODE',
   MVBS_OUTPUT.REGION length = 5   
      format = $5.
      informat = $5.
      label = 'REGION',
   MVBS_OUTPUT.COUNTRY_ID_TECHDB length = 2   
      format = $2.
      informat = $2.
      label = 'COUNTRY_ID_TECHDB',
   MVBS_OUTPUT.ABACUS_SII_LOB length = 50   
      format = $50.
      informat = $50.
      label = 'ABACUS_SII_LOB',
   MVBS_OUTPUT.CARVE_OUT_LOB length = 50   
      format = $50.
      informat = $50.
      label = 'CARVE_OUT_LOB',
   MVBS_OUTPUT.GUIDE_6_LOB length = 50   
      format = $50.
      informat = $50.
      label = 'GUIDE_6_LOB',
   MVBS_OUTPUT.SUPER_LOB length = 50   
      format = $50.
      informat = $50.
      label = 'SUPER_LOB',
   MVBS_OUTPUT.SII_LOB_CODE length = 50   
      format = $50.
      informat = $50.
      label = 'SII_LOB_CODE',
   MVBS_OUTPUT.SII_LOB_STRING length = 200   
      format = $200.
      informat = $200.
      label = 'SII_LOB_STRING',
   MVBS_OUTPUT.SM_LOB length = 50   
      format = $50.
      informat = $50.
      label = 'SM_LOB',
   MVBS_OUTPUT.PARTNER_ID_GROSS_DERIVED length = 5   
      format = $5.
      informat = $5.
      label = 'PARTNER_ID_GROSS_DERIVED',
   MVBS_OUTPUT.PROP_NONPROP_RETRO length = 18   
      format = $18.
      informat = $18.
      label = 'PROP_NONPROP_RETRO',
   MVBS_OUTPUT.VERSION_ID length = 8   
      label = 'VERSION_ID',
   MVBS_OUTPUT.LOAD_TIMESTAMP length = 8   
      format = DATETIME20.
      informat = DATETIME20.
      label = 'LOAD_TIMESTAMP',
   MVBS_OUTPUT.QRT_RELEVANT length = 1   
      format = $1.
      informat = $1.
      label = 'QRT_RELEVANT',
   MVBS_OUTPUT.CLAIM_TYPE length = 1   
      format = $1.
      informat = $1.
      label = 'CLAIM_TYPE',
   MVBS_OUTPUT.DISCOUNT_RATE_FLAG length = 1   
      format = $1.
      informat = $1.
      label = 'DISCOUNT_RATE_FLAG',
   MVBS_OUTPUT.INSTRUMENT length = 6   
      format = $6.
      informat = $6.
      label = 'INSTRUMENT'
from
   RESASDWH.MVBS_OUTPUT as MVBS_OUTPUT
where
   MVBS_OUTPUT.VERSION_ID IN (
      select distinct
         MVBS_LOG.VERSION_ID length = 8   
            label = 'VERSION_ID'
      from
         RESASDWH.MVBS_LOG as MVBS_LOG
      where
         MVBS_LOG.REPORTING_PERIOD = "&reporting_period1"
   )
;
quit;

%global etls_sql_pushDown;
%let etls_sql_pushDown = &sys_sql_ip_all;

%rcSet(&sqlrc); 



/**  Step end Create Table **/

/*==========================================================================* 
 * Step:            Table Loader                          A5V8BXSQ.AW0004VF * 
 * Transform:       Table Loader (Version 2.1)                              * 
 * Description:                                                             * 
 *                                                                          * 
 * Source Table:    Create Table - work.WCOBHOG1          A5V8BXSQ.AQ000260 * 
 * Target Table:    MVBS_OUTPUT_ARCHIVE -                 A5V8BXSQ.AE0002CR * 
 *                   RESASDWH.MVBS_OUTPUT_ARCHIVE                           * 
 *==========================================================================*/ 

%let transformID = %quote(A5V8BXSQ.AW0004VF);
%let trans_rc = 0;
%let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 

%let SYSLAST = %nrquote(work.WCOBHOG1); 

%global etls_sql_pushDown;
%let etls_sql_pushDown = -1;
option DBIDIRECTEXEC;

%global etls_tableExist;
%global etls_numIndex;
%global etls_lastTable;
%let etls_tableExist = -1; 
%let etls_numIndex = -1; 
%let etls_lastTable = &SYSLAST; 

/*---- Define load data macro  ----*/ 

/* --------------------------------------------------------------
   Load Technique Selection: AppendToExisting - AppendProc
   Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
   Additional options selections... 
      Set unmapped to missing on updates: false 
   -------------------------------------------------------------- */
%macro etls_loader;

   %let etls_tableOptions = ;
   
   /* Determine if the target table exists  */ 
   %let etls_tableExist = %eval(%sysfunc(exist(RESASDWH.MVBS_OUTPUT_ARCHIVE, DATA)) or 
         %sysfunc(exist(RESASDWH.MVBS_OUTPUT_ARCHIVE, VIEW))); 
   
   /*---- Create a new table  ----*/ 
   %if (&etls_tableExist eq 0) %then 
   %do;  /* if table does not exist  */ 
   
      %put %str(NOTE: Creating table ...);
      
      data RESASDWH.MVBS_OUTPUT_ARCHIVE
              (dbnull = (
                         LINE_NUMBER = YES
                         FILENAME = YES
                         DISCUNDISC = YES
                         LEGAL_ENTITY_NAME = YES
                         MANDANT_ID = YES
                         PROP_NONPROP = YES
                         CEDENT_DOM_ID = YES
                         INTEXT = YES
                         CONVENTIONAL_SCOB_IN_SICS = YES
                         RES_SEG_LEVEL1 = YES
                         RES_SEG_LEVEL2 = YES
                         RES_SEG_LEVEL3 = YES
                         RES_SEG_LEVEL4 = YES
                         RES_SEG_LEVEL5 = YES
                         CURR_TO_USE = YES
                         INWARD_BUS_ID = YES
                         OUTWARD_BUS_ID = YES
                         PARTNER_ID_RETRO = YES
                         VBUND_RETRO = YES
                         INTEXT_RETRO = YES
                         REL_YR_ID = YES
                         REL_YR_VAL = YES
                         LRDB_VAL_DATE = YES
                         AMT_TYPE = YES
                         GROSSRETRO = YES
                         PERIOD = YES
                         EUR_AMOUNT = YES
                         AMOUNT = YES
                         PARTNER_ID_GROSS = YES
                         VBUND_GROSS = YES
                         SEGMENT = YES
                         LEGAL_ENTITY_CODE = YES
                         REGION = YES
                         COUNTRY_ID_TECHDB = YES
                         ABACUS_SII_LOB = YES
                         CARVE_OUT_LOB = YES
                         GUIDE_6_LOB = YES
                         SUPER_LOB = YES
                         SII_LOB_CODE = YES
                         SII_LOB_STRING = YES
                         SM_LOB = YES
                         PARTNER_ID_GROSS_DERIVED = YES
                         PROP_NONPROP_RETRO = YES
                         VERSION_ID = YES
                         LOAD_TIMESTAMP = YES
                         QRT_RELEVANT = NO
                         CLAIM_TYPE = YES
                         DISCOUNT_RATE_FLAG = YES
                         INSTRUMENT = YES));
         attrib LINE_NUMBER length = 8
            label = 'LINE_NUMBER'; 
         attrib FILENAME length = $100
            format = $100.
            informat = $100.
            label = 'FILENAME'; 
         attrib DISCUNDISC length = $12
            format = $12.
            informat = $12.
            label = 'DISCUNDISC'; 
         attrib LEGAL_ENTITY_NAME length = $50
            format = $50.
            informat = $50.
            label = 'LEGAL_ENTITY_NAME'; 
         attrib MANDANT_ID length = $5
            format = $5.
            informat = $5.
            label = 'MANDANT_ID'; 
         attrib PROP_NONPROP length = $15
            format = $15.
            informat = $15.
            label = 'PROP_NONPROP'; 
         attrib CEDENT_DOM_ID length = $23
            format = $23.
            informat = $23.
            label = 'CEDENT_DOM_ID'; 
         attrib INTEXT length = $8
            format = $8.
            informat = $8.
            label = 'INTEXT'; 
         attrib CONVENTIONAL_SCOB_IN_SICS length = $25
            format = $25.
            informat = $25.
            label = 'CONVENTIONAL_SCOB_IN_SICS'; 
         attrib RES_SEG_LEVEL1 length = $30
            format = $30.
            informat = $30.
            label = 'RES_SEG_LEVEL1'; 
         attrib RES_SEG_LEVEL2 length = $30
            format = $30.
            informat = $30.
            label = 'RES_SEG_LEVEL2'; 
         attrib RES_SEG_LEVEL3 length = $30
            format = $30.
            informat = $30.
            label = 'RES_SEG_LEVEL3'; 
         attrib RES_SEG_LEVEL4 length = $30
            format = $30.
            informat = $30.
            label = 'RES_SEG_LEVEL4'; 
         attrib RES_SEG_LEVEL5 length = $30
            format = $30.
            informat = $30.
            label = 'RES_SEG_LEVEL5'; 
         attrib CURR_TO_USE length = $11
            format = $11.
            informat = $11.
            label = 'CURR_TO_USE'; 
         attrib INWARD_BUS_ID length = $36
            format = $36.
            informat = $36.
            label = 'INWARD_BUS_ID'; 
         attrib OUTWARD_BUS_ID length = $36
            format = $36.
            informat = $36.
            label = 'OUTWARD_BUS_ID'; 
         attrib PARTNER_ID_RETRO length = $20
            format = $20.
            informat = $20.
            label = 'PARTNER_ID_RETRO'; 
         attrib VBUND_RETRO length = $15
            format = $15.
            informat = $15.
            label = 'VBUND_RETRO'; 
         attrib INTEXT_RETRO length = $12
            format = $12.
            informat = $12.
            label = 'INTEXT_RETRO'; 
         attrib REL_YR_ID length = $9
            format = $9.
            informat = $9.
            label = 'REL_YR_ID'; 
         attrib REL_YR_VAL length = $8
            format = $8.
            informat = $8.
            label = 'REL_YR_VAL'; 
         attrib LRDB_VAL_DATE length = $13
            format = $13.
            informat = $13.
            label = 'LRDB_VAL_DATE'; 
         attrib AMT_TYPE length = $16
            format = $16.
            informat = $16.
            label = 'AMT_TYPE'; 
         attrib GROSSRETRO length = $5
            format = $5.
            informat = $5.
            label = 'GROSSRETRO'; 
         attrib PERIOD length = $5
            format = $5.
            informat = $5.
            label = 'PERIOD'; 
         attrib EUR_AMOUNT length = 8
            label = 'EUR_AMOUNT'; 
         attrib AMOUNT length = 8
            label = 'AMOUNT'; 
         attrib PARTNER_ID_GROSS length = $15
            format = $15.
            informat = $15.
            label = 'PARTNER_ID_GROSS'; 
         attrib VBUND_GROSS length = $10
            format = $10.
            informat = $10.
            label = 'VBUND_GROSS'; 
         attrib SEGMENT length = $20
            format = $20.
            informat = $20.
            label = 'SEGMENT'; 
         attrib LEGAL_ENTITY_CODE length = $6
            format = $6.
            informat = $6.
            label = 'LEGAL_ENTITY_CODE'; 
         attrib REGION length = $5
            format = $5.
            informat = $5.
            label = 'REGION'; 
         attrib COUNTRY_ID_TECHDB length = $2
            format = $2.
            informat = $2.
            label = 'COUNTRY_ID_TECHDB'; 
         attrib ABACUS_SII_LOB length = $50
            format = $50.
            informat = $50.
            label = 'ABACUS_SII_LOB'; 
         attrib CARVE_OUT_LOB length = $50
            format = $50.
            informat = $50.
            label = 'CARVE_OUT_LOB'; 
         attrib GUIDE_6_LOB length = $50
            format = $50.
            informat = $50.
            label = 'GUIDE_6_LOB'; 
         attrib SUPER_LOB length = $50
            format = $50.
            informat = $50.
            label = 'SUPER_LOB'; 
         attrib SII_LOB_CODE length = $50
            format = $50.
            informat = $50.
            label = 'SII_LOB_CODE'; 
         attrib SII_LOB_STRING length = $200
            format = $200.
            informat = $200.
            label = 'SII_LOB_STRING'; 
         attrib SM_LOB length = $50
            format = $50.
            informat = $50.
            label = 'SM_LOB'; 
         attrib PARTNER_ID_GROSS_DERIVED length = $5
            format = $5.
            informat = $5.
            label = 'PARTNER_ID_GROSS_DERIVED'; 
         attrib PROP_NONPROP_RETRO length = $18
            format = $18.
            informat = $18.
            label = 'PROP_NONPROP_RETRO'; 
         attrib VERSION_ID length = 8
            label = 'VERSION_ID'; 
         attrib LOAD_TIMESTAMP length = 8
            format = DATETIME20.
            informat = DATETIME20.
            label = 'LOAD_TIMESTAMP'; 
         attrib QRT_RELEVANT length = $1
            format = $1.
            informat = $1.
            label = 'QRT_RELEVANT'; 
         attrib CLAIM_TYPE length = $1
            format = $1.
            informat = $1.
            label = 'CLAIM_TYPE'; 
         attrib DISCOUNT_RATE_FLAG length = $1
            format = $1.
            informat = $1.
            label = 'DISCOUNT_RATE_FLAG'; 
         attrib INSTRUMENT length = $6
            format = $6.
            informat = $6.
            label = 'INSTRUMENT'; 
         call missing(of _all_);
         stop;
      run;
      
      %rcSet(&syserr); 
      
   %end;  /* if table does not exist  */ 
   
   /*---- Append  ----*/ 
   %put %str(NOTE: Appending data ...);
   
   proc append base = RESASDWH.MVBS_OUTPUT_ARCHIVE 
      data = &etls_lastTable (&etls_tableOptions)  force ; 
    run; 
   
   %rcSet(&syserr); 
   
%mend etls_loader;
%etls_loader;



/**  Step end Table Loader **/

/*==========================================================================* 
 * Step:            Execute                               A5V8BXSQ.AW0004VG * 
 * Transform:       Execute                                                 * 
 * Description:                                                             * 
 *                                                                          * 
 * Target Table:    MVBS_OUTPUT - RESASDWH.MVBS_OUTPUT    A5V8BXSQ.AE0001W7 * 
 *                                                                          * 
 * User Written:    SourceCode                                              * 
 *==========================================================================*/ 

%let transformID = %quote(A5V8BXSQ.AW0004VG);
%let trans_rc = 0;
%let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 

%let _INPUT_count = 0;
%let _OUTPUT_count = 1;
%let _OUTPUT = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_connect =  DBMAX_TEXT=32767 PATH="&ORA_RESASDWH_PATH" user="&ORA_RESASDWH_USER" pw="&ORA_RESASDWH_PWD"
;
%let _OUTPUT_engine = ORACLE;
%let _OUTPUT_memtype = DATA;
%let _OUTPUT_options = %nrquote();
%let _OUTPUT_alter = %nrquote();
%let _OUTPUT_path = %nrquote(/ETL/tdbpcd/Tables/Target/MVBS/MVBS_OUTPUT%(Table%));
%let _OUTPUT_type = 1;
%let _OUTPUT_label = %nrquote();
/* List of target columns to keep  */ 
%let _OUTPUT_keep = LINE_NUMBER FILENAME DISCUNDISC LEGAL_ENTITY_NAME MANDANT_ID 
        PROP_NONPROP CEDENT_DOM_ID INTEXT CONVENTIONAL_SCOB_IN_SICS 
        RES_SEG_LEVEL1 RES_SEG_LEVEL2 RES_SEG_LEVEL3 RES_SEG_LEVEL4 
        RES_SEG_LEVEL5 CURR_TO_USE INWARD_BUS_ID OUTWARD_BUS_ID 
        PARTNER_ID_RETRO VBUND_RETRO INTEXT_RETRO REL_YR_ID REL_YR_VAL 
        LRDB_VAL_DATE AMT_TYPE GROSSRETRO PERIOD EUR_AMOUNT AMOUNT 
        PARTNER_ID_GROSS VBUND_GROSS SEGMENT LEGAL_ENTITY_CODE REGION 
        COUNTRY_ID_TECHDB ABACUS_SII_LOB CARVE_OUT_LOB GUIDE_6_LOB SUPER_LOB 
        SII_LOB_CODE SII_LOB_STRING SM_LOB PARTNER_ID_GROSS_DERIVED 
        PROP_NONPROP_RETRO VERSION_ID LOAD_TIMESTAMP QRT_RELEVANT CLAIM_TYPE 
        DISCOUNT_RATE_FLAG INSTRUMENT;
%let _OUTPUT_col_count = 49;
%let _OUTPUT_col0_name = LINE_NUMBER;
%let _OUTPUT_col0_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col0_length = 8;
%let _OUTPUT_col0_type = ;
%let _OUTPUT_col0_format = ;
%let _OUTPUT_col0_informat = ;
%let _OUTPUT_col0_label = %nrquote(LINE_NUMBER);
%let _OUTPUT_col0_exp = ;
%let _OUTPUT_col0_input_count = 0;
%let _OUTPUT_col1_name = FILENAME;
%let _OUTPUT_col1_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col1_length = 100;
%let _OUTPUT_col1_type = $;
%let _OUTPUT_col1_format = $100.;
%let _OUTPUT_col1_informat = $100.;
%let _OUTPUT_col1_label = %nrquote(FILENAME);
%let _OUTPUT_col1_exp = ;
%let _OUTPUT_col1_input_count = 0;
%let _OUTPUT_col2_name = DISCUNDISC;
%let _OUTPUT_col2_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col2_length = 12;
%let _OUTPUT_col2_type = $;
%let _OUTPUT_col2_format = $12.;
%let _OUTPUT_col2_informat = $12.;
%let _OUTPUT_col2_label = %nrquote(DISCUNDISC);
%let _OUTPUT_col2_exp = ;
%let _OUTPUT_col2_input_count = 0;
%let _OUTPUT_col3_name = LEGAL_ENTITY_NAME;
%let _OUTPUT_col3_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col3_length = 50;
%let _OUTPUT_col3_type = $;
%let _OUTPUT_col3_format = $50.;
%let _OUTPUT_col3_informat = $50.;
%let _OUTPUT_col3_label = %nrquote(LEGAL_ENTITY_NAME);
%let _OUTPUT_col3_exp = ;
%let _OUTPUT_col3_input_count = 0;
%let _OUTPUT_col4_name = MANDANT_ID;
%let _OUTPUT_col4_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col4_length = 5;
%let _OUTPUT_col4_type = $;
%let _OUTPUT_col4_format = $5.;
%let _OUTPUT_col4_informat = $5.;
%let _OUTPUT_col4_label = %nrquote(MANDANT_ID);
%let _OUTPUT_col4_exp = ;
%let _OUTPUT_col4_input_count = 0;
%let _OUTPUT_col5_name = PROP_NONPROP;
%let _OUTPUT_col5_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col5_length = 15;
%let _OUTPUT_col5_type = $;
%let _OUTPUT_col5_format = $15.;
%let _OUTPUT_col5_informat = $15.;
%let _OUTPUT_col5_label = %nrquote(PROP_NONPROP);
%let _OUTPUT_col5_exp = ;
%let _OUTPUT_col5_input_count = 0;
%let _OUTPUT_col6_name = CEDENT_DOM_ID;
%let _OUTPUT_col6_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col6_length = 23;
%let _OUTPUT_col6_type = $;
%let _OUTPUT_col6_format = $23.;
%let _OUTPUT_col6_informat = $23.;
%let _OUTPUT_col6_label = %nrquote(CEDENT_DOM_ID);
%let _OUTPUT_col6_exp = ;
%let _OUTPUT_col6_input_count = 0;
%let _OUTPUT_col7_name = INTEXT;
%let _OUTPUT_col7_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col7_length = 8;
%let _OUTPUT_col7_type = $;
%let _OUTPUT_col7_format = $8.;
%let _OUTPUT_col7_informat = $8.;
%let _OUTPUT_col7_label = %nrquote(INTEXT);
%let _OUTPUT_col7_exp = ;
%let _OUTPUT_col7_input_count = 0;
%let _OUTPUT_col8_name = CONVENTIONAL_SCOB_IN_SICS;
%let _OUTPUT_col8_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col8_length = 25;
%let _OUTPUT_col8_type = $;
%let _OUTPUT_col8_format = $25.;
%let _OUTPUT_col8_informat = $25.;
%let _OUTPUT_col8_label = %nrquote(CONVENTIONAL_SCOB_IN_SICS);
%let _OUTPUT_col8_exp = ;
%let _OUTPUT_col8_input_count = 0;
%let _OUTPUT_col9_name = RES_SEG_LEVEL1;
%let _OUTPUT_col9_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col9_length = 30;
%let _OUTPUT_col9_type = $;
%let _OUTPUT_col9_format = $30.;
%let _OUTPUT_col9_informat = $30.;
%let _OUTPUT_col9_label = %nrquote(RES_SEG_LEVEL1);
%let _OUTPUT_col9_exp = ;
%let _OUTPUT_col9_input_count = 0;
%let _OUTPUT_col10_name = RES_SEG_LEVEL2;
%let _OUTPUT_col10_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col10_length = 30;
%let _OUTPUT_col10_type = $;
%let _OUTPUT_col10_format = $30.;
%let _OUTPUT_col10_informat = $30.;
%let _OUTPUT_col10_label = %nrquote(RES_SEG_LEVEL2);
%let _OUTPUT_col10_exp = ;
%let _OUTPUT_col10_input_count = 0;
%let _OUTPUT_col11_name = RES_SEG_LEVEL3;
%let _OUTPUT_col11_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col11_length = 30;
%let _OUTPUT_col11_type = $;
%let _OUTPUT_col11_format = $30.;
%let _OUTPUT_col11_informat = $30.;
%let _OUTPUT_col11_label = %nrquote(RES_SEG_LEVEL3);
%let _OUTPUT_col11_exp = ;
%let _OUTPUT_col11_input_count = 0;
%let _OUTPUT_col12_name = RES_SEG_LEVEL4;
%let _OUTPUT_col12_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col12_length = 30;
%let _OUTPUT_col12_type = $;
%let _OUTPUT_col12_format = $30.;
%let _OUTPUT_col12_informat = $30.;
%let _OUTPUT_col12_label = %nrquote(RES_SEG_LEVEL4);
%let _OUTPUT_col12_exp = ;
%let _OUTPUT_col12_input_count = 0;
%let _OUTPUT_col13_name = RES_SEG_LEVEL5;
%let _OUTPUT_col13_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col13_length = 30;
%let _OUTPUT_col13_type = $;
%let _OUTPUT_col13_format = $30.;
%let _OUTPUT_col13_informat = $30.;
%let _OUTPUT_col13_label = %nrquote(RES_SEG_LEVEL5);
%let _OUTPUT_col13_exp = ;
%let _OUTPUT_col13_input_count = 0;
%let _OUTPUT_col14_name = CURR_TO_USE;
%let _OUTPUT_col14_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col14_length = 11;
%let _OUTPUT_col14_type = $;
%let _OUTPUT_col14_format = $11.;
%let _OUTPUT_col14_informat = $11.;
%let _OUTPUT_col14_label = %nrquote(CURR_TO_USE);
%let _OUTPUT_col14_exp = ;
%let _OUTPUT_col14_input_count = 0;
%let _OUTPUT_col15_name = INWARD_BUS_ID;
%let _OUTPUT_col15_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col15_length = 36;
%let _OUTPUT_col15_type = $;
%let _OUTPUT_col15_format = $36.;
%let _OUTPUT_col15_informat = $36.;
%let _OUTPUT_col15_label = %nrquote(INWARD_BUS_ID);
%let _OUTPUT_col15_exp = ;
%let _OUTPUT_col15_input_count = 0;
%let _OUTPUT_col16_name = OUTWARD_BUS_ID;
%let _OUTPUT_col16_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col16_length = 36;
%let _OUTPUT_col16_type = $;
%let _OUTPUT_col16_format = $36.;
%let _OUTPUT_col16_informat = $36.;
%let _OUTPUT_col16_label = %nrquote(OUTWARD_BUS_ID);
%let _OUTPUT_col16_exp = ;
%let _OUTPUT_col16_input_count = 0;
%let _OUTPUT_col17_name = PARTNER_ID_RETRO;
%let _OUTPUT_col17_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col17_length = 20;
%let _OUTPUT_col17_type = $;
%let _OUTPUT_col17_format = $20.;
%let _OUTPUT_col17_informat = $20.;
%let _OUTPUT_col17_label = %nrquote(PARTNER_ID_RETRO);
%let _OUTPUT_col17_exp = ;
%let _OUTPUT_col17_input_count = 0;
%let _OUTPUT_col18_name = VBUND_RETRO;
%let _OUTPUT_col18_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col18_length = 15;
%let _OUTPUT_col18_type = $;
%let _OUTPUT_col18_format = $15.;
%let _OUTPUT_col18_informat = $15.;
%let _OUTPUT_col18_label = %nrquote(VBUND_RETRO);
%let _OUTPUT_col18_exp = ;
%let _OUTPUT_col18_input_count = 0;
%let _OUTPUT_col19_name = INTEXT_RETRO;
%let _OUTPUT_col19_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col19_length = 12;
%let _OUTPUT_col19_type = $;
%let _OUTPUT_col19_format = $12.;
%let _OUTPUT_col19_informat = $12.;
%let _OUTPUT_col19_label = %nrquote(INTEXT_RETRO);
%let _OUTPUT_col19_exp = ;
%let _OUTPUT_col19_input_count = 0;
%let _OUTPUT_col20_name = REL_YR_ID;
%let _OUTPUT_col20_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col20_length = 9;
%let _OUTPUT_col20_type = $;
%let _OUTPUT_col20_format = $9.;
%let _OUTPUT_col20_informat = $9.;
%let _OUTPUT_col20_label = %nrquote(REL_YR_ID);
%let _OUTPUT_col20_exp = ;
%let _OUTPUT_col20_input_count = 0;
%let _OUTPUT_col21_name = REL_YR_VAL;
%let _OUTPUT_col21_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col21_length = 8;
%let _OUTPUT_col21_type = $;
%let _OUTPUT_col21_format = $8.;
%let _OUTPUT_col21_informat = $8.;
%let _OUTPUT_col21_label = %nrquote(REL_YR_VAL);
%let _OUTPUT_col21_exp = ;
%let _OUTPUT_col21_input_count = 0;
%let _OUTPUT_col22_name = LRDB_VAL_DATE;
%let _OUTPUT_col22_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col22_length = 13;
%let _OUTPUT_col22_type = $;
%let _OUTPUT_col22_format = $13.;
%let _OUTPUT_col22_informat = $13.;
%let _OUTPUT_col22_label = %nrquote(LRDB_VAL_DATE);
%let _OUTPUT_col22_exp = ;
%let _OUTPUT_col22_input_count = 0;
%let _OUTPUT_col23_name = AMT_TYPE;
%let _OUTPUT_col23_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col23_length = 16;
%let _OUTPUT_col23_type = $;
%let _OUTPUT_col23_format = $16.;
%let _OUTPUT_col23_informat = $16.;
%let _OUTPUT_col23_label = %nrquote(AMT_TYPE);
%let _OUTPUT_col23_exp = ;
%let _OUTPUT_col23_input_count = 0;
%let _OUTPUT_col24_name = GROSSRETRO;
%let _OUTPUT_col24_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col24_length = 5;
%let _OUTPUT_col24_type = $;
%let _OUTPUT_col24_format = $5.;
%let _OUTPUT_col24_informat = $5.;
%let _OUTPUT_col24_label = %nrquote(GROSSRETRO);
%let _OUTPUT_col24_exp = ;
%let _OUTPUT_col24_input_count = 0;
%let _OUTPUT_col25_name = PERIOD;
%let _OUTPUT_col25_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col25_length = 5;
%let _OUTPUT_col25_type = $;
%let _OUTPUT_col25_format = $5.;
%let _OUTPUT_col25_informat = $5.;
%let _OUTPUT_col25_label = %nrquote(PERIOD);
%let _OUTPUT_col25_exp = ;
%let _OUTPUT_col25_input_count = 0;
%let _OUTPUT_col26_name = EUR_AMOUNT;
%let _OUTPUT_col26_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col26_length = 8;
%let _OUTPUT_col26_type = ;
%let _OUTPUT_col26_format = ;
%let _OUTPUT_col26_informat = ;
%let _OUTPUT_col26_label = %nrquote(EUR_AMOUNT);
%let _OUTPUT_col26_exp = ;
%let _OUTPUT_col26_input_count = 0;
%let _OUTPUT_col27_name = AMOUNT;
%let _OUTPUT_col27_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col27_length = 8;
%let _OUTPUT_col27_type = ;
%let _OUTPUT_col27_format = ;
%let _OUTPUT_col27_informat = ;
%let _OUTPUT_col27_label = %nrquote(AMOUNT);
%let _OUTPUT_col27_exp = ;
%let _OUTPUT_col27_input_count = 0;
%let _OUTPUT_col28_name = PARTNER_ID_GROSS;
%let _OUTPUT_col28_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col28_length = 15;
%let _OUTPUT_col28_type = $;
%let _OUTPUT_col28_format = $15.;
%let _OUTPUT_col28_informat = $15.;
%let _OUTPUT_col28_label = %nrquote(PARTNER_ID_GROSS);
%let _OUTPUT_col28_exp = ;
%let _OUTPUT_col28_input_count = 0;
%let _OUTPUT_col29_name = VBUND_GROSS;
%let _OUTPUT_col29_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col29_length = 10;
%let _OUTPUT_col29_type = $;
%let _OUTPUT_col29_format = $10.;
%let _OUTPUT_col29_informat = $10.;
%let _OUTPUT_col29_label = %nrquote(VBUND_GROSS);
%let _OUTPUT_col29_exp = ;
%let _OUTPUT_col29_input_count = 0;
%let _OUTPUT_col30_name = SEGMENT;
%let _OUTPUT_col30_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col30_length = 20;
%let _OUTPUT_col30_type = $;
%let _OUTPUT_col30_format = $20.;
%let _OUTPUT_col30_informat = $20.;
%let _OUTPUT_col30_label = %nrquote(SEGMENT);
%let _OUTPUT_col30_exp = ;
%let _OUTPUT_col30_input_count = 0;
%let _OUTPUT_col31_name = LEGAL_ENTITY_CODE;
%let _OUTPUT_col31_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col31_length = 6;
%let _OUTPUT_col31_type = $;
%let _OUTPUT_col31_format = $6.;
%let _OUTPUT_col31_informat = $6.;
%let _OUTPUT_col31_label = %nrquote(LEGAL_ENTITY_CODE);
%let _OUTPUT_col31_exp = ;
%let _OUTPUT_col31_input_count = 0;
%let _OUTPUT_col32_name = REGION;
%let _OUTPUT_col32_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col32_length = 5;
%let _OUTPUT_col32_type = $;
%let _OUTPUT_col32_format = $5.;
%let _OUTPUT_col32_informat = $5.;
%let _OUTPUT_col32_label = %nrquote(REGION);
%let _OUTPUT_col32_exp = ;
%let _OUTPUT_col32_input_count = 0;
%let _OUTPUT_col33_name = COUNTRY_ID_TECHDB;
%let _OUTPUT_col33_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col33_length = 2;
%let _OUTPUT_col33_type = $;
%let _OUTPUT_col33_format = $2.;
%let _OUTPUT_col33_informat = $2.;
%let _OUTPUT_col33_label = %nrquote(COUNTRY_ID_TECHDB);
%let _OUTPUT_col33_exp = ;
%let _OUTPUT_col33_input_count = 0;
%let _OUTPUT_col34_name = ABACUS_SII_LOB;
%let _OUTPUT_col34_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col34_length = 50;
%let _OUTPUT_col34_type = $;
%let _OUTPUT_col34_format = $50.;
%let _OUTPUT_col34_informat = $50.;
%let _OUTPUT_col34_label = %nrquote(ABACUS_SII_LOB);
%let _OUTPUT_col34_exp = ;
%let _OUTPUT_col34_input_count = 0;
%let _OUTPUT_col35_name = CARVE_OUT_LOB;
%let _OUTPUT_col35_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col35_length = 50;
%let _OUTPUT_col35_type = $;
%let _OUTPUT_col35_format = $50.;
%let _OUTPUT_col35_informat = $50.;
%let _OUTPUT_col35_label = %nrquote(CARVE_OUT_LOB);
%let _OUTPUT_col35_exp = ;
%let _OUTPUT_col35_input_count = 0;
%let _OUTPUT_col36_name = GUIDE_6_LOB;
%let _OUTPUT_col36_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col36_length = 50;
%let _OUTPUT_col36_type = $;
%let _OUTPUT_col36_format = $50.;
%let _OUTPUT_col36_informat = $50.;
%let _OUTPUT_col36_label = %nrquote(GUIDE_6_LOB);
%let _OUTPUT_col36_exp = ;
%let _OUTPUT_col36_input_count = 0;
%let _OUTPUT_col37_name = SUPER_LOB;
%let _OUTPUT_col37_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col37_length = 50;
%let _OUTPUT_col37_type = $;
%let _OUTPUT_col37_format = $50.;
%let _OUTPUT_col37_informat = $50.;
%let _OUTPUT_col37_label = %nrquote(SUPER_LOB);
%let _OUTPUT_col37_exp = ;
%let _OUTPUT_col37_input_count = 0;
%let _OUTPUT_col38_name = SII_LOB_CODE;
%let _OUTPUT_col38_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col38_length = 50;
%let _OUTPUT_col38_type = $;
%let _OUTPUT_col38_format = $50.;
%let _OUTPUT_col38_informat = $50.;
%let _OUTPUT_col38_label = %nrquote(SII_LOB_CODE);
%let _OUTPUT_col38_exp = ;
%let _OUTPUT_col38_input_count = 0;
%let _OUTPUT_col39_name = SII_LOB_STRING;
%let _OUTPUT_col39_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col39_length = 200;
%let _OUTPUT_col39_type = $;
%let _OUTPUT_col39_format = $200.;
%let _OUTPUT_col39_informat = $200.;
%let _OUTPUT_col39_label = %nrquote(SII_LOB_STRING);
%let _OUTPUT_col39_exp = ;
%let _OUTPUT_col39_input_count = 0;
%let _OUTPUT_col40_name = SM_LOB;
%let _OUTPUT_col40_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col40_length = 50;
%let _OUTPUT_col40_type = $;
%let _OUTPUT_col40_format = $50.;
%let _OUTPUT_col40_informat = $50.;
%let _OUTPUT_col40_label = %nrquote(SM_LOB);
%let _OUTPUT_col40_exp = ;
%let _OUTPUT_col40_input_count = 0;
%let _OUTPUT_col41_name = PARTNER_ID_GROSS_DERIVED;
%let _OUTPUT_col41_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col41_length = 5;
%let _OUTPUT_col41_type = $;
%let _OUTPUT_col41_format = $5.;
%let _OUTPUT_col41_informat = $5.;
%let _OUTPUT_col41_label = %nrquote(PARTNER_ID_GROSS_DERIVED);
%let _OUTPUT_col41_exp = ;
%let _OUTPUT_col41_input_count = 0;
%let _OUTPUT_col42_name = PROP_NONPROP_RETRO;
%let _OUTPUT_col42_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col42_length = 18;
%let _OUTPUT_col42_type = $;
%let _OUTPUT_col42_format = $18.;
%let _OUTPUT_col42_informat = $18.;
%let _OUTPUT_col42_label = %nrquote(PROP_NONPROP_RETRO);
%let _OUTPUT_col42_exp = ;
%let _OUTPUT_col42_input_count = 0;
%let _OUTPUT_col43_name = VERSION_ID;
%let _OUTPUT_col43_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col43_length = 8;
%let _OUTPUT_col43_type = ;
%let _OUTPUT_col43_format = ;
%let _OUTPUT_col43_informat = ;
%let _OUTPUT_col43_label = %nrquote(VERSION_ID);
%let _OUTPUT_col43_exp = ;
%let _OUTPUT_col43_input_count = 0;
%let _OUTPUT_col44_name = LOAD_TIMESTAMP;
%let _OUTPUT_col44_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col44_length = 8;
%let _OUTPUT_col44_type = ;
%let _OUTPUT_col44_format = DATETIME20.;
%let _OUTPUT_col44_informat = DATETIME20.;
%let _OUTPUT_col44_label = %nrquote(LOAD_TIMESTAMP);
%let _OUTPUT_col44_exp = ;
%let _OUTPUT_col44_input_count = 0;
%let _OUTPUT_col45_name = QRT_RELEVANT;
%let _OUTPUT_col45_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col45_length = 1;
%let _OUTPUT_col45_type = $;
%let _OUTPUT_col45_format = $1.;
%let _OUTPUT_col45_informat = $1.;
%let _OUTPUT_col45_label = %nrquote(QRT_RELEVANT);
%let _OUTPUT_col45_exp = ;
%let _OUTPUT_col45_input_count = 0;
%let _OUTPUT_col46_name = CLAIM_TYPE;
%let _OUTPUT_col46_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col46_length = 1;
%let _OUTPUT_col46_type = $;
%let _OUTPUT_col46_format = $1.;
%let _OUTPUT_col46_informat = $1.;
%let _OUTPUT_col46_label = %nrquote(CLAIM_TYPE);
%let _OUTPUT_col46_exp = ;
%let _OUTPUT_col46_input_count = 0;
%let _OUTPUT_col47_name = DISCOUNT_RATE_FLAG;
%let _OUTPUT_col47_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col47_length = 1;
%let _OUTPUT_col47_type = $;
%let _OUTPUT_col47_format = $1.;
%let _OUTPUT_col47_informat = $1.;
%let _OUTPUT_col47_label = %nrquote(DISCOUNT_RATE_FLAG);
%let _OUTPUT_col47_exp = ;
%let _OUTPUT_col47_input_count = 0;
%let _OUTPUT_col48_name = INSTRUMENT;
%let _OUTPUT_col48_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col48_length = 6;
%let _OUTPUT_col48_type = $;
%let _OUTPUT_col48_format = $6.;
%let _OUTPUT_col48_informat = $6.;
%let _OUTPUT_col48_label = %nrquote(INSTRUMENT);
%let _OUTPUT_col48_exp = ;
%let _OUTPUT_col48_input_count = 0;
%let _OUTPUT_filetype = PhysicalTable;

%let _OUTPUT1 = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_connect =  DBMAX_TEXT=32767 PATH="&ORA_RESASDWH_PATH" user="&ORA_RESASDWH_USER" pw="&ORA_RESASDWH_PWD"
;
%let _OUTPUT1_engine = ORACLE;
%let _OUTPUT1_memtype = DATA;
%let _OUTPUT1_options = %nrquote();
%let _OUTPUT1_alter = %nrquote();
%let _OUTPUT1_path = %nrquote(/ETL/tdbpcd/Tables/Target/MVBS/MVBS_OUTPUT%(Table%));
%let _OUTPUT1_type = 1;
%let _OUTPUT1_label = %nrquote();
/* List of target columns to keep  */ 
%let _OUTPUT1_keep = LINE_NUMBER FILENAME DISCUNDISC LEGAL_ENTITY_NAME MANDANT_ID 
        PROP_NONPROP CEDENT_DOM_ID INTEXT CONVENTIONAL_SCOB_IN_SICS 
        RES_SEG_LEVEL1 RES_SEG_LEVEL2 RES_SEG_LEVEL3 RES_SEG_LEVEL4 
        RES_SEG_LEVEL5 CURR_TO_USE INWARD_BUS_ID OUTWARD_BUS_ID 
        PARTNER_ID_RETRO VBUND_RETRO INTEXT_RETRO REL_YR_ID REL_YR_VAL 
        LRDB_VAL_DATE AMT_TYPE GROSSRETRO PERIOD EUR_AMOUNT AMOUNT 
        PARTNER_ID_GROSS VBUND_GROSS SEGMENT LEGAL_ENTITY_CODE REGION 
        COUNTRY_ID_TECHDB ABACUS_SII_LOB CARVE_OUT_LOB GUIDE_6_LOB SUPER_LOB 
        SII_LOB_CODE SII_LOB_STRING SM_LOB PARTNER_ID_GROSS_DERIVED 
        PROP_NONPROP_RETRO VERSION_ID LOAD_TIMESTAMP QRT_RELEVANT CLAIM_TYPE 
        DISCOUNT_RATE_FLAG INSTRUMENT;
%let _OUTPUT1_col_count = 49;
%let _OUTPUT1_col0_name = LINE_NUMBER;
%let _OUTPUT1_col0_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col0_length = 8;
%let _OUTPUT1_col0_type = ;
%let _OUTPUT1_col0_format = ;
%let _OUTPUT1_col0_informat = ;
%let _OUTPUT1_col0_label = %nrquote(LINE_NUMBER);
%let _OUTPUT1_col0_exp = ;
%let _OUTPUT1_col0_input_count = 0;
%let _OUTPUT1_col1_name = FILENAME;
%let _OUTPUT1_col1_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col1_length = 100;
%let _OUTPUT1_col1_type = $;
%let _OUTPUT1_col1_format = $100.;
%let _OUTPUT1_col1_informat = $100.;
%let _OUTPUT1_col1_label = %nrquote(FILENAME);
%let _OUTPUT1_col1_exp = ;
%let _OUTPUT1_col1_input_count = 0;
%let _OUTPUT1_col2_name = DISCUNDISC;
%let _OUTPUT1_col2_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col2_length = 12;
%let _OUTPUT1_col2_type = $;
%let _OUTPUT1_col2_format = $12.;
%let _OUTPUT1_col2_informat = $12.;
%let _OUTPUT1_col2_label = %nrquote(DISCUNDISC);
%let _OUTPUT1_col2_exp = ;
%let _OUTPUT1_col2_input_count = 0;
%let _OUTPUT1_col3_name = LEGAL_ENTITY_NAME;
%let _OUTPUT1_col3_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col3_length = 50;
%let _OUTPUT1_col3_type = $;
%let _OUTPUT1_col3_format = $50.;
%let _OUTPUT1_col3_informat = $50.;
%let _OUTPUT1_col3_label = %nrquote(LEGAL_ENTITY_NAME);
%let _OUTPUT1_col3_exp = ;
%let _OUTPUT1_col3_input_count = 0;
%let _OUTPUT1_col4_name = MANDANT_ID;
%let _OUTPUT1_col4_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col4_length = 5;
%let _OUTPUT1_col4_type = $;
%let _OUTPUT1_col4_format = $5.;
%let _OUTPUT1_col4_informat = $5.;
%let _OUTPUT1_col4_label = %nrquote(MANDANT_ID);
%let _OUTPUT1_col4_exp = ;
%let _OUTPUT1_col4_input_count = 0;
%let _OUTPUT1_col5_name = PROP_NONPROP;
%let _OUTPUT1_col5_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col5_length = 15;
%let _OUTPUT1_col5_type = $;
%let _OUTPUT1_col5_format = $15.;
%let _OUTPUT1_col5_informat = $15.;
%let _OUTPUT1_col5_label = %nrquote(PROP_NONPROP);
%let _OUTPUT1_col5_exp = ;
%let _OUTPUT1_col5_input_count = 0;
%let _OUTPUT1_col6_name = CEDENT_DOM_ID;
%let _OUTPUT1_col6_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col6_length = 23;
%let _OUTPUT1_col6_type = $;
%let _OUTPUT1_col6_format = $23.;
%let _OUTPUT1_col6_informat = $23.;
%let _OUTPUT1_col6_label = %nrquote(CEDENT_DOM_ID);
%let _OUTPUT1_col6_exp = ;
%let _OUTPUT1_col6_input_count = 0;
%let _OUTPUT1_col7_name = INTEXT;
%let _OUTPUT1_col7_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col7_length = 8;
%let _OUTPUT1_col7_type = $;
%let _OUTPUT1_col7_format = $8.;
%let _OUTPUT1_col7_informat = $8.;
%let _OUTPUT1_col7_label = %nrquote(INTEXT);
%let _OUTPUT1_col7_exp = ;
%let _OUTPUT1_col7_input_count = 0;
%let _OUTPUT1_col8_name = CONVENTIONAL_SCOB_IN_SICS;
%let _OUTPUT1_col8_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col8_length = 25;
%let _OUTPUT1_col8_type = $;
%let _OUTPUT1_col8_format = $25.;
%let _OUTPUT1_col8_informat = $25.;
%let _OUTPUT1_col8_label = %nrquote(CONVENTIONAL_SCOB_IN_SICS);
%let _OUTPUT1_col8_exp = ;
%let _OUTPUT1_col8_input_count = 0;
%let _OUTPUT1_col9_name = RES_SEG_LEVEL1;
%let _OUTPUT1_col9_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col9_length = 30;
%let _OUTPUT1_col9_type = $;
%let _OUTPUT1_col9_format = $30.;
%let _OUTPUT1_col9_informat = $30.;
%let _OUTPUT1_col9_label = %nrquote(RES_SEG_LEVEL1);
%let _OUTPUT1_col9_exp = ;
%let _OUTPUT1_col9_input_count = 0;
%let _OUTPUT1_col10_name = RES_SEG_LEVEL2;
%let _OUTPUT1_col10_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col10_length = 30;
%let _OUTPUT1_col10_type = $;
%let _OUTPUT1_col10_format = $30.;
%let _OUTPUT1_col10_informat = $30.;
%let _OUTPUT1_col10_label = %nrquote(RES_SEG_LEVEL2);
%let _OUTPUT1_col10_exp = ;
%let _OUTPUT1_col10_input_count = 0;
%let _OUTPUT1_col11_name = RES_SEG_LEVEL3;
%let _OUTPUT1_col11_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col11_length = 30;
%let _OUTPUT1_col11_type = $;
%let _OUTPUT1_col11_format = $30.;
%let _OUTPUT1_col11_informat = $30.;
%let _OUTPUT1_col11_label = %nrquote(RES_SEG_LEVEL3);
%let _OUTPUT1_col11_exp = ;
%let _OUTPUT1_col11_input_count = 0;
%let _OUTPUT1_col12_name = RES_SEG_LEVEL4;
%let _OUTPUT1_col12_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col12_length = 30;
%let _OUTPUT1_col12_type = $;
%let _OUTPUT1_col12_format = $30.;
%let _OUTPUT1_col12_informat = $30.;
%let _OUTPUT1_col12_label = %nrquote(RES_SEG_LEVEL4);
%let _OUTPUT1_col12_exp = ;
%let _OUTPUT1_col12_input_count = 0;
%let _OUTPUT1_col13_name = RES_SEG_LEVEL5;
%let _OUTPUT1_col13_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col13_length = 30;
%let _OUTPUT1_col13_type = $;
%let _OUTPUT1_col13_format = $30.;
%let _OUTPUT1_col13_informat = $30.;
%let _OUTPUT1_col13_label = %nrquote(RES_SEG_LEVEL5);
%let _OUTPUT1_col13_exp = ;
%let _OUTPUT1_col13_input_count = 0;
%let _OUTPUT1_col14_name = CURR_TO_USE;
%let _OUTPUT1_col14_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col14_length = 11;
%let _OUTPUT1_col14_type = $;
%let _OUTPUT1_col14_format = $11.;
%let _OUTPUT1_col14_informat = $11.;
%let _OUTPUT1_col14_label = %nrquote(CURR_TO_USE);
%let _OUTPUT1_col14_exp = ;
%let _OUTPUT1_col14_input_count = 0;
%let _OUTPUT1_col15_name = INWARD_BUS_ID;
%let _OUTPUT1_col15_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col15_length = 36;
%let _OUTPUT1_col15_type = $;
%let _OUTPUT1_col15_format = $36.;
%let _OUTPUT1_col15_informat = $36.;
%let _OUTPUT1_col15_label = %nrquote(INWARD_BUS_ID);
%let _OUTPUT1_col15_exp = ;
%let _OUTPUT1_col15_input_count = 0;
%let _OUTPUT1_col16_name = OUTWARD_BUS_ID;
%let _OUTPUT1_col16_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col16_length = 36;
%let _OUTPUT1_col16_type = $;
%let _OUTPUT1_col16_format = $36.;
%let _OUTPUT1_col16_informat = $36.;
%let _OUTPUT1_col16_label = %nrquote(OUTWARD_BUS_ID);
%let _OUTPUT1_col16_exp = ;
%let _OUTPUT1_col16_input_count = 0;
%let _OUTPUT1_col17_name = PARTNER_ID_RETRO;
%let _OUTPUT1_col17_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col17_length = 20;
%let _OUTPUT1_col17_type = $;
%let _OUTPUT1_col17_format = $20.;
%let _OUTPUT1_col17_informat = $20.;
%let _OUTPUT1_col17_label = %nrquote(PARTNER_ID_RETRO);
%let _OUTPUT1_col17_exp = ;
%let _OUTPUT1_col17_input_count = 0;
%let _OUTPUT1_col18_name = VBUND_RETRO;
%let _OUTPUT1_col18_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col18_length = 15;
%let _OUTPUT1_col18_type = $;
%let _OUTPUT1_col18_format = $15.;
%let _OUTPUT1_col18_informat = $15.;
%let _OUTPUT1_col18_label = %nrquote(VBUND_RETRO);
%let _OUTPUT1_col18_exp = ;
%let _OUTPUT1_col18_input_count = 0;
%let _OUTPUT1_col19_name = INTEXT_RETRO;
%let _OUTPUT1_col19_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col19_length = 12;
%let _OUTPUT1_col19_type = $;
%let _OUTPUT1_col19_format = $12.;
%let _OUTPUT1_col19_informat = $12.;
%let _OUTPUT1_col19_label = %nrquote(INTEXT_RETRO);
%let _OUTPUT1_col19_exp = ;
%let _OUTPUT1_col19_input_count = 0;
%let _OUTPUT1_col20_name = REL_YR_ID;
%let _OUTPUT1_col20_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col20_length = 9;
%let _OUTPUT1_col20_type = $;
%let _OUTPUT1_col20_format = $9.;
%let _OUTPUT1_col20_informat = $9.;
%let _OUTPUT1_col20_label = %nrquote(REL_YR_ID);
%let _OUTPUT1_col20_exp = ;
%let _OUTPUT1_col20_input_count = 0;
%let _OUTPUT1_col21_name = REL_YR_VAL;
%let _OUTPUT1_col21_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col21_length = 8;
%let _OUTPUT1_col21_type = $;
%let _OUTPUT1_col21_format = $8.;
%let _OUTPUT1_col21_informat = $8.;
%let _OUTPUT1_col21_label = %nrquote(REL_YR_VAL);
%let _OUTPUT1_col21_exp = ;
%let _OUTPUT1_col21_input_count = 0;
%let _OUTPUT1_col22_name = LRDB_VAL_DATE;
%let _OUTPUT1_col22_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col22_length = 13;
%let _OUTPUT1_col22_type = $;
%let _OUTPUT1_col22_format = $13.;
%let _OUTPUT1_col22_informat = $13.;
%let _OUTPUT1_col22_label = %nrquote(LRDB_VAL_DATE);
%let _OUTPUT1_col22_exp = ;
%let _OUTPUT1_col22_input_count = 0;
%let _OUTPUT1_col23_name = AMT_TYPE;
%let _OUTPUT1_col23_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col23_length = 16;
%let _OUTPUT1_col23_type = $;
%let _OUTPUT1_col23_format = $16.;
%let _OUTPUT1_col23_informat = $16.;
%let _OUTPUT1_col23_label = %nrquote(AMT_TYPE);
%let _OUTPUT1_col23_exp = ;
%let _OUTPUT1_col23_input_count = 0;
%let _OUTPUT1_col24_name = GROSSRETRO;
%let _OUTPUT1_col24_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col24_length = 5;
%let _OUTPUT1_col24_type = $;
%let _OUTPUT1_col24_format = $5.;
%let _OUTPUT1_col24_informat = $5.;
%let _OUTPUT1_col24_label = %nrquote(GROSSRETRO);
%let _OUTPUT1_col24_exp = ;
%let _OUTPUT1_col24_input_count = 0;
%let _OUTPUT1_col25_name = PERIOD;
%let _OUTPUT1_col25_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col25_length = 5;
%let _OUTPUT1_col25_type = $;
%let _OUTPUT1_col25_format = $5.;
%let _OUTPUT1_col25_informat = $5.;
%let _OUTPUT1_col25_label = %nrquote(PERIOD);
%let _OUTPUT1_col25_exp = ;
%let _OUTPUT1_col25_input_count = 0;
%let _OUTPUT1_col26_name = EUR_AMOUNT;
%let _OUTPUT1_col26_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col26_length = 8;
%let _OUTPUT1_col26_type = ;
%let _OUTPUT1_col26_format = ;
%let _OUTPUT1_col26_informat = ;
%let _OUTPUT1_col26_label = %nrquote(EUR_AMOUNT);
%let _OUTPUT1_col26_exp = ;
%let _OUTPUT1_col26_input_count = 0;
%let _OUTPUT1_col27_name = AMOUNT;
%let _OUTPUT1_col27_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col27_length = 8;
%let _OUTPUT1_col27_type = ;
%let _OUTPUT1_col27_format = ;
%let _OUTPUT1_col27_informat = ;
%let _OUTPUT1_col27_label = %nrquote(AMOUNT);
%let _OUTPUT1_col27_exp = ;
%let _OUTPUT1_col27_input_count = 0;
%let _OUTPUT1_col28_name = PARTNER_ID_GROSS;
%let _OUTPUT1_col28_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col28_length = 15;
%let _OUTPUT1_col28_type = $;
%let _OUTPUT1_col28_format = $15.;
%let _OUTPUT1_col28_informat = $15.;
%let _OUTPUT1_col28_label = %nrquote(PARTNER_ID_GROSS);
%let _OUTPUT1_col28_exp = ;
%let _OUTPUT1_col28_input_count = 0;
%let _OUTPUT1_col29_name = VBUND_GROSS;
%let _OUTPUT1_col29_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col29_length = 10;
%let _OUTPUT1_col29_type = $;
%let _OUTPUT1_col29_format = $10.;
%let _OUTPUT1_col29_informat = $10.;
%let _OUTPUT1_col29_label = %nrquote(VBUND_GROSS);
%let _OUTPUT1_col29_exp = ;
%let _OUTPUT1_col29_input_count = 0;
%let _OUTPUT1_col30_name = SEGMENT;
%let _OUTPUT1_col30_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col30_length = 20;
%let _OUTPUT1_col30_type = $;
%let _OUTPUT1_col30_format = $20.;
%let _OUTPUT1_col30_informat = $20.;
%let _OUTPUT1_col30_label = %nrquote(SEGMENT);
%let _OUTPUT1_col30_exp = ;
%let _OUTPUT1_col30_input_count = 0;
%let _OUTPUT1_col31_name = LEGAL_ENTITY_CODE;
%let _OUTPUT1_col31_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col31_length = 6;
%let _OUTPUT1_col31_type = $;
%let _OUTPUT1_col31_format = $6.;
%let _OUTPUT1_col31_informat = $6.;
%let _OUTPUT1_col31_label = %nrquote(LEGAL_ENTITY_CODE);
%let _OUTPUT1_col31_exp = ;
%let _OUTPUT1_col31_input_count = 0;
%let _OUTPUT1_col32_name = REGION;
%let _OUTPUT1_col32_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col32_length = 5;
%let _OUTPUT1_col32_type = $;
%let _OUTPUT1_col32_format = $5.;
%let _OUTPUT1_col32_informat = $5.;
%let _OUTPUT1_col32_label = %nrquote(REGION);
%let _OUTPUT1_col32_exp = ;
%let _OUTPUT1_col32_input_count = 0;
%let _OUTPUT1_col33_name = COUNTRY_ID_TECHDB;
%let _OUTPUT1_col33_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col33_length = 2;
%let _OUTPUT1_col33_type = $;
%let _OUTPUT1_col33_format = $2.;
%let _OUTPUT1_col33_informat = $2.;
%let _OUTPUT1_col33_label = %nrquote(COUNTRY_ID_TECHDB);
%let _OUTPUT1_col33_exp = ;
%let _OUTPUT1_col33_input_count = 0;
%let _OUTPUT1_col34_name = ABACUS_SII_LOB;
%let _OUTPUT1_col34_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col34_length = 50;
%let _OUTPUT1_col34_type = $;
%let _OUTPUT1_col34_format = $50.;
%let _OUTPUT1_col34_informat = $50.;
%let _OUTPUT1_col34_label = %nrquote(ABACUS_SII_LOB);
%let _OUTPUT1_col34_exp = ;
%let _OUTPUT1_col34_input_count = 0;
%let _OUTPUT1_col35_name = CARVE_OUT_LOB;
%let _OUTPUT1_col35_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col35_length = 50;
%let _OUTPUT1_col35_type = $;
%let _OUTPUT1_col35_format = $50.;
%let _OUTPUT1_col35_informat = $50.;
%let _OUTPUT1_col35_label = %nrquote(CARVE_OUT_LOB);
%let _OUTPUT1_col35_exp = ;
%let _OUTPUT1_col35_input_count = 0;
%let _OUTPUT1_col36_name = GUIDE_6_LOB;
%let _OUTPUT1_col36_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col36_length = 50;
%let _OUTPUT1_col36_type = $;
%let _OUTPUT1_col36_format = $50.;
%let _OUTPUT1_col36_informat = $50.;
%let _OUTPUT1_col36_label = %nrquote(GUIDE_6_LOB);
%let _OUTPUT1_col36_exp = ;
%let _OUTPUT1_col36_input_count = 0;
%let _OUTPUT1_col37_name = SUPER_LOB;
%let _OUTPUT1_col37_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col37_length = 50;
%let _OUTPUT1_col37_type = $;
%let _OUTPUT1_col37_format = $50.;
%let _OUTPUT1_col37_informat = $50.;
%let _OUTPUT1_col37_label = %nrquote(SUPER_LOB);
%let _OUTPUT1_col37_exp = ;
%let _OUTPUT1_col37_input_count = 0;
%let _OUTPUT1_col38_name = SII_LOB_CODE;
%let _OUTPUT1_col38_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col38_length = 50;
%let _OUTPUT1_col38_type = $;
%let _OUTPUT1_col38_format = $50.;
%let _OUTPUT1_col38_informat = $50.;
%let _OUTPUT1_col38_label = %nrquote(SII_LOB_CODE);
%let _OUTPUT1_col38_exp = ;
%let _OUTPUT1_col38_input_count = 0;
%let _OUTPUT1_col39_name = SII_LOB_STRING;
%let _OUTPUT1_col39_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col39_length = 200;
%let _OUTPUT1_col39_type = $;
%let _OUTPUT1_col39_format = $200.;
%let _OUTPUT1_col39_informat = $200.;
%let _OUTPUT1_col39_label = %nrquote(SII_LOB_STRING);
%let _OUTPUT1_col39_exp = ;
%let _OUTPUT1_col39_input_count = 0;
%let _OUTPUT1_col40_name = SM_LOB;
%let _OUTPUT1_col40_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col40_length = 50;
%let _OUTPUT1_col40_type = $;
%let _OUTPUT1_col40_format = $50.;
%let _OUTPUT1_col40_informat = $50.;
%let _OUTPUT1_col40_label = %nrquote(SM_LOB);
%let _OUTPUT1_col40_exp = ;
%let _OUTPUT1_col40_input_count = 0;
%let _OUTPUT1_col41_name = PARTNER_ID_GROSS_DERIVED;
%let _OUTPUT1_col41_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col41_length = 5;
%let _OUTPUT1_col41_type = $;
%let _OUTPUT1_col41_format = $5.;
%let _OUTPUT1_col41_informat = $5.;
%let _OUTPUT1_col41_label = %nrquote(PARTNER_ID_GROSS_DERIVED);
%let _OUTPUT1_col41_exp = ;
%let _OUTPUT1_col41_input_count = 0;
%let _OUTPUT1_col42_name = PROP_NONPROP_RETRO;
%let _OUTPUT1_col42_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col42_length = 18;
%let _OUTPUT1_col42_type = $;
%let _OUTPUT1_col42_format = $18.;
%let _OUTPUT1_col42_informat = $18.;
%let _OUTPUT1_col42_label = %nrquote(PROP_NONPROP_RETRO);
%let _OUTPUT1_col42_exp = ;
%let _OUTPUT1_col42_input_count = 0;
%let _OUTPUT1_col43_name = VERSION_ID;
%let _OUTPUT1_col43_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col43_length = 8;
%let _OUTPUT1_col43_type = ;
%let _OUTPUT1_col43_format = ;
%let _OUTPUT1_col43_informat = ;
%let _OUTPUT1_col43_label = %nrquote(VERSION_ID);
%let _OUTPUT1_col43_exp = ;
%let _OUTPUT1_col43_input_count = 0;
%let _OUTPUT1_col44_name = LOAD_TIMESTAMP;
%let _OUTPUT1_col44_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col44_length = 8;
%let _OUTPUT1_col44_type = ;
%let _OUTPUT1_col44_format = DATETIME20.;
%let _OUTPUT1_col44_informat = DATETIME20.;
%let _OUTPUT1_col44_label = %nrquote(LOAD_TIMESTAMP);
%let _OUTPUT1_col44_exp = ;
%let _OUTPUT1_col44_input_count = 0;
%let _OUTPUT1_col45_name = QRT_RELEVANT;
%let _OUTPUT1_col45_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col45_length = 1;
%let _OUTPUT1_col45_type = $;
%let _OUTPUT1_col45_format = $1.;
%let _OUTPUT1_col45_informat = $1.;
%let _OUTPUT1_col45_label = %nrquote(QRT_RELEVANT);
%let _OUTPUT1_col45_exp = ;
%let _OUTPUT1_col45_input_count = 0;
%let _OUTPUT1_col46_name = CLAIM_TYPE;
%let _OUTPUT1_col46_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col46_length = 1;
%let _OUTPUT1_col46_type = $;
%let _OUTPUT1_col46_format = $1.;
%let _OUTPUT1_col46_informat = $1.;
%let _OUTPUT1_col46_label = %nrquote(CLAIM_TYPE);
%let _OUTPUT1_col46_exp = ;
%let _OUTPUT1_col46_input_count = 0;
%let _OUTPUT1_col47_name = DISCOUNT_RATE_FLAG;
%let _OUTPUT1_col47_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col47_length = 1;
%let _OUTPUT1_col47_type = $;
%let _OUTPUT1_col47_format = $1.;
%let _OUTPUT1_col47_informat = $1.;
%let _OUTPUT1_col47_label = %nrquote(DISCOUNT_RATE_FLAG);
%let _OUTPUT1_col47_exp = ;
%let _OUTPUT1_col47_input_count = 0;
%let _OUTPUT1_col48_name = INSTRUMENT;
%let _OUTPUT1_col48_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col48_length = 6;
%let _OUTPUT1_col48_type = $;
%let _OUTPUT1_col48_format = $6.;
%let _OUTPUT1_col48_informat = $6.;
%let _OUTPUT1_col48_label = %nrquote(INSTRUMENT);
%let _OUTPUT1_col48_exp = ;
%let _OUTPUT1_col48_input_count = 0;
%let _OUTPUT1_filetype = PhysicalTable;

/*---- Start of User Written Code  ----*/ 


proc sql noprint;
select distinct version_id into : versions separated by ','  from resasdwh.MVBS_LOG 
		where reporting_period="&reporting_period1";
quit;

%let versions = &versions.;

proc sql;
connect to ORACLE
( 
    DBMAX_TEXT=4096 PATH="&ORA_RESASDWH_PATH." user="&ORA_RESASDWH_USER." pw="&ORA_RESASDWH_PWD." preserve_comments
); 
	execute by ORACLE
	( 
				delete from &ORA_RESASDWH_SCHEMA..MVBS_OUTPUT where version_id in (&versions.)
	);
	execute by ORACLE
	( 
	   		alter table &ORA_RESASDWH_SCHEMA..MVBS_OUTPUT_ARCHIVE move compress
	);
	execute by ORACLE
	( 
	   		alter table &ORA_RESASDWH_SCHEMA..MVBS_OUTPUT move compress
	);
disconnect from ORACLE; 
quit;




/*---- End of User Written Code  ----*/ 

%rcSet(&syserr); 
%rcSet(&sqlrc); 


/**  Step end Execute **/

%let etls_endTime = %sysfunc(datetime(),datetime.);



/**  Job end MVBS_OUTPUT_ARCHIVE **/

/* Reset jobid and name */
%let jobID = %quote(A5V8BXSQ.AR0001AW);
%let etls_jobName = %nrquote(MVBS_ARCHIVE_ORA_SAS_LOOP);

%exitetls_conditionWDDRWGBV:
%mend etls_conditionWDDRWGBV;

%etls_conditionWDDRWGBV;


/**  Step end Conditional Start **/

/*==========================================================================* 
 * Step:            Conditional Start                     A5V8BXSQ.AW0004VP * 
 * Transform:       Conditional Start                                       * 
 * Description:                                                             * 
 *==========================================================================*/ 

%let transformID = %quote(A5V8BXSQ.AW0004VP);
%let trans_rc = 0;
%let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 

%let ETLS_SYSLAST = &SYSLAST;
/*---- Start of Pre-Process Code  ----*/ 

%let reporting_period1=%sysfunc(putn(%sysfunc(intnx(quarter, %sysfunc(inputn(&reporting_period., yyq6)), -5, end)), yyq6));
%put &reporting_period1;
/*---- End of Pre-Process Code  ----*/ 

%rcSet(&syserr); 
%rcSet(&sqlrc); 

%let SYSLAST = &ETLS_SYSLAST;

%macro etls_conditionWDDRWHBJ;
   %local etls_conditionTrue;
   %let etls_conditionTrue = %eval(%sysfunc(substr(&reporting_period,6,1))  = 1);
   %if (&etls_conditionTrue=0) %then
   %do;
      %put ETLS_DIAG: Condition flow did NOT execute, condition was %sysfunc(substr(&reporting_period,6,1))  = 1;
      %goto exitetls_conditionWDDRWHBJ;
   %end;
   %else
   %do;
      %put ETLS_DIAG: Condition flow did execute, condition was %sysfunc(substr(&reporting_period,6,1))  = 1;
   %end;
/**************************************************************************** 
 * Job:             MVBS_OUTPUT_ARCHIVE                   A5V8BXSQ.AR0001PH * 
 * Description:                                                             * 
 *                                                                          * 
 * Metadata Server: bire-sas94-meta-dev.srv.allianz                         * 
 * Port:            8561                                                    * 
 * Location:        /ETL/tdbpcd/Jobs/MVBS/MVBS_ARCHIVE                      * 
 *                                                                          * 
 * Server:          tdbpcd                                A5HYR2NS.AS00001O * 
 *                                                                          * 
 * Source Tables:   MVBS_OUTPUT - RESASDWH.MVBS_OUTPUT    A5V8BXSQ.AE0001W7 * 
 *                  MVBS_LOG - RESASDWH.MVBS_LOG          A5V8BXSQ.AE0001W3 * 
 * Target Tables:   MVBS_OUTPUT_ARCHIVE -                 A5V8BXSQ.AE0002CR * 
 *                   RESASDWH.MVBS_OUTPUT_ARCHIVE                           * 
 *                  MVBS_OUTPUT - RESASDWH.MVBS_OUTPUT    A5V8BXSQ.AE0001W7 * 
 *                                                                          * 
 * Generated on:    Friday, June 9, 2017 6:44:03 PM IST                     * 
 * Generated by:    re00580                                                 * 
 * Version:         SAS Data Integration Studio 4.901                       * 
 ****************************************************************************/ 

/* Generate the process id for job  */ 
%put Process ID: &SYSJOBID;

/* General macro variables  */ 
%let jobID = %quote(A5V8BXSQ.AR0001PH);
%let etls_jobName = %nrquote(MVBS_OUTPUT_ARCHIVE);
%let etls_userID = %nrquote(re00580);


/* Create metadata macro variables */
%let IOMServer      = %nrquote(tdbpcd);
%let metaPort       = %nrquote(8561);
%let metaServer     = %nrquote(ibire-sas94-meta-dev.srv.allianz);

/* Setup for capturing job status  */ 
%let etls_startTime = %sysfunc(datetime(),datetime.);
%let etls_recordsBefore = 0;
%let etls_recordsAfter = 0;
%let etls_lib = 0;
%let etls_table = 0;

%global etls_debug; 
%macro etls_setDebug; 
   %if %str(&etls_debug) ne 0 %then 
      OPTIONS MPRINT%str(;); 
%mend; 
%etls_setDebug; 

/*==========================================================================* 
 * Step:            Create Table                          A5V8BXSQ.AW0004VE * 
 * Transform:       Create Table                                            * 
 * Description:                                                             * 
 *                                                                          * 
 * Source Tables:   MVBS_OUTPUT - RESASDWH.MVBS_OUTPUT    A5V8BXSQ.AE0001W7 * 
 *                  MVBS_LOG - RESASDWH.MVBS_LOG          A5V8BXSQ.AE0001W3 * 
 * Target Table:    Create Table - work.WCOBHOG1          A5V8BXSQ.AQ000260 * 
 *==========================================================================*/ 

%let transformID = %quote(A5V8BXSQ.AW0004VE);
%let trans_rc = 0;
%let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 

%global etls_sql_pushDown;
%let etls_sql_pushDown = -1;
option DBIDIRECTEXEC;

proc datasets lib = work nolist nowarn memtype = (data view);
   delete WCOBHOG1;
quit;

proc sql
;
create view work.WCOBHOG1 as
select
   MVBS_OUTPUT.LINE_NUMBER length = 8   
      label = 'LINE_NUMBER',
   MVBS_OUTPUT.FILENAME length = 100   
      format = $100.
      informat = $100.
      label = 'FILENAME',
   MVBS_OUTPUT.DISCUNDISC length = 12   
      format = $12.
      informat = $12.
      label = 'DISCUNDISC',
   MVBS_OUTPUT.LEGAL_ENTITY_NAME length = 50   
      format = $50.
      informat = $50.
      label = 'LEGAL_ENTITY_NAME',
   MVBS_OUTPUT.MANDANT_ID length = 5   
      format = $5.
      informat = $5.
      label = 'MANDANT_ID',
   MVBS_OUTPUT.PROP_NONPROP length = 15   
      format = $15.
      informat = $15.
      label = 'PROP_NONPROP',
   MVBS_OUTPUT.CEDENT_DOM_ID length = 23   
      format = $23.
      informat = $23.
      label = 'CEDENT_DOM_ID',
   MVBS_OUTPUT.INTEXT length = 8   
      format = $8.
      informat = $8.
      label = 'INTEXT',
   MVBS_OUTPUT.CONVENTIONAL_SCOB_IN_SICS length = 25   
      format = $25.
      informat = $25.
      label = 'CONVENTIONAL_SCOB_IN_SICS',
   MVBS_OUTPUT.RES_SEG_LEVEL1 length = 30   
      format = $30.
      informat = $30.
      label = 'RES_SEG_LEVEL1',
   MVBS_OUTPUT.RES_SEG_LEVEL2 length = 30   
      format = $30.
      informat = $30.
      label = 'RES_SEG_LEVEL2',
   MVBS_OUTPUT.RES_SEG_LEVEL3 length = 30   
      format = $30.
      informat = $30.
      label = 'RES_SEG_LEVEL3',
   MVBS_OUTPUT.RES_SEG_LEVEL4 length = 30   
      format = $30.
      informat = $30.
      label = 'RES_SEG_LEVEL4',
   MVBS_OUTPUT.RES_SEG_LEVEL5 length = 30   
      format = $30.
      informat = $30.
      label = 'RES_SEG_LEVEL5',
   MVBS_OUTPUT.CURR_TO_USE length = 11   
      format = $11.
      informat = $11.
      label = 'CURR_TO_USE',
   MVBS_OUTPUT.INWARD_BUS_ID length = 36   
      format = $36.
      informat = $36.
      label = 'INWARD_BUS_ID',
   MVBS_OUTPUT.OUTWARD_BUS_ID length = 36   
      format = $36.
      informat = $36.
      label = 'OUTWARD_BUS_ID',
   MVBS_OUTPUT.PARTNER_ID_RETRO length = 20   
      format = $20.
      informat = $20.
      label = 'PARTNER_ID_RETRO',
   MVBS_OUTPUT.VBUND_RETRO length = 15   
      format = $15.
      informat = $15.
      label = 'VBUND_RETRO',
   MVBS_OUTPUT.INTEXT_RETRO length = 12   
      format = $12.
      informat = $12.
      label = 'INTEXT_RETRO',
   MVBS_OUTPUT.REL_YR_ID length = 9   
      format = $9.
      informat = $9.
      label = 'REL_YR_ID',
   MVBS_OUTPUT.REL_YR_VAL length = 8   
      format = $8.
      informat = $8.
      label = 'REL_YR_VAL',
   MVBS_OUTPUT.LRDB_VAL_DATE length = 13   
      format = $13.
      informat = $13.
      label = 'LRDB_VAL_DATE',
   MVBS_OUTPUT.AMT_TYPE length = 16   
      format = $16.
      informat = $16.
      label = 'AMT_TYPE',
   MVBS_OUTPUT.GROSSRETRO length = 5   
      format = $5.
      informat = $5.
      label = 'GROSSRETRO',
   MVBS_OUTPUT.PERIOD length = 5   
      format = $5.
      informat = $5.
      label = 'PERIOD',
   MVBS_OUTPUT.EUR_AMOUNT length = 8   
      label = 'EUR_AMOUNT',
   MVBS_OUTPUT.AMOUNT length = 8   
      label = 'AMOUNT',
   MVBS_OUTPUT.PARTNER_ID_GROSS length = 15   
      format = $15.
      informat = $15.
      label = 'PARTNER_ID_GROSS',
   MVBS_OUTPUT.VBUND_GROSS length = 10   
      format = $10.
      informat = $10.
      label = 'VBUND_GROSS',
   MVBS_OUTPUT.SEGMENT length = 20   
      format = $20.
      informat = $20.
      label = 'SEGMENT',
   MVBS_OUTPUT.LEGAL_ENTITY_CODE length = 6   
      format = $6.
      informat = $6.
      label = 'LEGAL_ENTITY_CODE',
   MVBS_OUTPUT.REGION length = 5   
      format = $5.
      informat = $5.
      label = 'REGION',
   MVBS_OUTPUT.COUNTRY_ID_TECHDB length = 2   
      format = $2.
      informat = $2.
      label = 'COUNTRY_ID_TECHDB',
   MVBS_OUTPUT.ABACUS_SII_LOB length = 50   
      format = $50.
      informat = $50.
      label = 'ABACUS_SII_LOB',
   MVBS_OUTPUT.CARVE_OUT_LOB length = 50   
      format = $50.
      informat = $50.
      label = 'CARVE_OUT_LOB',
   MVBS_OUTPUT.GUIDE_6_LOB length = 50   
      format = $50.
      informat = $50.
      label = 'GUIDE_6_LOB',
   MVBS_OUTPUT.SUPER_LOB length = 50   
      format = $50.
      informat = $50.
      label = 'SUPER_LOB',
   MVBS_OUTPUT.SII_LOB_CODE length = 50   
      format = $50.
      informat = $50.
      label = 'SII_LOB_CODE',
   MVBS_OUTPUT.SII_LOB_STRING length = 200   
      format = $200.
      informat = $200.
      label = 'SII_LOB_STRING',
   MVBS_OUTPUT.SM_LOB length = 50   
      format = $50.
      informat = $50.
      label = 'SM_LOB',
   MVBS_OUTPUT.PARTNER_ID_GROSS_DERIVED length = 5   
      format = $5.
      informat = $5.
      label = 'PARTNER_ID_GROSS_DERIVED',
   MVBS_OUTPUT.PROP_NONPROP_RETRO length = 18   
      format = $18.
      informat = $18.
      label = 'PROP_NONPROP_RETRO',
   MVBS_OUTPUT.VERSION_ID length = 8   
      label = 'VERSION_ID',
   MVBS_OUTPUT.LOAD_TIMESTAMP length = 8   
      format = DATETIME20.
      informat = DATETIME20.
      label = 'LOAD_TIMESTAMP',
   MVBS_OUTPUT.QRT_RELEVANT length = 1   
      format = $1.
      informat = $1.
      label = 'QRT_RELEVANT',
   MVBS_OUTPUT.CLAIM_TYPE length = 1   
      format = $1.
      informat = $1.
      label = 'CLAIM_TYPE',
   MVBS_OUTPUT.DISCOUNT_RATE_FLAG length = 1   
      format = $1.
      informat = $1.
      label = 'DISCOUNT_RATE_FLAG',
   MVBS_OUTPUT.INSTRUMENT length = 6   
      format = $6.
      informat = $6.
      label = 'INSTRUMENT'
from
   RESASDWH.MVBS_OUTPUT as MVBS_OUTPUT
where
   MVBS_OUTPUT.VERSION_ID IN (
      select distinct
         MVBS_LOG.VERSION_ID length = 8   
            label = 'VERSION_ID'
      from
         RESASDWH.MVBS_LOG as MVBS_LOG
      where
         MVBS_LOG.REPORTING_PERIOD = "&reporting_period1"
   )
;
quit;

%global etls_sql_pushDown;
%let etls_sql_pushDown = &sys_sql_ip_all;

%rcSet(&sqlrc); 



/**  Step end Create Table **/

/*==========================================================================* 
 * Step:            Table Loader                          A5V8BXSQ.AW0004VF * 
 * Transform:       Table Loader (Version 2.1)                              * 
 * Description:                                                             * 
 *                                                                          * 
 * Source Table:    Create Table - work.WCOBHOG1          A5V8BXSQ.AQ000260 * 
 * Target Table:    MVBS_OUTPUT_ARCHIVE -                 A5V8BXSQ.AE0002CR * 
 *                   RESASDWH.MVBS_OUTPUT_ARCHIVE                           * 
 *==========================================================================*/ 

%let transformID = %quote(A5V8BXSQ.AW0004VF);
%let trans_rc = 0;
%let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 

%let SYSLAST = %nrquote(work.WCOBHOG1); 

%global etls_sql_pushDown;
%let etls_sql_pushDown = -1;
option DBIDIRECTEXEC;

%global etls_tableExist;
%global etls_numIndex;
%global etls_lastTable;
%let etls_tableExist = -1; 
%let etls_numIndex = -1; 
%let etls_lastTable = &SYSLAST; 

/*---- Define load data macro  ----*/ 

/* --------------------------------------------------------------
   Load Technique Selection: AppendToExisting - AppendProc
   Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
   Additional options selections... 
      Set unmapped to missing on updates: false 
   -------------------------------------------------------------- */
%macro etls_loader;

   %let etls_tableOptions = ;
   
   /* Determine if the target table exists  */ 
   %let etls_tableExist = %eval(%sysfunc(exist(RESASDWH.MVBS_OUTPUT_ARCHIVE, DATA)) or 
         %sysfunc(exist(RESASDWH.MVBS_OUTPUT_ARCHIVE, VIEW))); 
   
   /*---- Create a new table  ----*/ 
   %if (&etls_tableExist eq 0) %then 
   %do;  /* if table does not exist  */ 
   
      %put %str(NOTE: Creating table ...);
      
      data RESASDWH.MVBS_OUTPUT_ARCHIVE
              (dbnull = (
                         LINE_NUMBER = YES
                         FILENAME = YES
                         DISCUNDISC = YES
                         LEGAL_ENTITY_NAME = YES
                         MANDANT_ID = YES
                         PROP_NONPROP = YES
                         CEDENT_DOM_ID = YES
                         INTEXT = YES
                         CONVENTIONAL_SCOB_IN_SICS = YES
                         RES_SEG_LEVEL1 = YES
                         RES_SEG_LEVEL2 = YES
                         RES_SEG_LEVEL3 = YES
                         RES_SEG_LEVEL4 = YES
                         RES_SEG_LEVEL5 = YES
                         CURR_TO_USE = YES
                         INWARD_BUS_ID = YES
                         OUTWARD_BUS_ID = YES
                         PARTNER_ID_RETRO = YES
                         VBUND_RETRO = YES
                         INTEXT_RETRO = YES
                         REL_YR_ID = YES
                         REL_YR_VAL = YES
                         LRDB_VAL_DATE = YES
                         AMT_TYPE = YES
                         GROSSRETRO = YES
                         PERIOD = YES
                         EUR_AMOUNT = YES
                         AMOUNT = YES
                         PARTNER_ID_GROSS = YES
                         VBUND_GROSS = YES
                         SEGMENT = YES
                         LEGAL_ENTITY_CODE = YES
                         REGION = YES
                         COUNTRY_ID_TECHDB = YES
                         ABACUS_SII_LOB = YES
                         CARVE_OUT_LOB = YES
                         GUIDE_6_LOB = YES
                         SUPER_LOB = YES
                         SII_LOB_CODE = YES
                         SII_LOB_STRING = YES
                         SM_LOB = YES
                         PARTNER_ID_GROSS_DERIVED = YES
                         PROP_NONPROP_RETRO = YES
                         VERSION_ID = YES
                         LOAD_TIMESTAMP = YES
                         QRT_RELEVANT = NO
                         CLAIM_TYPE = YES
                         DISCOUNT_RATE_FLAG = YES
                         INSTRUMENT = YES));
         attrib LINE_NUMBER length = 8
            label = 'LINE_NUMBER'; 
         attrib FILENAME length = $100
            format = $100.
            informat = $100.
            label = 'FILENAME'; 
         attrib DISCUNDISC length = $12
            format = $12.
            informat = $12.
            label = 'DISCUNDISC'; 
         attrib LEGAL_ENTITY_NAME length = $50
            format = $50.
            informat = $50.
            label = 'LEGAL_ENTITY_NAME'; 
         attrib MANDANT_ID length = $5
            format = $5.
            informat = $5.
            label = 'MANDANT_ID'; 
         attrib PROP_NONPROP length = $15
            format = $15.
            informat = $15.
            label = 'PROP_NONPROP'; 
         attrib CEDENT_DOM_ID length = $23
            format = $23.
            informat = $23.
            label = 'CEDENT_DOM_ID'; 
         attrib INTEXT length = $8
            format = $8.
            informat = $8.
            label = 'INTEXT'; 
         attrib CONVENTIONAL_SCOB_IN_SICS length = $25
            format = $25.
            informat = $25.
            label = 'CONVENTIONAL_SCOB_IN_SICS'; 
         attrib RES_SEG_LEVEL1 length = $30
            format = $30.
            informat = $30.
            label = 'RES_SEG_LEVEL1'; 
         attrib RES_SEG_LEVEL2 length = $30
            format = $30.
            informat = $30.
            label = 'RES_SEG_LEVEL2'; 
         attrib RES_SEG_LEVEL3 length = $30
            format = $30.
            informat = $30.
            label = 'RES_SEG_LEVEL3'; 
         attrib RES_SEG_LEVEL4 length = $30
            format = $30.
            informat = $30.
            label = 'RES_SEG_LEVEL4'; 
         attrib RES_SEG_LEVEL5 length = $30
            format = $30.
            informat = $30.
            label = 'RES_SEG_LEVEL5'; 
         attrib CURR_TO_USE length = $11
            format = $11.
            informat = $11.
            label = 'CURR_TO_USE'; 
         attrib INWARD_BUS_ID length = $36
            format = $36.
            informat = $36.
            label = 'INWARD_BUS_ID'; 
         attrib OUTWARD_BUS_ID length = $36
            format = $36.
            informat = $36.
            label = 'OUTWARD_BUS_ID'; 
         attrib PARTNER_ID_RETRO length = $20
            format = $20.
            informat = $20.
            label = 'PARTNER_ID_RETRO'; 
         attrib VBUND_RETRO length = $15
            format = $15.
            informat = $15.
            label = 'VBUND_RETRO'; 
         attrib INTEXT_RETRO length = $12
            format = $12.
            informat = $12.
            label = 'INTEXT_RETRO'; 
         attrib REL_YR_ID length = $9
            format = $9.
            informat = $9.
            label = 'REL_YR_ID'; 
         attrib REL_YR_VAL length = $8
            format = $8.
            informat = $8.
            label = 'REL_YR_VAL'; 
         attrib LRDB_VAL_DATE length = $13
            format = $13.
            informat = $13.
            label = 'LRDB_VAL_DATE'; 
         attrib AMT_TYPE length = $16
            format = $16.
            informat = $16.
            label = 'AMT_TYPE'; 
         attrib GROSSRETRO length = $5
            format = $5.
            informat = $5.
            label = 'GROSSRETRO'; 
         attrib PERIOD length = $5
            format = $5.
            informat = $5.
            label = 'PERIOD'; 
         attrib EUR_AMOUNT length = 8
            label = 'EUR_AMOUNT'; 
         attrib AMOUNT length = 8
            label = 'AMOUNT'; 
         attrib PARTNER_ID_GROSS length = $15
            format = $15.
            informat = $15.
            label = 'PARTNER_ID_GROSS'; 
         attrib VBUND_GROSS length = $10
            format = $10.
            informat = $10.
            label = 'VBUND_GROSS'; 
         attrib SEGMENT length = $20
            format = $20.
            informat = $20.
            label = 'SEGMENT'; 
         attrib LEGAL_ENTITY_CODE length = $6
            format = $6.
            informat = $6.
            label = 'LEGAL_ENTITY_CODE'; 
         attrib REGION length = $5
            format = $5.
            informat = $5.
            label = 'REGION'; 
         attrib COUNTRY_ID_TECHDB length = $2
            format = $2.
            informat = $2.
            label = 'COUNTRY_ID_TECHDB'; 
         attrib ABACUS_SII_LOB length = $50
            format = $50.
            informat = $50.
            label = 'ABACUS_SII_LOB'; 
         attrib CARVE_OUT_LOB length = $50
            format = $50.
            informat = $50.
            label = 'CARVE_OUT_LOB'; 
         attrib GUIDE_6_LOB length = $50
            format = $50.
            informat = $50.
            label = 'GUIDE_6_LOB'; 
         attrib SUPER_LOB length = $50
            format = $50.
            informat = $50.
            label = 'SUPER_LOB'; 
         attrib SII_LOB_CODE length = $50
            format = $50.
            informat = $50.
            label = 'SII_LOB_CODE'; 
         attrib SII_LOB_STRING length = $200
            format = $200.
            informat = $200.
            label = 'SII_LOB_STRING'; 
         attrib SM_LOB length = $50
            format = $50.
            informat = $50.
            label = 'SM_LOB'; 
         attrib PARTNER_ID_GROSS_DERIVED length = $5
            format = $5.
            informat = $5.
            label = 'PARTNER_ID_GROSS_DERIVED'; 
         attrib PROP_NONPROP_RETRO length = $18
            format = $18.
            informat = $18.
            label = 'PROP_NONPROP_RETRO'; 
         attrib VERSION_ID length = 8
            label = 'VERSION_ID'; 
         attrib LOAD_TIMESTAMP length = 8
            format = DATETIME20.
            informat = DATETIME20.
            label = 'LOAD_TIMESTAMP'; 
         attrib QRT_RELEVANT length = $1
            format = $1.
            informat = $1.
            label = 'QRT_RELEVANT'; 
         attrib CLAIM_TYPE length = $1
            format = $1.
            informat = $1.
            label = 'CLAIM_TYPE'; 
         attrib DISCOUNT_RATE_FLAG length = $1
            format = $1.
            informat = $1.
            label = 'DISCOUNT_RATE_FLAG'; 
         attrib INSTRUMENT length = $6
            format = $6.
            informat = $6.
            label = 'INSTRUMENT'; 
         call missing(of _all_);
         stop;
      run;
      
      %rcSet(&syserr); 
      
   %end;  /* if table does not exist  */ 
   
   /*---- Append  ----*/ 
   %put %str(NOTE: Appending data ...);
   
   proc append base = RESASDWH.MVBS_OUTPUT_ARCHIVE 
      data = &etls_lastTable (&etls_tableOptions)  force ; 
    run; 
   
   %rcSet(&syserr); 
   
%mend etls_loader;
%etls_loader;



/**  Step end Table Loader **/

/*==========================================================================* 
 * Step:            Execute                               A5V8BXSQ.AW0004VG * 
 * Transform:       Execute                                                 * 
 * Description:                                                             * 
 *                                                                          * 
 * Target Table:    MVBS_OUTPUT - RESASDWH.MVBS_OUTPUT    A5V8BXSQ.AE0001W7 * 
 *                                                                          * 
 * User Written:    SourceCode                                              * 
 *==========================================================================*/ 

%let transformID = %quote(A5V8BXSQ.AW0004VG);
%let trans_rc = 0;
%let etls_stepStartTime = %sysfunc(datetime(), datetime20.); 

%let _INPUT_count = 0;
%let _OUTPUT_count = 1;
%let _OUTPUT = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_connect =  DBMAX_TEXT=32767 PATH="&ORA_RESASDWH_PATH" user="&ORA_RESASDWH_USER" pw="&ORA_RESASDWH_PWD"
;
%let _OUTPUT_engine = ORACLE;
%let _OUTPUT_memtype = DATA;
%let _OUTPUT_options = %nrquote();
%let _OUTPUT_alter = %nrquote();
%let _OUTPUT_path = %nrquote(/ETL/tdbpcd/Tables/Target/MVBS/MVBS_OUTPUT%(Table%));
%let _OUTPUT_type = 1;
%let _OUTPUT_label = %nrquote();
/* List of target columns to keep  */ 
%let _OUTPUT_keep = LINE_NUMBER FILENAME DISCUNDISC LEGAL_ENTITY_NAME MANDANT_ID 
        PROP_NONPROP CEDENT_DOM_ID INTEXT CONVENTIONAL_SCOB_IN_SICS 
        RES_SEG_LEVEL1 RES_SEG_LEVEL2 RES_SEG_LEVEL3 RES_SEG_LEVEL4 
        RES_SEG_LEVEL5 CURR_TO_USE INWARD_BUS_ID OUTWARD_BUS_ID 
        PARTNER_ID_RETRO VBUND_RETRO INTEXT_RETRO REL_YR_ID REL_YR_VAL 
        LRDB_VAL_DATE AMT_TYPE GROSSRETRO PERIOD EUR_AMOUNT AMOUNT 
        PARTNER_ID_GROSS VBUND_GROSS SEGMENT LEGAL_ENTITY_CODE REGION 
        COUNTRY_ID_TECHDB ABACUS_SII_LOB CARVE_OUT_LOB GUIDE_6_LOB SUPER_LOB 
        SII_LOB_CODE SII_LOB_STRING SM_LOB PARTNER_ID_GROSS_DERIVED 
        PROP_NONPROP_RETRO VERSION_ID LOAD_TIMESTAMP QRT_RELEVANT CLAIM_TYPE 
        DISCOUNT_RATE_FLAG INSTRUMENT;
%let _OUTPUT_col_count = 49;
%let _OUTPUT_col0_name = LINE_NUMBER;
%let _OUTPUT_col0_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col0_length = 8;
%let _OUTPUT_col0_type = ;
%let _OUTPUT_col0_format = ;
%let _OUTPUT_col0_informat = ;
%let _OUTPUT_col0_label = %nrquote(LINE_NUMBER);
%let _OUTPUT_col0_exp = ;
%let _OUTPUT_col0_input_count = 0;
%let _OUTPUT_col1_name = FILENAME;
%let _OUTPUT_col1_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col1_length = 100;
%let _OUTPUT_col1_type = $;
%let _OUTPUT_col1_format = $100.;
%let _OUTPUT_col1_informat = $100.;
%let _OUTPUT_col1_label = %nrquote(FILENAME);
%let _OUTPUT_col1_exp = ;
%let _OUTPUT_col1_input_count = 0;
%let _OUTPUT_col2_name = DISCUNDISC;
%let _OUTPUT_col2_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col2_length = 12;
%let _OUTPUT_col2_type = $;
%let _OUTPUT_col2_format = $12.;
%let _OUTPUT_col2_informat = $12.;
%let _OUTPUT_col2_label = %nrquote(DISCUNDISC);
%let _OUTPUT_col2_exp = ;
%let _OUTPUT_col2_input_count = 0;
%let _OUTPUT_col3_name = LEGAL_ENTITY_NAME;
%let _OUTPUT_col3_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col3_length = 50;
%let _OUTPUT_col3_type = $;
%let _OUTPUT_col3_format = $50.;
%let _OUTPUT_col3_informat = $50.;
%let _OUTPUT_col3_label = %nrquote(LEGAL_ENTITY_NAME);
%let _OUTPUT_col3_exp = ;
%let _OUTPUT_col3_input_count = 0;
%let _OUTPUT_col4_name = MANDANT_ID;
%let _OUTPUT_col4_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col4_length = 5;
%let _OUTPUT_col4_type = $;
%let _OUTPUT_col4_format = $5.;
%let _OUTPUT_col4_informat = $5.;
%let _OUTPUT_col4_label = %nrquote(MANDANT_ID);
%let _OUTPUT_col4_exp = ;
%let _OUTPUT_col4_input_count = 0;
%let _OUTPUT_col5_name = PROP_NONPROP;
%let _OUTPUT_col5_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col5_length = 15;
%let _OUTPUT_col5_type = $;
%let _OUTPUT_col5_format = $15.;
%let _OUTPUT_col5_informat = $15.;
%let _OUTPUT_col5_label = %nrquote(PROP_NONPROP);
%let _OUTPUT_col5_exp = ;
%let _OUTPUT_col5_input_count = 0;
%let _OUTPUT_col6_name = CEDENT_DOM_ID;
%let _OUTPUT_col6_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col6_length = 23;
%let _OUTPUT_col6_type = $;
%let _OUTPUT_col6_format = $23.;
%let _OUTPUT_col6_informat = $23.;
%let _OUTPUT_col6_label = %nrquote(CEDENT_DOM_ID);
%let _OUTPUT_col6_exp = ;
%let _OUTPUT_col6_input_count = 0;
%let _OUTPUT_col7_name = INTEXT;
%let _OUTPUT_col7_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col7_length = 8;
%let _OUTPUT_col7_type = $;
%let _OUTPUT_col7_format = $8.;
%let _OUTPUT_col7_informat = $8.;
%let _OUTPUT_col7_label = %nrquote(INTEXT);
%let _OUTPUT_col7_exp = ;
%let _OUTPUT_col7_input_count = 0;
%let _OUTPUT_col8_name = CONVENTIONAL_SCOB_IN_SICS;
%let _OUTPUT_col8_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col8_length = 25;
%let _OUTPUT_col8_type = $;
%let _OUTPUT_col8_format = $25.;
%let _OUTPUT_col8_informat = $25.;
%let _OUTPUT_col8_label = %nrquote(CONVENTIONAL_SCOB_IN_SICS);
%let _OUTPUT_col8_exp = ;
%let _OUTPUT_col8_input_count = 0;
%let _OUTPUT_col9_name = RES_SEG_LEVEL1;
%let _OUTPUT_col9_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col9_length = 30;
%let _OUTPUT_col9_type = $;
%let _OUTPUT_col9_format = $30.;
%let _OUTPUT_col9_informat = $30.;
%let _OUTPUT_col9_label = %nrquote(RES_SEG_LEVEL1);
%let _OUTPUT_col9_exp = ;
%let _OUTPUT_col9_input_count = 0;
%let _OUTPUT_col10_name = RES_SEG_LEVEL2;
%let _OUTPUT_col10_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col10_length = 30;
%let _OUTPUT_col10_type = $;
%let _OUTPUT_col10_format = $30.;
%let _OUTPUT_col10_informat = $30.;
%let _OUTPUT_col10_label = %nrquote(RES_SEG_LEVEL2);
%let _OUTPUT_col10_exp = ;
%let _OUTPUT_col10_input_count = 0;
%let _OUTPUT_col11_name = RES_SEG_LEVEL3;
%let _OUTPUT_col11_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col11_length = 30;
%let _OUTPUT_col11_type = $;
%let _OUTPUT_col11_format = $30.;
%let _OUTPUT_col11_informat = $30.;
%let _OUTPUT_col11_label = %nrquote(RES_SEG_LEVEL3);
%let _OUTPUT_col11_exp = ;
%let _OUTPUT_col11_input_count = 0;
%let _OUTPUT_col12_name = RES_SEG_LEVEL4;
%let _OUTPUT_col12_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col12_length = 30;
%let _OUTPUT_col12_type = $;
%let _OUTPUT_col12_format = $30.;
%let _OUTPUT_col12_informat = $30.;
%let _OUTPUT_col12_label = %nrquote(RES_SEG_LEVEL4);
%let _OUTPUT_col12_exp = ;
%let _OUTPUT_col12_input_count = 0;
%let _OUTPUT_col13_name = RES_SEG_LEVEL5;
%let _OUTPUT_col13_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col13_length = 30;
%let _OUTPUT_col13_type = $;
%let _OUTPUT_col13_format = $30.;
%let _OUTPUT_col13_informat = $30.;
%let _OUTPUT_col13_label = %nrquote(RES_SEG_LEVEL5);
%let _OUTPUT_col13_exp = ;
%let _OUTPUT_col13_input_count = 0;
%let _OUTPUT_col14_name = CURR_TO_USE;
%let _OUTPUT_col14_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col14_length = 11;
%let _OUTPUT_col14_type = $;
%let _OUTPUT_col14_format = $11.;
%let _OUTPUT_col14_informat = $11.;
%let _OUTPUT_col14_label = %nrquote(CURR_TO_USE);
%let _OUTPUT_col14_exp = ;
%let _OUTPUT_col14_input_count = 0;
%let _OUTPUT_col15_name = INWARD_BUS_ID;
%let _OUTPUT_col15_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col15_length = 36;
%let _OUTPUT_col15_type = $;
%let _OUTPUT_col15_format = $36.;
%let _OUTPUT_col15_informat = $36.;
%let _OUTPUT_col15_label = %nrquote(INWARD_BUS_ID);
%let _OUTPUT_col15_exp = ;
%let _OUTPUT_col15_input_count = 0;
%let _OUTPUT_col16_name = OUTWARD_BUS_ID;
%let _OUTPUT_col16_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col16_length = 36;
%let _OUTPUT_col16_type = $;
%let _OUTPUT_col16_format = $36.;
%let _OUTPUT_col16_informat = $36.;
%let _OUTPUT_col16_label = %nrquote(OUTWARD_BUS_ID);
%let _OUTPUT_col16_exp = ;
%let _OUTPUT_col16_input_count = 0;
%let _OUTPUT_col17_name = PARTNER_ID_RETRO;
%let _OUTPUT_col17_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col17_length = 20;
%let _OUTPUT_col17_type = $;
%let _OUTPUT_col17_format = $20.;
%let _OUTPUT_col17_informat = $20.;
%let _OUTPUT_col17_label = %nrquote(PARTNER_ID_RETRO);
%let _OUTPUT_col17_exp = ;
%let _OUTPUT_col17_input_count = 0;
%let _OUTPUT_col18_name = VBUND_RETRO;
%let _OUTPUT_col18_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col18_length = 15;
%let _OUTPUT_col18_type = $;
%let _OUTPUT_col18_format = $15.;
%let _OUTPUT_col18_informat = $15.;
%let _OUTPUT_col18_label = %nrquote(VBUND_RETRO);
%let _OUTPUT_col18_exp = ;
%let _OUTPUT_col18_input_count = 0;
%let _OUTPUT_col19_name = INTEXT_RETRO;
%let _OUTPUT_col19_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col19_length = 12;
%let _OUTPUT_col19_type = $;
%let _OUTPUT_col19_format = $12.;
%let _OUTPUT_col19_informat = $12.;
%let _OUTPUT_col19_label = %nrquote(INTEXT_RETRO);
%let _OUTPUT_col19_exp = ;
%let _OUTPUT_col19_input_count = 0;
%let _OUTPUT_col20_name = REL_YR_ID;
%let _OUTPUT_col20_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col20_length = 9;
%let _OUTPUT_col20_type = $;
%let _OUTPUT_col20_format = $9.;
%let _OUTPUT_col20_informat = $9.;
%let _OUTPUT_col20_label = %nrquote(REL_YR_ID);
%let _OUTPUT_col20_exp = ;
%let _OUTPUT_col20_input_count = 0;
%let _OUTPUT_col21_name = REL_YR_VAL;
%let _OUTPUT_col21_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col21_length = 8;
%let _OUTPUT_col21_type = $;
%let _OUTPUT_col21_format = $8.;
%let _OUTPUT_col21_informat = $8.;
%let _OUTPUT_col21_label = %nrquote(REL_YR_VAL);
%let _OUTPUT_col21_exp = ;
%let _OUTPUT_col21_input_count = 0;
%let _OUTPUT_col22_name = LRDB_VAL_DATE;
%let _OUTPUT_col22_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col22_length = 13;
%let _OUTPUT_col22_type = $;
%let _OUTPUT_col22_format = $13.;
%let _OUTPUT_col22_informat = $13.;
%let _OUTPUT_col22_label = %nrquote(LRDB_VAL_DATE);
%let _OUTPUT_col22_exp = ;
%let _OUTPUT_col22_input_count = 0;
%let _OUTPUT_col23_name = AMT_TYPE;
%let _OUTPUT_col23_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col23_length = 16;
%let _OUTPUT_col23_type = $;
%let _OUTPUT_col23_format = $16.;
%let _OUTPUT_col23_informat = $16.;
%let _OUTPUT_col23_label = %nrquote(AMT_TYPE);
%let _OUTPUT_col23_exp = ;
%let _OUTPUT_col23_input_count = 0;
%let _OUTPUT_col24_name = GROSSRETRO;
%let _OUTPUT_col24_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col24_length = 5;
%let _OUTPUT_col24_type = $;
%let _OUTPUT_col24_format = $5.;
%let _OUTPUT_col24_informat = $5.;
%let _OUTPUT_col24_label = %nrquote(GROSSRETRO);
%let _OUTPUT_col24_exp = ;
%let _OUTPUT_col24_input_count = 0;
%let _OUTPUT_col25_name = PERIOD;
%let _OUTPUT_col25_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col25_length = 5;
%let _OUTPUT_col25_type = $;
%let _OUTPUT_col25_format = $5.;
%let _OUTPUT_col25_informat = $5.;
%let _OUTPUT_col25_label = %nrquote(PERIOD);
%let _OUTPUT_col25_exp = ;
%let _OUTPUT_col25_input_count = 0;
%let _OUTPUT_col26_name = EUR_AMOUNT;
%let _OUTPUT_col26_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col26_length = 8;
%let _OUTPUT_col26_type = ;
%let _OUTPUT_col26_format = ;
%let _OUTPUT_col26_informat = ;
%let _OUTPUT_col26_label = %nrquote(EUR_AMOUNT);
%let _OUTPUT_col26_exp = ;
%let _OUTPUT_col26_input_count = 0;
%let _OUTPUT_col27_name = AMOUNT;
%let _OUTPUT_col27_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col27_length = 8;
%let _OUTPUT_col27_type = ;
%let _OUTPUT_col27_format = ;
%let _OUTPUT_col27_informat = ;
%let _OUTPUT_col27_label = %nrquote(AMOUNT);
%let _OUTPUT_col27_exp = ;
%let _OUTPUT_col27_input_count = 0;
%let _OUTPUT_col28_name = PARTNER_ID_GROSS;
%let _OUTPUT_col28_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col28_length = 15;
%let _OUTPUT_col28_type = $;
%let _OUTPUT_col28_format = $15.;
%let _OUTPUT_col28_informat = $15.;
%let _OUTPUT_col28_label = %nrquote(PARTNER_ID_GROSS);
%let _OUTPUT_col28_exp = ;
%let _OUTPUT_col28_input_count = 0;
%let _OUTPUT_col29_name = VBUND_GROSS;
%let _OUTPUT_col29_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col29_length = 10;
%let _OUTPUT_col29_type = $;
%let _OUTPUT_col29_format = $10.;
%let _OUTPUT_col29_informat = $10.;
%let _OUTPUT_col29_label = %nrquote(VBUND_GROSS);
%let _OUTPUT_col29_exp = ;
%let _OUTPUT_col29_input_count = 0;
%let _OUTPUT_col30_name = SEGMENT;
%let _OUTPUT_col30_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col30_length = 20;
%let _OUTPUT_col30_type = $;
%let _OUTPUT_col30_format = $20.;
%let _OUTPUT_col30_informat = $20.;
%let _OUTPUT_col30_label = %nrquote(SEGMENT);
%let _OUTPUT_col30_exp = ;
%let _OUTPUT_col30_input_count = 0;
%let _OUTPUT_col31_name = LEGAL_ENTITY_CODE;
%let _OUTPUT_col31_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col31_length = 6;
%let _OUTPUT_col31_type = $;
%let _OUTPUT_col31_format = $6.;
%let _OUTPUT_col31_informat = $6.;
%let _OUTPUT_col31_label = %nrquote(LEGAL_ENTITY_CODE);
%let _OUTPUT_col31_exp = ;
%let _OUTPUT_col31_input_count = 0;
%let _OUTPUT_col32_name = REGION;
%let _OUTPUT_col32_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col32_length = 5;
%let _OUTPUT_col32_type = $;
%let _OUTPUT_col32_format = $5.;
%let _OUTPUT_col32_informat = $5.;
%let _OUTPUT_col32_label = %nrquote(REGION);
%let _OUTPUT_col32_exp = ;
%let _OUTPUT_col32_input_count = 0;
%let _OUTPUT_col33_name = COUNTRY_ID_TECHDB;
%let _OUTPUT_col33_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col33_length = 2;
%let _OUTPUT_col33_type = $;
%let _OUTPUT_col33_format = $2.;
%let _OUTPUT_col33_informat = $2.;
%let _OUTPUT_col33_label = %nrquote(COUNTRY_ID_TECHDB);
%let _OUTPUT_col33_exp = ;
%let _OUTPUT_col33_input_count = 0;
%let _OUTPUT_col34_name = ABACUS_SII_LOB;
%let _OUTPUT_col34_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col34_length = 50;
%let _OUTPUT_col34_type = $;
%let _OUTPUT_col34_format = $50.;
%let _OUTPUT_col34_informat = $50.;
%let _OUTPUT_col34_label = %nrquote(ABACUS_SII_LOB);
%let _OUTPUT_col34_exp = ;
%let _OUTPUT_col34_input_count = 0;
%let _OUTPUT_col35_name = CARVE_OUT_LOB;
%let _OUTPUT_col35_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col35_length = 50;
%let _OUTPUT_col35_type = $;
%let _OUTPUT_col35_format = $50.;
%let _OUTPUT_col35_informat = $50.;
%let _OUTPUT_col35_label = %nrquote(CARVE_OUT_LOB);
%let _OUTPUT_col35_exp = ;
%let _OUTPUT_col35_input_count = 0;
%let _OUTPUT_col36_name = GUIDE_6_LOB;
%let _OUTPUT_col36_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col36_length = 50;
%let _OUTPUT_col36_type = $;
%let _OUTPUT_col36_format = $50.;
%let _OUTPUT_col36_informat = $50.;
%let _OUTPUT_col36_label = %nrquote(GUIDE_6_LOB);
%let _OUTPUT_col36_exp = ;
%let _OUTPUT_col36_input_count = 0;
%let _OUTPUT_col37_name = SUPER_LOB;
%let _OUTPUT_col37_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col37_length = 50;
%let _OUTPUT_col37_type = $;
%let _OUTPUT_col37_format = $50.;
%let _OUTPUT_col37_informat = $50.;
%let _OUTPUT_col37_label = %nrquote(SUPER_LOB);
%let _OUTPUT_col37_exp = ;
%let _OUTPUT_col37_input_count = 0;
%let _OUTPUT_col38_name = SII_LOB_CODE;
%let _OUTPUT_col38_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col38_length = 50;
%let _OUTPUT_col38_type = $;
%let _OUTPUT_col38_format = $50.;
%let _OUTPUT_col38_informat = $50.;
%let _OUTPUT_col38_label = %nrquote(SII_LOB_CODE);
%let _OUTPUT_col38_exp = ;
%let _OUTPUT_col38_input_count = 0;
%let _OUTPUT_col39_name = SII_LOB_STRING;
%let _OUTPUT_col39_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col39_length = 200;
%let _OUTPUT_col39_type = $;
%let _OUTPUT_col39_format = $200.;
%let _OUTPUT_col39_informat = $200.;
%let _OUTPUT_col39_label = %nrquote(SII_LOB_STRING);
%let _OUTPUT_col39_exp = ;
%let _OUTPUT_col39_input_count = 0;
%let _OUTPUT_col40_name = SM_LOB;
%let _OUTPUT_col40_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col40_length = 50;
%let _OUTPUT_col40_type = $;
%let _OUTPUT_col40_format = $50.;
%let _OUTPUT_col40_informat = $50.;
%let _OUTPUT_col40_label = %nrquote(SM_LOB);
%let _OUTPUT_col40_exp = ;
%let _OUTPUT_col40_input_count = 0;
%let _OUTPUT_col41_name = PARTNER_ID_GROSS_DERIVED;
%let _OUTPUT_col41_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col41_length = 5;
%let _OUTPUT_col41_type = $;
%let _OUTPUT_col41_format = $5.;
%let _OUTPUT_col41_informat = $5.;
%let _OUTPUT_col41_label = %nrquote(PARTNER_ID_GROSS_DERIVED);
%let _OUTPUT_col41_exp = ;
%let _OUTPUT_col41_input_count = 0;
%let _OUTPUT_col42_name = PROP_NONPROP_RETRO;
%let _OUTPUT_col42_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col42_length = 18;
%let _OUTPUT_col42_type = $;
%let _OUTPUT_col42_format = $18.;
%let _OUTPUT_col42_informat = $18.;
%let _OUTPUT_col42_label = %nrquote(PROP_NONPROP_RETRO);
%let _OUTPUT_col42_exp = ;
%let _OUTPUT_col42_input_count = 0;
%let _OUTPUT_col43_name = VERSION_ID;
%let _OUTPUT_col43_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col43_length = 8;
%let _OUTPUT_col43_type = ;
%let _OUTPUT_col43_format = ;
%let _OUTPUT_col43_informat = ;
%let _OUTPUT_col43_label = %nrquote(VERSION_ID);
%let _OUTPUT_col43_exp = ;
%let _OUTPUT_col43_input_count = 0;
%let _OUTPUT_col44_name = LOAD_TIMESTAMP;
%let _OUTPUT_col44_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col44_length = 8;
%let _OUTPUT_col44_type = ;
%let _OUTPUT_col44_format = DATETIME20.;
%let _OUTPUT_col44_informat = DATETIME20.;
%let _OUTPUT_col44_label = %nrquote(LOAD_TIMESTAMP);
%let _OUTPUT_col44_exp = ;
%let _OUTPUT_col44_input_count = 0;
%let _OUTPUT_col45_name = QRT_RELEVANT;
%let _OUTPUT_col45_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col45_length = 1;
%let _OUTPUT_col45_type = $;
%let _OUTPUT_col45_format = $1.;
%let _OUTPUT_col45_informat = $1.;
%let _OUTPUT_col45_label = %nrquote(QRT_RELEVANT);
%let _OUTPUT_col45_exp = ;
%let _OUTPUT_col45_input_count = 0;
%let _OUTPUT_col46_name = CLAIM_TYPE;
%let _OUTPUT_col46_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col46_length = 1;
%let _OUTPUT_col46_type = $;
%let _OUTPUT_col46_format = $1.;
%let _OUTPUT_col46_informat = $1.;
%let _OUTPUT_col46_label = %nrquote(CLAIM_TYPE);
%let _OUTPUT_col46_exp = ;
%let _OUTPUT_col46_input_count = 0;
%let _OUTPUT_col47_name = DISCOUNT_RATE_FLAG;
%let _OUTPUT_col47_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col47_length = 1;
%let _OUTPUT_col47_type = $;
%let _OUTPUT_col47_format = $1.;
%let _OUTPUT_col47_informat = $1.;
%let _OUTPUT_col47_label = %nrquote(DISCOUNT_RATE_FLAG);
%let _OUTPUT_col47_exp = ;
%let _OUTPUT_col47_input_count = 0;
%let _OUTPUT_col48_name = INSTRUMENT;
%let _OUTPUT_col48_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT_col48_length = 6;
%let _OUTPUT_col48_type = $;
%let _OUTPUT_col48_format = $6.;
%let _OUTPUT_col48_informat = $6.;
%let _OUTPUT_col48_label = %nrquote(INSTRUMENT);
%let _OUTPUT_col48_exp = ;
%let _OUTPUT_col48_input_count = 0;
%let _OUTPUT_filetype = PhysicalTable;

%let _OUTPUT1 = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_connect =  DBMAX_TEXT=32767 PATH="&ORA_RESASDWH_PATH" user="&ORA_RESASDWH_USER" pw="&ORA_RESASDWH_PWD"
;
%let _OUTPUT1_engine = ORACLE;
%let _OUTPUT1_memtype = DATA;
%let _OUTPUT1_options = %nrquote();
%let _OUTPUT1_alter = %nrquote();
%let _OUTPUT1_path = %nrquote(/ETL/tdbpcd/Tables/Target/MVBS/MVBS_OUTPUT%(Table%));
%let _OUTPUT1_type = 1;
%let _OUTPUT1_label = %nrquote();
/* List of target columns to keep  */ 
%let _OUTPUT1_keep = LINE_NUMBER FILENAME DISCUNDISC LEGAL_ENTITY_NAME MANDANT_ID 
        PROP_NONPROP CEDENT_DOM_ID INTEXT CONVENTIONAL_SCOB_IN_SICS 
        RES_SEG_LEVEL1 RES_SEG_LEVEL2 RES_SEG_LEVEL3 RES_SEG_LEVEL4 
        RES_SEG_LEVEL5 CURR_TO_USE INWARD_BUS_ID OUTWARD_BUS_ID 
        PARTNER_ID_RETRO VBUND_RETRO INTEXT_RETRO REL_YR_ID REL_YR_VAL 
        LRDB_VAL_DATE AMT_TYPE GROSSRETRO PERIOD EUR_AMOUNT AMOUNT 
        PARTNER_ID_GROSS VBUND_GROSS SEGMENT LEGAL_ENTITY_CODE REGION 
        COUNTRY_ID_TECHDB ABACUS_SII_LOB CARVE_OUT_LOB GUIDE_6_LOB SUPER_LOB 
        SII_LOB_CODE SII_LOB_STRING SM_LOB PARTNER_ID_GROSS_DERIVED 
        PROP_NONPROP_RETRO VERSION_ID LOAD_TIMESTAMP QRT_RELEVANT CLAIM_TYPE 
        DISCOUNT_RATE_FLAG INSTRUMENT;
%let _OUTPUT1_col_count = 49;
%let _OUTPUT1_col0_name = LINE_NUMBER;
%let _OUTPUT1_col0_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col0_length = 8;
%let _OUTPUT1_col0_type = ;
%let _OUTPUT1_col0_format = ;
%let _OUTPUT1_col0_informat = ;
%let _OUTPUT1_col0_label = %nrquote(LINE_NUMBER);
%let _OUTPUT1_col0_exp = ;
%let _OUTPUT1_col0_input_count = 0;
%let _OUTPUT1_col1_name = FILENAME;
%let _OUTPUT1_col1_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col1_length = 100;
%let _OUTPUT1_col1_type = $;
%let _OUTPUT1_col1_format = $100.;
%let _OUTPUT1_col1_informat = $100.;
%let _OUTPUT1_col1_label = %nrquote(FILENAME);
%let _OUTPUT1_col1_exp = ;
%let _OUTPUT1_col1_input_count = 0;
%let _OUTPUT1_col2_name = DISCUNDISC;
%let _OUTPUT1_col2_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col2_length = 12;
%let _OUTPUT1_col2_type = $;
%let _OUTPUT1_col2_format = $12.;
%let _OUTPUT1_col2_informat = $12.;
%let _OUTPUT1_col2_label = %nrquote(DISCUNDISC);
%let _OUTPUT1_col2_exp = ;
%let _OUTPUT1_col2_input_count = 0;
%let _OUTPUT1_col3_name = LEGAL_ENTITY_NAME;
%let _OUTPUT1_col3_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col3_length = 50;
%let _OUTPUT1_col3_type = $;
%let _OUTPUT1_col3_format = $50.;
%let _OUTPUT1_col3_informat = $50.;
%let _OUTPUT1_col3_label = %nrquote(LEGAL_ENTITY_NAME);
%let _OUTPUT1_col3_exp = ;
%let _OUTPUT1_col3_input_count = 0;
%let _OUTPUT1_col4_name = MANDANT_ID;
%let _OUTPUT1_col4_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col4_length = 5;
%let _OUTPUT1_col4_type = $;
%let _OUTPUT1_col4_format = $5.;
%let _OUTPUT1_col4_informat = $5.;
%let _OUTPUT1_col4_label = %nrquote(MANDANT_ID);
%let _OUTPUT1_col4_exp = ;
%let _OUTPUT1_col4_input_count = 0;
%let _OUTPUT1_col5_name = PROP_NONPROP;
%let _OUTPUT1_col5_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col5_length = 15;
%let _OUTPUT1_col5_type = $;
%let _OUTPUT1_col5_format = $15.;
%let _OUTPUT1_col5_informat = $15.;
%let _OUTPUT1_col5_label = %nrquote(PROP_NONPROP);
%let _OUTPUT1_col5_exp = ;
%let _OUTPUT1_col5_input_count = 0;
%let _OUTPUT1_col6_name = CEDENT_DOM_ID;
%let _OUTPUT1_col6_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col6_length = 23;
%let _OUTPUT1_col6_type = $;
%let _OUTPUT1_col6_format = $23.;
%let _OUTPUT1_col6_informat = $23.;
%let _OUTPUT1_col6_label = %nrquote(CEDENT_DOM_ID);
%let _OUTPUT1_col6_exp = ;
%let _OUTPUT1_col6_input_count = 0;
%let _OUTPUT1_col7_name = INTEXT;
%let _OUTPUT1_col7_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col7_length = 8;
%let _OUTPUT1_col7_type = $;
%let _OUTPUT1_col7_format = $8.;
%let _OUTPUT1_col7_informat = $8.;
%let _OUTPUT1_col7_label = %nrquote(INTEXT);
%let _OUTPUT1_col7_exp = ;
%let _OUTPUT1_col7_input_count = 0;
%let _OUTPUT1_col8_name = CONVENTIONAL_SCOB_IN_SICS;
%let _OUTPUT1_col8_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col8_length = 25;
%let _OUTPUT1_col8_type = $;
%let _OUTPUT1_col8_format = $25.;
%let _OUTPUT1_col8_informat = $25.;
%let _OUTPUT1_col8_label = %nrquote(CONVENTIONAL_SCOB_IN_SICS);
%let _OUTPUT1_col8_exp = ;
%let _OUTPUT1_col8_input_count = 0;
%let _OUTPUT1_col9_name = RES_SEG_LEVEL1;
%let _OUTPUT1_col9_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col9_length = 30;
%let _OUTPUT1_col9_type = $;
%let _OUTPUT1_col9_format = $30.;
%let _OUTPUT1_col9_informat = $30.;
%let _OUTPUT1_col9_label = %nrquote(RES_SEG_LEVEL1);
%let _OUTPUT1_col9_exp = ;
%let _OUTPUT1_col9_input_count = 0;
%let _OUTPUT1_col10_name = RES_SEG_LEVEL2;
%let _OUTPUT1_col10_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col10_length = 30;
%let _OUTPUT1_col10_type = $;
%let _OUTPUT1_col10_format = $30.;
%let _OUTPUT1_col10_informat = $30.;
%let _OUTPUT1_col10_label = %nrquote(RES_SEG_LEVEL2);
%let _OUTPUT1_col10_exp = ;
%let _OUTPUT1_col10_input_count = 0;
%let _OUTPUT1_col11_name = RES_SEG_LEVEL3;
%let _OUTPUT1_col11_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col11_length = 30;
%let _OUTPUT1_col11_type = $;
%let _OUTPUT1_col11_format = $30.;
%let _OUTPUT1_col11_informat = $30.;
%let _OUTPUT1_col11_label = %nrquote(RES_SEG_LEVEL3);
%let _OUTPUT1_col11_exp = ;
%let _OUTPUT1_col11_input_count = 0;
%let _OUTPUT1_col12_name = RES_SEG_LEVEL4;
%let _OUTPUT1_col12_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col12_length = 30;
%let _OUTPUT1_col12_type = $;
%let _OUTPUT1_col12_format = $30.;
%let _OUTPUT1_col12_informat = $30.;
%let _OUTPUT1_col12_label = %nrquote(RES_SEG_LEVEL4);
%let _OUTPUT1_col12_exp = ;
%let _OUTPUT1_col12_input_count = 0;
%let _OUTPUT1_col13_name = RES_SEG_LEVEL5;
%let _OUTPUT1_col13_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col13_length = 30;
%let _OUTPUT1_col13_type = $;
%let _OUTPUT1_col13_format = $30.;
%let _OUTPUT1_col13_informat = $30.;
%let _OUTPUT1_col13_label = %nrquote(RES_SEG_LEVEL5);
%let _OUTPUT1_col13_exp = ;
%let _OUTPUT1_col13_input_count = 0;
%let _OUTPUT1_col14_name = CURR_TO_USE;
%let _OUTPUT1_col14_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col14_length = 11;
%let _OUTPUT1_col14_type = $;
%let _OUTPUT1_col14_format = $11.;
%let _OUTPUT1_col14_informat = $11.;
%let _OUTPUT1_col14_label = %nrquote(CURR_TO_USE);
%let _OUTPUT1_col14_exp = ;
%let _OUTPUT1_col14_input_count = 0;
%let _OUTPUT1_col15_name = INWARD_BUS_ID;
%let _OUTPUT1_col15_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col15_length = 36;
%let _OUTPUT1_col15_type = $;
%let _OUTPUT1_col15_format = $36.;
%let _OUTPUT1_col15_informat = $36.;
%let _OUTPUT1_col15_label = %nrquote(INWARD_BUS_ID);
%let _OUTPUT1_col15_exp = ;
%let _OUTPUT1_col15_input_count = 0;
%let _OUTPUT1_col16_name = OUTWARD_BUS_ID;
%let _OUTPUT1_col16_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col16_length = 36;
%let _OUTPUT1_col16_type = $;
%let _OUTPUT1_col16_format = $36.;
%let _OUTPUT1_col16_informat = $36.;
%let _OUTPUT1_col16_label = %nrquote(OUTWARD_BUS_ID);
%let _OUTPUT1_col16_exp = ;
%let _OUTPUT1_col16_input_count = 0;
%let _OUTPUT1_col17_name = PARTNER_ID_RETRO;
%let _OUTPUT1_col17_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col17_length = 20;
%let _OUTPUT1_col17_type = $;
%let _OUTPUT1_col17_format = $20.;
%let _OUTPUT1_col17_informat = $20.;
%let _OUTPUT1_col17_label = %nrquote(PARTNER_ID_RETRO);
%let _OUTPUT1_col17_exp = ;
%let _OUTPUT1_col17_input_count = 0;
%let _OUTPUT1_col18_name = VBUND_RETRO;
%let _OUTPUT1_col18_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col18_length = 15;
%let _OUTPUT1_col18_type = $;
%let _OUTPUT1_col18_format = $15.;
%let _OUTPUT1_col18_informat = $15.;
%let _OUTPUT1_col18_label = %nrquote(VBUND_RETRO);
%let _OUTPUT1_col18_exp = ;
%let _OUTPUT1_col18_input_count = 0;
%let _OUTPUT1_col19_name = INTEXT_RETRO;
%let _OUTPUT1_col19_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col19_length = 12;
%let _OUTPUT1_col19_type = $;
%let _OUTPUT1_col19_format = $12.;
%let _OUTPUT1_col19_informat = $12.;
%let _OUTPUT1_col19_label = %nrquote(INTEXT_RETRO);
%let _OUTPUT1_col19_exp = ;
%let _OUTPUT1_col19_input_count = 0;
%let _OUTPUT1_col20_name = REL_YR_ID;
%let _OUTPUT1_col20_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col20_length = 9;
%let _OUTPUT1_col20_type = $;
%let _OUTPUT1_col20_format = $9.;
%let _OUTPUT1_col20_informat = $9.;
%let _OUTPUT1_col20_label = %nrquote(REL_YR_ID);
%let _OUTPUT1_col20_exp = ;
%let _OUTPUT1_col20_input_count = 0;
%let _OUTPUT1_col21_name = REL_YR_VAL;
%let _OUTPUT1_col21_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col21_length = 8;
%let _OUTPUT1_col21_type = $;
%let _OUTPUT1_col21_format = $8.;
%let _OUTPUT1_col21_informat = $8.;
%let _OUTPUT1_col21_label = %nrquote(REL_YR_VAL);
%let _OUTPUT1_col21_exp = ;
%let _OUTPUT1_col21_input_count = 0;
%let _OUTPUT1_col22_name = LRDB_VAL_DATE;
%let _OUTPUT1_col22_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col22_length = 13;
%let _OUTPUT1_col22_type = $;
%let _OUTPUT1_col22_format = $13.;
%let _OUTPUT1_col22_informat = $13.;
%let _OUTPUT1_col22_label = %nrquote(LRDB_VAL_DATE);
%let _OUTPUT1_col22_exp = ;
%let _OUTPUT1_col22_input_count = 0;
%let _OUTPUT1_col23_name = AMT_TYPE;
%let _OUTPUT1_col23_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col23_length = 16;
%let _OUTPUT1_col23_type = $;
%let _OUTPUT1_col23_format = $16.;
%let _OUTPUT1_col23_informat = $16.;
%let _OUTPUT1_col23_label = %nrquote(AMT_TYPE);
%let _OUTPUT1_col23_exp = ;
%let _OUTPUT1_col23_input_count = 0;
%let _OUTPUT1_col24_name = GROSSRETRO;
%let _OUTPUT1_col24_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col24_length = 5;
%let _OUTPUT1_col24_type = $;
%let _OUTPUT1_col24_format = $5.;
%let _OUTPUT1_col24_informat = $5.;
%let _OUTPUT1_col24_label = %nrquote(GROSSRETRO);
%let _OUTPUT1_col24_exp = ;
%let _OUTPUT1_col24_input_count = 0;
%let _OUTPUT1_col25_name = PERIOD;
%let _OUTPUT1_col25_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col25_length = 5;
%let _OUTPUT1_col25_type = $;
%let _OUTPUT1_col25_format = $5.;
%let _OUTPUT1_col25_informat = $5.;
%let _OUTPUT1_col25_label = %nrquote(PERIOD);
%let _OUTPUT1_col25_exp = ;
%let _OUTPUT1_col25_input_count = 0;
%let _OUTPUT1_col26_name = EUR_AMOUNT;
%let _OUTPUT1_col26_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col26_length = 8;
%let _OUTPUT1_col26_type = ;
%let _OUTPUT1_col26_format = ;
%let _OUTPUT1_col26_informat = ;
%let _OUTPUT1_col26_label = %nrquote(EUR_AMOUNT);
%let _OUTPUT1_col26_exp = ;
%let _OUTPUT1_col26_input_count = 0;
%let _OUTPUT1_col27_name = AMOUNT;
%let _OUTPUT1_col27_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col27_length = 8;
%let _OUTPUT1_col27_type = ;
%let _OUTPUT1_col27_format = ;
%let _OUTPUT1_col27_informat = ;
%let _OUTPUT1_col27_label = %nrquote(AMOUNT);
%let _OUTPUT1_col27_exp = ;
%let _OUTPUT1_col27_input_count = 0;
%let _OUTPUT1_col28_name = PARTNER_ID_GROSS;
%let _OUTPUT1_col28_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col28_length = 15;
%let _OUTPUT1_col28_type = $;
%let _OUTPUT1_col28_format = $15.;
%let _OUTPUT1_col28_informat = $15.;
%let _OUTPUT1_col28_label = %nrquote(PARTNER_ID_GROSS);
%let _OUTPUT1_col28_exp = ;
%let _OUTPUT1_col28_input_count = 0;
%let _OUTPUT1_col29_name = VBUND_GROSS;
%let _OUTPUT1_col29_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col29_length = 10;
%let _OUTPUT1_col29_type = $;
%let _OUTPUT1_col29_format = $10.;
%let _OUTPUT1_col29_informat = $10.;
%let _OUTPUT1_col29_label = %nrquote(VBUND_GROSS);
%let _OUTPUT1_col29_exp = ;
%let _OUTPUT1_col29_input_count = 0;
%let _OUTPUT1_col30_name = SEGMENT;
%let _OUTPUT1_col30_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col30_length = 20;
%let _OUTPUT1_col30_type = $;
%let _OUTPUT1_col30_format = $20.;
%let _OUTPUT1_col30_informat = $20.;
%let _OUTPUT1_col30_label = %nrquote(SEGMENT);
%let _OUTPUT1_col30_exp = ;
%let _OUTPUT1_col30_input_count = 0;
%let _OUTPUT1_col31_name = LEGAL_ENTITY_CODE;
%let _OUTPUT1_col31_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col31_length = 6;
%let _OUTPUT1_col31_type = $;
%let _OUTPUT1_col31_format = $6.;
%let _OUTPUT1_col31_informat = $6.;
%let _OUTPUT1_col31_label = %nrquote(LEGAL_ENTITY_CODE);
%let _OUTPUT1_col31_exp = ;
%let _OUTPUT1_col31_input_count = 0;
%let _OUTPUT1_col32_name = REGION;
%let _OUTPUT1_col32_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col32_length = 5;
%let _OUTPUT1_col32_type = $;
%let _OUTPUT1_col32_format = $5.;
%let _OUTPUT1_col32_informat = $5.;
%let _OUTPUT1_col32_label = %nrquote(REGION);
%let _OUTPUT1_col32_exp = ;
%let _OUTPUT1_col32_input_count = 0;
%let _OUTPUT1_col33_name = COUNTRY_ID_TECHDB;
%let _OUTPUT1_col33_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col33_length = 2;
%let _OUTPUT1_col33_type = $;
%let _OUTPUT1_col33_format = $2.;
%let _OUTPUT1_col33_informat = $2.;
%let _OUTPUT1_col33_label = %nrquote(COUNTRY_ID_TECHDB);
%let _OUTPUT1_col33_exp = ;
%let _OUTPUT1_col33_input_count = 0;
%let _OUTPUT1_col34_name = ABACUS_SII_LOB;
%let _OUTPUT1_col34_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col34_length = 50;
%let _OUTPUT1_col34_type = $;
%let _OUTPUT1_col34_format = $50.;
%let _OUTPUT1_col34_informat = $50.;
%let _OUTPUT1_col34_label = %nrquote(ABACUS_SII_LOB);
%let _OUTPUT1_col34_exp = ;
%let _OUTPUT1_col34_input_count = 0;
%let _OUTPUT1_col35_name = CARVE_OUT_LOB;
%let _OUTPUT1_col35_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col35_length = 50;
%let _OUTPUT1_col35_type = $;
%let _OUTPUT1_col35_format = $50.;
%let _OUTPUT1_col35_informat = $50.;
%let _OUTPUT1_col35_label = %nrquote(CARVE_OUT_LOB);
%let _OUTPUT1_col35_exp = ;
%let _OUTPUT1_col35_input_count = 0;
%let _OUTPUT1_col36_name = GUIDE_6_LOB;
%let _OUTPUT1_col36_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col36_length = 50;
%let _OUTPUT1_col36_type = $;
%let _OUTPUT1_col36_format = $50.;
%let _OUTPUT1_col36_informat = $50.;
%let _OUTPUT1_col36_label = %nrquote(GUIDE_6_LOB);
%let _OUTPUT1_col36_exp = ;
%let _OUTPUT1_col36_input_count = 0;
%let _OUTPUT1_col37_name = SUPER_LOB;
%let _OUTPUT1_col37_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col37_length = 50;
%let _OUTPUT1_col37_type = $;
%let _OUTPUT1_col37_format = $50.;
%let _OUTPUT1_col37_informat = $50.;
%let _OUTPUT1_col37_label = %nrquote(SUPER_LOB);
%let _OUTPUT1_col37_exp = ;
%let _OUTPUT1_col37_input_count = 0;
%let _OUTPUT1_col38_name = SII_LOB_CODE;
%let _OUTPUT1_col38_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col38_length = 50;
%let _OUTPUT1_col38_type = $;
%let _OUTPUT1_col38_format = $50.;
%let _OUTPUT1_col38_informat = $50.;
%let _OUTPUT1_col38_label = %nrquote(SII_LOB_CODE);
%let _OUTPUT1_col38_exp = ;
%let _OUTPUT1_col38_input_count = 0;
%let _OUTPUT1_col39_name = SII_LOB_STRING;
%let _OUTPUT1_col39_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col39_length = 200;
%let _OUTPUT1_col39_type = $;
%let _OUTPUT1_col39_format = $200.;
%let _OUTPUT1_col39_informat = $200.;
%let _OUTPUT1_col39_label = %nrquote(SII_LOB_STRING);
%let _OUTPUT1_col39_exp = ;
%let _OUTPUT1_col39_input_count = 0;
%let _OUTPUT1_col40_name = SM_LOB;
%let _OUTPUT1_col40_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col40_length = 50;
%let _OUTPUT1_col40_type = $;
%let _OUTPUT1_col40_format = $50.;
%let _OUTPUT1_col40_informat = $50.;
%let _OUTPUT1_col40_label = %nrquote(SM_LOB);
%let _OUTPUT1_col40_exp = ;
%let _OUTPUT1_col40_input_count = 0;
%let _OUTPUT1_col41_name = PARTNER_ID_GROSS_DERIVED;
%let _OUTPUT1_col41_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col41_length = 5;
%let _OUTPUT1_col41_type = $;
%let _OUTPUT1_col41_format = $5.;
%let _OUTPUT1_col41_informat = $5.;
%let _OUTPUT1_col41_label = %nrquote(PARTNER_ID_GROSS_DERIVED);
%let _OUTPUT1_col41_exp = ;
%let _OUTPUT1_col41_input_count = 0;
%let _OUTPUT1_col42_name = PROP_NONPROP_RETRO;
%let _OUTPUT1_col42_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col42_length = 18;
%let _OUTPUT1_col42_type = $;
%let _OUTPUT1_col42_format = $18.;
%let _OUTPUT1_col42_informat = $18.;
%let _OUTPUT1_col42_label = %nrquote(PROP_NONPROP_RETRO);
%let _OUTPUT1_col42_exp = ;
%let _OUTPUT1_col42_input_count = 0;
%let _OUTPUT1_col43_name = VERSION_ID;
%let _OUTPUT1_col43_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col43_length = 8;
%let _OUTPUT1_col43_type = ;
%let _OUTPUT1_col43_format = ;
%let _OUTPUT1_col43_informat = ;
%let _OUTPUT1_col43_label = %nrquote(VERSION_ID);
%let _OUTPUT1_col43_exp = ;
%let _OUTPUT1_col43_input_count = 0;
%let _OUTPUT1_col44_name = LOAD_TIMESTAMP;
%let _OUTPUT1_col44_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col44_length = 8;
%let _OUTPUT1_col44_type = ;
%let _OUTPUT1_col44_format = DATETIME20.;
%let _OUTPUT1_col44_informat = DATETIME20.;
%let _OUTPUT1_col44_label = %nrquote(LOAD_TIMESTAMP);
%let _OUTPUT1_col44_exp = ;
%let _OUTPUT1_col44_input_count = 0;
%let _OUTPUT1_col45_name = QRT_RELEVANT;
%let _OUTPUT1_col45_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col45_length = 1;
%let _OUTPUT1_col45_type = $;
%let _OUTPUT1_col45_format = $1.;
%let _OUTPUT1_col45_informat = $1.;
%let _OUTPUT1_col45_label = %nrquote(QRT_RELEVANT);
%let _OUTPUT1_col45_exp = ;
%let _OUTPUT1_col45_input_count = 0;
%let _OUTPUT1_col46_name = CLAIM_TYPE;
%let _OUTPUT1_col46_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col46_length = 1;
%let _OUTPUT1_col46_type = $;
%let _OUTPUT1_col46_format = $1.;
%let _OUTPUT1_col46_informat = $1.;
%let _OUTPUT1_col46_label = %nrquote(CLAIM_TYPE);
%let _OUTPUT1_col46_exp = ;
%let _OUTPUT1_col46_input_count = 0;
%let _OUTPUT1_col47_name = DISCOUNT_RATE_FLAG;
%let _OUTPUT1_col47_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col47_length = 1;
%let _OUTPUT1_col47_type = $;
%let _OUTPUT1_col47_format = $1.;
%let _OUTPUT1_col47_informat = $1.;
%let _OUTPUT1_col47_label = %nrquote(DISCOUNT_RATE_FLAG);
%let _OUTPUT1_col47_exp = ;
%let _OUTPUT1_col47_input_count = 0;
%let _OUTPUT1_col48_name = INSTRUMENT;
%let _OUTPUT1_col48_table = RESASDWH.MVBS_OUTPUT;
%let _OUTPUT1_col48_length = 6;
%let _OUTPUT1_col48_type = $;
%let _OUTPUT1_col48_format = $6.;
%let _OUTPUT1_col48_informat = $6.;
%let _OUTPUT1_col48_label = %nrquote(INSTRUMENT);
%let _OUTPUT1_col48_exp = ;
%let _OUTPUT1_col48_input_count = 0;
%let _OUTPUT1_filetype = PhysicalTable;

/*---- Start of User Written Code  ----*/ 


proc sql noprint;
select distinct version_id into : versions separated by ','  from resasdwh.MVBS_LOG 
		where reporting_period="&reporting_period1";
quit;

%let versions = &versions.;

proc sql;
connect to ORACLE
( 
    DBMAX_TEXT=4096 PATH="&ORA_RESASDWH_PATH." user="&ORA_RESASDWH_USER." pw="&ORA_RESASDWH_PWD." preserve_comments
); 
	execute by ORACLE
	( 
				delete from &ORA_RESASDWH_SCHEMA..MVBS_OUTPUT where version_id in (&versions.)
	);
	execute by ORACLE
	( 
	   		alter table &ORA_RESASDWH_SCHEMA..MVBS_OUTPUT_ARCHIVE move compress
	);
	execute by ORACLE
	( 
	   		alter table &ORA_RESASDWH_SCHEMA..MVBS_OUTPUT move compress
	);
disconnect from ORACLE; 
quit;




/*---- End of User Written Code  ----*/ 

%rcSet(&syserr); 
%rcSet(&sqlrc); 


/**  Step end Execute **/

%let etls_endTime = %sysfunc(datetime(),datetime.);



/**  Job end MVBS_OUTPUT_ARCHIVE **/

/* Reset jobid and name */
%let jobID = %quote(A5V8BXSQ.AR0001AW);
%let etls_jobName = %nrquote(MVBS_ARCHIVE_ORA_SAS_LOOP);

%exitetls_conditionWDDRWHBJ:
%mend etls_conditionWDDRWHBJ;

%etls_conditionWDDRWHBJ;


/**  Step end Conditional Start **/

/*---- Start of Post-Process Code  ----*/ 

/*Clearing the library assignment*/
LIBNAME MVBSARCH CLEAR ;
/*---- End of Post-Process Code  ----*/ 

%rcSet(&syserr); 
%rcSet(&sqlrc); 

%let etls_endTime = %sysfunc(datetime(),datetime.);

